<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="606" Id="ACCSAC01320" Left="8" OnLoadCompleted="ACCSAC01320_OnLoadCompleted" PidAttrib="7" Title="도매수수료&#32;정산처추가&#32;엑셀업로드" Top="8" Ver="1.0" Width="968" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents>
					<colinfo id="POS_AGENCY" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="SL_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="MNP_CMMS_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_PLC" size="256" summ="default" type="STRING"/>
					<record>
						<ACC_MTH></ACC_MTH>
						<ACC_PLC></ACC_PLC>
						<DEAL_CO_CD></DEAL_CO_CD>
						<MNP_CMMS_CL></MNP_CMMS_CL>
						<POS_AGENCY></POS_AGENCY>
						<SL_CL></SL_CL>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excelList">
				<Contents>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_DTL_INFO" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_MGMT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_SER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FIX_CNSG_CMMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="SL_CL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prod">
				<Contents>
					<colinfo id="PROD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_errorExcelList">
				<Contents>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_DTL_INFO" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_MGMT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_SER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FIX_CNSG_CMMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tempExcelList">
				<Contents>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_DTL_INFO" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_MGMT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_SER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FIX_CNSG_CMMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_stlList">
				<Contents>
					<colinfo id="ACC_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_MGMT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_ADD_DTL_INFO" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDL_SER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FIX_CNSG_CMMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_accCmms">
				<Contents>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="SL_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="FIX_CNSG_CMMS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_keyData">
				<Contents>
					<colinfo id="KEY_DATA" size="256" summ="default" type="STRING"/>
					<record>
						<KEY_DATA>&#32;</KEY_DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AutoEnter="TRUE" BindDataset="ds_excelList" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="407" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="22" Height="319" Id="grd_excelList" InputPanel="FALSE" Left="10" LineColor="user33" OnExpandUp="grd_handWrite_OnExpandUp" Right="960" RowHeight="21" Style="sty_Grid" TabOrder="0" TabStop="true" Top="88" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="950">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="120"/>
						<col fix="left" width="80"/>
						<col fix="left" width="80"/>
						<col fix="left" width="125"/>
						<col fix="left" width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="150"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" font="돋움,9,Bold" text="정산처" Valign="Center"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" font="돋움,9,Bold" text="정산처구분" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="2" color="user35" display="text" font="돋움,9,Bold" text="정산처코드" Valign="Center"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" font="돋움,9,Bold" text="판매처" Valign="Center"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" font="돋움,9,Bold" text="판매처코드" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="5" color="user35" display="text" font="돋움,9,Bold" text="정산추가항목" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="6" color="user35" display="text" font="돋움,9,Bold" text="정산추가항목코드" Valign="Center"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" font="돋움,9,Bold" text="세부내용" Valign="Center"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" font="돋움,9,Bold" text="기존정산월" Valign="Center"/>
						<cell bkcolor="user34" col="9" color="user35" display="text" font="돋움,9,Bold" text="고객명" Valign="Center"/>
						<cell bkcolor="user34" col="10" color="user35" display="text" font="돋움,9,Bold" text="개통번호" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="11" color="user35" display="text" font="돋움,9,Bold" text="서비스관리번호" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="12" color="user35" display="text" font="돋움,9,Bold" text="모델" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="13" color="user35" display="text" font="돋움,9,Bold" text="일련번호" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="14" color="user35" display="text" font="돋움,9,Bold" text="확정위탁수수료" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="15" color="user35" display="text" font="돋움,9,Bold" text="비고" Valign="Center"/>
					</head>
					<body>
						<cell align="left" col="0" colid="DEAL_CO_NM" display="text"/>
						<cell align="center" col="1" colid="DEAL_NM" display="text"/>
						<cell align="center" col="2" colid="ACC_PLC" display="text" limit="10"/>
						<cell align="left" col="3" colid="SALE_PLC_NM" display="text"/>
						<cell align="center" col="4" colid="SALE_PLC" display="text"/>
						<cell align="center" col="5" colid="ACC_ADD_ITM_NM" display="text" limit="10"/>
						<cell align="center" col="6" colid="ACC_ADD_ITM_CD" display="text" limit="10"/>
						<cell align="center" col="7" colid="ACC_ADD_DTL_INFO" display="text"/>
						<cell align="center" col="8" colid="BF_ACC_MTH" display="text" Mask="@@@@-@@"/>
						<cell align="center" col="9" colid="CUST_NM" display="text" limit="20"/>
						<cell align="center" col="10" colid="SVC_NUM" display="text" limit="12"/>
						<cell align="center" col="11" colid="SVC_MGMT_NUM" display="text" limit="10"/>
						<cell align="center" col="12" colid="MDL_NM" display="text"/>
						<cell align="center" col="13" colid="MDL_SER_NUM" display="text" limit="7"/>
						<cell align="right" col="14" colid="FIX_CNSG_CMMS" display="number" limit="7"/>
						<cell align="center" col="15" colid="RMKS" display="text" limit="80"/>
					</body>
					<summary>
						<cell align="right" bkcolor="user37" col="0" color="user38" display="text" text="합계"/>
						<cell align="right" bkcolor="user37" col="1" color="user38" display="number"/>
						<cell align="right" bkcolor="user37" col="2" color="user38" display="number"/>
						<cell align="right" bkcolor="user37" col="3" color="user38" display="number"/>
						<cell align="right" bkcolor="user37" col="4" color="user38" display="number"/>
						<cell align="right" bkcolor="user37" col="5" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="6" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="7" color="user38" display="number"/>
						<cell align="right" bkcolor="user37" col="8" color="user38" display="number"/>
						<cell align="right" bkcolor="user37" col="9" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="10" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="11" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="12" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="13" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="14" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="15" color="user38" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="25" Id="img_handWrite" ImageID="bul_tit" Left="10" LeftMargin="15" Style="sty_img_tit" TabOrder="1" Text="도매수수료&#32;정산처추가&#32;엑셀업로드" Top="59" Width="234"></Image>
		<Div Border="Raised" Height="40" Id="div_search" Left="10" Style="sty_div_search" TabOrder="2" Text="Div0" Top="10" Width="950">
			<Contents>
				<Static Align="Right" Border="None" Height="20" Id="Static0" Left="3" Style="sty_lb_Search" TabOrder="1" Text="대리점" Top="8" VAlign="Middle" Width="45"></Static>
				<Edit Border="Flat" Height="20" Id="edt_agencyCdNm" Left="52" LeftMargin="2" OnKeyDown="div_search_edt_agencyCdNm_OnKeyDown" RightMargin="2" Style="sty_ipt_form" TabOrder="4" Top="7" UserData="발주처" Width="80"></Edit>
				<Button Cursor="HAND" Height="20" Id="btn_agency" ImageID="btn_i_detail" Left="132" OnClick="div_search_btn_agency_OnClick" TabOrder="3" Text="Button0" Top="7" Width="20"></Button>
				<Edit BindDataset="ds_condition" Border="Flat" Column="POS_AGENCY" Enable="FALSE" Height="20" Id="edt_agencyUkeyCd" Left="150" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="2" Top="7" Width="80"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" Column="POS_AGENCY" Enable="FALSE" Height="20" Id="edt_agencyCd" Left="230" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="5" Top="7" Visible="FALSE" Width="10"></Edit>
				<Static Align="Right" Height="20" Id="Static1" Left="241" Style="sty_lb_dataview" TabOrder="6" Text="정산월" Top="8" VAlign="Middle" Width="60"></Static>
				<MaskEdit BindDataset="ds_condition" Border="Flat" Column="ACC_MTH" Height="20" Id="cal_accYm" Left="307" LeftMargin="2" Mask="@@@@-@@" MaxLength="6" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="7" Top="8" Type="STRING" Width="77"></MaskEdit>
				<Button Cursor="HAND" Height="20" Id="btn_monthCalendar" ImageID="btn_i_calendar" Left="384" OnClick="btn_monthCalendar_OnClick" TabOrder="8" TabStop="FALSE" Text="Button3" Top="8" Width="17"></Button>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Height="25" Id="btn_save" ImageID="btn_c_2" Left="833" LeftMargin="5" OnClick="btn_save_onClick" Style="sty_btn_c" TabOrder="3" Text="저장" Top="417" Visible="FALSE" Width="60"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_close" ImageID="btn_c_2" Left="897" LeftMargin="5" OnClick="df_close" Style="sty_btn_c" TabOrder="4" Text="취소" Top="417" Width="60"></Button>
		<Image Align="Left" Height="20" Id="img_polChg" ImageID="bul_caution" Left="276" LeftMargin="20" Style="sty_lb_info" TabOrder="5" Text="정산&#32;추가의&#32;고객정보&#32;및&#32;개통정보는&#32;영업관리의&#32;데이터와&#32;관련이&#32;없습니다." Top="62" Width="410"></Image>
		<Button Cursor="HAND" Height="21" Id="btn_upload" ImageID="btn_i_excelup_w" Left="909" OnClick="btn_upload_OnClick" TabOrder="8" Text="Button1" ToolTipText="Excel&#32;Download" Top="60" Width="19"></Button>
		<Button Cursor="HAND" Height="21" Id="Button0" ImageID="btn_i_exceldown_w" Left="936" OnClick="btn_export_OnClick" TabOrder="7" Text="Button1" ToolTipText="Excel&#32;Download" Top="60" Width="19"></Button>
		<Image Align="Left" Height="50" Id="Image0" ImageID="bul_caution" Left="11" LeftMargin="20" Style="sty_lb_info" TabOrder="9" Text="엑셀&#32;업로드&#32;시&#32;정산추가&#32;항목코드는&#32;&#13;&#10;&#13;&#10;01&#32;:데이터요금제&#32;계열&#32;02&#32;:&#32;부가요금제&#32;계열&#32;03&#32;:&#32;기본요금제&#32;계열&#32;04&#32;:&#32;VAS&#32;계열&#32;05&#32;:&#32;기타&#32;부가서비스&#32;06:더블할인&#32;07&#32;:&#32;신규가입&#32;08:&#32;보상(일반)기변&#32;&#13;&#10;&#13;&#10;09:&#32;CIA&#32;10:&#32;불편법&#32;11:&#32;명의도용" Top="416" Width="800"></Image>
		<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="11" LeftMargin="15" Style="sty_img_tit" TabOrder="10" Text="오류데이터" Top="478" Width="90"></Image>
		<Button Cursor="HAND" Height="21" Id="btn_errorExcel" ImageID="btn_i_exceldown_w" Left="136" OnClick="btn_errorExport_OnClick" TabOrder="11" Text="Button1" ToolTipText="Excel&#32;Download" Top="479" Width="19"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_errorExcelList" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="594" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="22" Height="86" Id="grd_errorExcelList" InputPanel="FALSE" Left="11" LineColor="user33" MinWidth="100" Right="961" RowHeight="21" Style="sty_Grid" TabOrder="10" TabStop="true" Top="508" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="950">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="400"/>
					</columns>
					<head>
						<cell align="center" bkcolor="user34" col="0" color="user35" display="text" font="돋움,9,Bold" text="정산처" Valign="Center"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" font="돋움,9,Bold" text="판매처" Valign="Center"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" font="돋움,9,Bold" text="모델" Valign="Center"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" font="돋움,9,Bold" text="서비스관리번호" Valign="Center"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" font="돋움,9,Bold" text="정산추가항목" Valign="Center"/>
						<cell bkcolor="user34" col="5" color="user35" display="text" font="돋움,9,Bold" text="오류내역" Valign="Center"/>
					</head>
					<body>
						<cell align="left" bkcolor2="user36" col="0" colid="DEAL_CO_NM" display="text"/>
						<cell align="center" bkcolor2="user36" col="1" colid="SALE_PLC_NM" display="text"/>
						<cell align="center" bkcolor2="user36" col="2" colid="MDL_NM" display="text"/>
						<cell align="center" bkcolor2="user36" col="3" colid="SVC_MGMT_NUM" display="text"/>
						<cell align="center" bkcolor2="user36" col="4" colid="ACC_ADD_ITM_CD" display="text"/>
						<cell align="left" bkcolor2="user32" col="5" colid="RMKS" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="13" Id="st_errorTotCount" Left="94" Style="sty_lb_info" TabOrder="13" Text="0&#32;건" Top="485" Width="40"></Static>
		<Grid AutoEnter="TRUE" BindDataset="ds_stlList" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="80" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="22" Height="30" Id="grd_stlList" InputPanel="FALSE" Left="858" LineColor="user33" OnExpandUp="grd_handWrite_OnExpandUp" Right="888" RowHeight="21" Style="sty_Grid" TabOrder="14" TabStop="true" Top="50" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="FALSE" VLineColor="user33" WheelScrollRow="1" Width="30">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="120"/>
						<col fix="left" width="80"/>
						<col fix="left" width="80"/>
						<col fix="left" width="125"/>
						<col fix="left" width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="150"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" font="돋움,9,Bold" text="정산처" Valign="Center"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" font="돋움,9,Bold" text="정산처구분" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="2" color="user35" display="text" font="돋움,9,Bold" text="정산처코드" Valign="Center"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" font="돋움,9,Bold" text="판매처" Valign="Center"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" font="돋움,9,Bold" text="판매처코드" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="5" color="user35" display="text" font="돋움,9,Bold" text="정산추가항목" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="6" color="user35" display="text" font="돋움,9,Bold" text="정산추가항목코드" Valign="Center"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" font="돋움,9,Bold" text="세부내용" Valign="Center"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" font="돋움,9,Bold" text="기존정산월" Valign="Center"/>
						<cell bkcolor="user34" col="9" color="user35" display="text" font="돋움,9,Bold" text="고객명" Valign="Center"/>
						<cell bkcolor="user34" col="10" color="user35" display="text" font="돋움,9,Bold" text="개통번호" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="11" color="user35" display="text" font="돋움,9,Bold" text="서비스관리번호" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="12" color="user35" display="text" font="돋움,9,Bold" text="모델" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="13" color="user35" display="text" font="돋움,9,Bold" text="일련번호" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="14" color="user35" display="text" font="돋움,9,Bold" text="확정위탁수수료" Valign="Center"/>
						<cell align="center" bkcolor="user34" col="15" color="user35" display="text" font="돋움,9,Bold" text="비고" Valign="Center"/>
					</head>
					<body>
						<cell align="left" col="0" colid="DEAL_CO_NM" display="text"/>
						<cell align="center" col="1" colid="DEAL_NM" display="text"/>
						<cell align="center" col="2" colid="ACC_PLC" display="text" limit="10"/>
						<cell align="left" col="3" colid="SALE_PLC_NM" display="text"/>
						<cell align="center" col="4" colid="SALE_PLC" display="text"/>
						<cell align="center" col="5" colid="SVC_MGMT_NUM" display="text" limit="10"/>
						<cell align="center" col="6" colid="SVC_MGMT_NUM" display="text" limit="10"/>
						<cell align="center" col="7" colid="ACC_ADD_DTL_INFO" display="text"/>
						<cell align="center" col="8" colid="BF_ACC_MTH" display="text" Mask="@@@@-@@"/>
						<cell align="center" col="9" colid="CUST_NM" display="text" limit="20"/>
						<cell align="center" col="10" colid="SVC_NUM" display="text" limit="12"/>
						<cell align="center" col="11" colid="SVC_MGMT_NUM" display="text" limit="10"/>
						<cell align="center" col="12" colid="MDL_NM" display="text"/>
						<cell align="center" col="13" colid="MDL_SER_NUM" display="text" limit="7"/>
						<cell align="right" col="14" colid="FIX_CNSG_CMMS" display="number" limit="7"/>
						<cell align="center" col="15" colid="RMKS" display="text" limit="80"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID : ACCSAC01320
* 업무명      : 정산 - 판매점정산관리
* 프로그램명  : 도매수수료 수기입력 엑셀업로드
--------------------------------------------------------------------------------
* 작성자      : 전현주 
* 작성일      : 2009.11.25
--------------------------------------------------------------------------------
* 1. 변경이력
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

//==============================================================================
// 공통 스크립트 로딩
//==============================================================================
#include "lib::lib_commF.js"
#include "lib::lib_commMsg.js"
#include "lib::lib_util.js"
#include "lib::lib_commPopup.js"

/*******************************************************************************
// 2. 폼 변수 정의
*******************************************************************************/
var FV_LOGIN_ID;      	//사용자계정     
var FV_ORG_ID;         	//조직코드    
var FV_ORG_CL;         	//조직구분      
var FV_SUP_ORG_ID;      //상위조직코드   
var FV_USER_GRP;        //사용자그룹   
var FV_ORG_AREA_ID; 	// 근무지 cd.
var FV_ORG_AREA_NM; 	// 근무지 nm.       
var FV_POS_AGENCY_ID;   // 소속 대리점ID 
var FV_POS_AGENCY_NM;   // 소속 대리점명 
var FV_POS_AGENCY_UKEY_ID; // 소속 대리점UKEY ID 


/*******************************************************************************
* 함수명 : ACCSAC01320_OnLoadCompleted
* 기능명 : OnLoadCompleted 이벤트
*******************************************************************************/
function ACCSAC01320_OnLoadCompleted(obj)
{
	cf_setGrdChecknSortEvent(grd_excelList);	// 그리드 정렬
	
	http.Sync = true;
    
    
    f_initSearchSet();
    
    f_stlPlcExcelList();
   
	http.Sync = false;

}


function f_initSearchSet()
{
	cf_setParam(ds_condition,"POS_AGENCY"   	   ,POS_AGENCY);	//정산월
	cf_setParam(ds_condition,"ACC_MTH"   	   ,ACC_MTH);	//정산월
	cf_setParam(ds_condition,"SL_CL"   	   	   ,SL_CL);		//영업구분
	div_search.edt_agencyCdNm.Text = POS_AGENCY_NM;			//대리점명
	div_search.edt_agencyUkeyCd.Text = POS_AGENCY;			//대리점코드
	
	uf_ObjComponentEnable(div_search,false);
	
}

/*******************************************************************************
* 함수명 : f_stlPlcSearch
* 기능명 : 수기입력 대상 정산처 리스트 조회.
*******************************************************************************/
function f_stlPlcExcelList()
{
	
	var sSvcID = "svcStlPlcList";
	var sInDs  = "nc_input_fieldDs=ds_condition";
	var sOutDs = "ds_stlList=rs_excelList ds_code=rs_code ds_prod=rs_prod";
	var sArg   = "sktst.acc.SAC#getAccPlcExcelUploadList";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}
		

/*******************************************************************************
 * @description         : 그리드의 데이터를 엑셀화로 출력
 * @param oGrd   		: 그리드 객체 
		  nMode   		: 엑셀 저장 모드 - 1 or null : 엑셀로드 , 2 : 파일 저장
*******************************************************************************/
function f_exportExcel(oGrd, nMode)
{
	var sFilePath = "";
	var sFileName = "";
	var sSavedName = "";
	var sSheetName = "도매수수료 정산 수기입력";
	var stmp;
	
	var oGrdDs = object(oGrd.BindDataset);
	
	if (oGrdDs.GetRowCount() < 1) 
	{
		alert(MSG_00983);
		return;
	}
	
	if(nMode != null && nMode == 2)
	{
		if( fld_excel.Open( "C:\\" ) )
		{
			sFilePath = fld_excel.FilePath;
			sFileName = fld_excel.FileName;
			sTmp = substr(sFileName, length(sFileName) - 3, length(sFileName));
			if (sTmp != "xls")
			{
			   sFileName = sFileName + ".xls";
			}
			sSavedName = sFilePath + "\\" + sFileName;
			oGrd.SaveExcel(sSavedName, sSheetName);
		}
		else
		{
			alert(MSG_00982);
		}
	}
	else
	{
		oGrd.ExportExcelEx(sSheetName, "A1", false, true);
	}
	
	grd_stlList.Format = "ExcelGrd";
}



/*******************************************************************************
 * @description             : 엑셀 파일을 읽어 지정하는 데이타셋에 로드
 * @param sDsName   		: 데이타셋 아이디
		  nUseDsInfo   		: 데이타셋 칼럼 정보 사용 유무 - 1: 사용, 0: 무시
		  nStartIndex   	: 엑셀을 읽을 시작 행 위치
 * @return	                : 선택한 엑셀파일의 풀패스 
 * @etc                     : DS 칼럼 정보 사용시 엑셀의 셀 순서와 DS 칼럼 순서가 같아야 함!
*******************************************************************************/
function f_importExcel(sDsName, nUseDsInfo, nStartIndex, nSheetIndex)
{
	fld_excel.Type = "OPEN";
	var bResult = fld_excel.Open();
	
	if ( bResult )
	{
		var sFullPath = fld_excel.FilePath + '\\' + fld_excel.FileName;

		if(nUseDsInfo == null)
		{
			nUseDsInfo = 1;
		}
		
		if(nStartIndex == null)
		{
			nStartIndex = 1;
		}
		
		if(nSheetIndex == null)
		{
			nSheetIndex = 0;
		}

		var nResult = ext_ExcelImportByIndex(sFullPath, nSheetIndex, sDsName, nUseDsInfo, 0, 0, nStartIndex);

		if(ds_tempExcelList.colcount  != grd_excelList.GetCellCount("Head")){
			
			alert("EXCEL CELL 의 갯수가 일치하지 않습니다. \r\n 파일을 다시 한번 확인해주세요.");
			return false;
		}
		
		ds_tempExcelList.DeleteRow(0); //엑셀의 헤드첫행 삭제
		
		if (ds_tempExcelList.count == 0){
			alert("업로드할 자료가 없습니다.");
			return false;
		}	
		
		if(nResult == 0)
		{
			return sFullPath;
		}
		
	}
	
}


/*******************************************************************************
* 함수명 : btn_export_OnClick
* 기능명 :  엑셀 export
*******************************************************************************/
function btn_export_OnClick(obj)
{
	grd_stlList.Format = "ExcelGrd";
	
	f_exportExcel(grd_stlList);
	
}



/*******************************************************************************
* 함수명 : df_close
* 기능명 : 화면 종료
*******************************************************************************/
function df_close(sButtonID)
{
	this.close();
}

/*******************************************************************************
* 함수명 : btn_upload_OnClick
* 기능명 :  엑셀 inport
*******************************************************************************/
function btn_upload_OnClick(obj)
{
	grd_excelList.Redraw = false;
	grd_errorExcelList.Redraw = false;
	
	var RMKS = "";
	var ERP_FIX_YN = "N";
	var nLimit;
	var sAccPlcChk = 0;
	var sSalePlcChk = 0;
	var dupCnt = 0;
	
	ds_tempExcelList.clearData();
	ds_errorExcelList.clearData();
	
	f_importExcel("ds_tempExcelList");
	
	
	if(ds_tempExcelList.rowcount > 0) {
				
		for(var nRow= ds_tempExcelList.rowCount-1; nRow>=0; nRow--) {	
			
			var sAccPlc = ds_tempExcelList.GetColumn(nRow,"ACC_PLC"); 
			var sSalePlc = ds_tempExcelList.GetColumn(nRow,"SALE_PLC"); 
			var sSvcMgmtNum = ds_tempExcelList.GetColumn(nRow,"SVC_MGMT_NUM"); 
			var sAccAddItmCd = ds_tempExcelList.GetColumn(nRow,"ACC_ADD_ITM_CD"); 
			
			sAccPlcChk = ds_stlList.CaseCount("ACC_PLC==" + quote(sAccPlc));
			sSalePlcChk = ds_stlList.CaseCount("SALE_PLC==" + quote(sSalePlc));
			
			findRow = ds_tempExcelList.SearchRow("ACC_PLC==" + quote(sAccPlc) +
									  " && SVC_MGMT_NUM==" + quote(sSvcMgmtNum) +
									  " && ACC_ADD_ITM_CD==" + quote(sAccAddItmCd));
			
			dupCnt = ds_tempExcelList.CaseCount("ACC_PLC==" + quote(sAccPlc) +
													" && SVC_MGMT_NUM==" + quote(sSvcMgmtNum) +
													" && ACC_ADD_ITM_CD==" + quote(sAccAddItmCd));
			
			//정산추가항목코드+정산처코드+서비스 관리번호가 중복건 체크
			if(dupCnt >1 ){
				ds_errorExcelList.AddRow();
				ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
				ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","중복된 정산추가항목코드와 서비스관리번호입니다.");
			}
						
			if(sAccPlcChk == 0 ){ 
				//정산처 체크 
				ds_errorExcelList.AddRow();
				ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
				ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","도매 수수료 정산내역이 없는 정산처입니다.");
				continue;
			}else if(sAccPlcChk > 0 ){ 
				if(sSalePlcChk == 0){
					//판매처 정보 체크
					ds_errorExcelList.AddRow();
					ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
					ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","유효하지 않은 판매처입니다.");
					continue;
				}else{
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"ACC_ADD_ITM_CD")) ==true){
						//정산추가 항목 코드 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","정산추가 항목코드를 입력해주십시오.");
						continue;
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"ACC_ADD_DTL_INFO")) ==true){
						//정산추가 세부내용 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","정산추가 세부내용을 입력해주십시오.");
						continue;
					}
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"ACC_ADD_DTL_INFO")) > 80){
						//고객명  Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","정산추가 세부내용을 80자 이내로 입력하십시오.");
						continue;
					}
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"BF_ACC_MTH")) !=6){
						//고객명  Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","기존 정산월을 'YYYYMM' 형태로 입력하십시오.");
						continue;
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"CUST_NM")) ==true){
						//정산추가 세부내용 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","고객명을 입력해주십시오.");
						continue;
					}
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"CUST_NM")) > 20){
						//고객명  Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","고객명을 20 Byte이내로 입력하십시오.");
						continue;
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"SVC_NUM")) ==true){
						//정산추가 세부내용 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","개통번호를 입력해주십시오.");
						continue;
					}
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"SVC_NUM")) > 12){
						//개통번호 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","개통번호를 12 Byte이내로 입력하십시오.");
						continue;
					}
					
					if(f_isNumber(ds_tempExcelList.GetColumn(nRow,"SVC_NUM")) == false){
						//비고 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","개통번호를 숫자로 입력하십시오.");
						continue;					
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"SVC_MGMT_NUM")) ==true){
						//서비스관리번호 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","서비스관리번호를 입력해주십시오.");
						continue;
					}
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"SVC_MGMT_NUM")) > 10){
						//서비스관리번호 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","서비스관리번호를 10 Byte이내로 입력하십시오.");
						continue;
					}
					
					if(f_isNumber(ds_tempExcelList.GetColumn(nRow,"SVC_MGMT_NUM")) == false){
						//서비스관리번호 숫자 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","서비스관리번호를 숫자로 입력하십시오.");
						continue;					
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"MDL_SER_NUM")) ==true){
						//일련번호 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","단말기 일련번호를 입력해주십시오.");
						continue;
					}
					
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"MDL_SER_NUM")) != 7){
						//일련번호 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","단말기 일련번호를 7 Byte로 입력하십시오.");
						continue;
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"MDL_NM")) ==true){
						//모델명 CHECK
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","단말기 모델명을 입력해주십시오.");
						continue;
					}
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"RMKS")) > 100){
						//비고 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","비고를 100 Byte 이내로 입력하십시오.");
						continue;
					}
					
					if(uf_isNull(ds_tempExcelList.GetColumn(nRow,"FIX_CNSG_CMMS")) == true){
		
						ds_tempExcelList.SetColumn(nRow,"FIX_CNSG_CMMS",0);
					}
					
												
					if(f_isNumber(ds_tempExcelList.GetColumn(nRow,"FIX_CNSG_CMMS")) == false){
						//비고 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","확정 위탁수수료를 숫자로 입력하십시오.");
						continue;					
					}
					
					
					if(lengthb(ds_tempExcelList.GetColumn(nRow,"FIX_CNSG_CMMS")) > 10){
						//비고 Byte 체크
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","확정 위탁수수료를 10 Byte 이내로 입력하십시오.");
						continue;
					}	
					
					if(ds_code.FindRow("CODE", ds_tempExcelList.GetColumn(nRow,"ACC_ADD_ITM_CD")) <0){
						ds_errorExcelList.AddRow();
						ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
						ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","유효한 정산추가 항목코드를 입력해주십시오.");
						continue;
					}else{
						
						if(ds_prod.FindRow("PROD_NM", ds_tempExcelList.GetColumn(nRow,"MDL_NM")) <0){
							ds_errorExcelList.AddRow();
							ds_errorExcelList.CopyRow(ds_errorExcelList.lastrow,"ds_tempExcelList",nRow);
							ds_errorExcelList.SetColumn(ds_errorExcelList.lastrow,"RMKS","현재 유효한 단말기가 아닙니다.");
							continue;
						}else{
							//정산추가항목코드+정산처코드+서비스 관리번호가 중복되지 않은 건들만
							if(dupCnt <=1){
								ds_excelList.AddRow();
								ds_excelList.CopyRow(ds_excelList.lastrow,"ds_tempExcelList",nRow);
								ds_excelList.SetColumn(ds_excelList.lastrow,"ACC_ADD_ITM_NM",ds_code.GetColumn(ds_code.FindRow("CODE", ds_tempExcelList.GetColumn(nRow,"ACC_ADD_ITM_CD")),"CODE_NM"));
								ds_excelList.SetColumn(ds_excelList.lastrow,"MDL_CD",ds_prod.GetColumn(ds_prod.FindRow("PROD_NM", ds_tempExcelList.GetColumn(nRow,"MDL_NM")),"PROD_CD"));
								ds_excelList.SetColumn(ds_excelList.lastrow,"DEAL_CO_CD",POS_AGENCY);
								ds_excelList.SetColumn(ds_excelList.lastrow,"ACC_MTH",ACC_MTH);
								ds_excelList.SetColumn(ds_excelList.lastrow,"SL_CL","02");
							}
							
						}
					}
				}
			}
		}
		
		btn_save.Visible = true;
		
	}

	
	grd_excelList.Format = "Default";
	
	f_setTotalCount(ds_errorExcelList.RowCount());
	
	ds_excelList.Sort("DEAL_CO_NM");
	
	ds_errorExcelList.Sort("DEAL_CO_NM");
	
	grd_errorExcelList.Redraw = true;
	grd_excelList.Redraw = true;
	btn_save.Visible = true;
	
}



/*******************************************************************************
* 함수명 : f_callBack
* 기능명 : 트랜잭션 콜백
* 파라미터
1. sSvcID  : 서비스 아이디
*******************************************************************************/
function f_callBack(sSvcID)
{
	if(sSvcID == "svcStlPlcList")
	{
		if(ds_stlList.rowcount == 0) {
			
			btn_save.Enable   = false;
			alert("수기입력 할 정산처가 없습니다.");
		}else{
			btn_save.Enable   = true;
			
		}
		
		return;
	}
	
	if(sSvcID == "saveCmmsAccExcelUpload")
	{
		alert(cf_getMessage(MSG_00006, "도매 수수료 엑셀업로드가"));
		
		parent.btn_search_OnClick();
		this.Close();
	}
			
}



/*******************************************************************************
 * 함수명    : btn_save_onClick
 * 기능명   :  저장 처리
*******************************************************************************/
function btn_save_onClick(obj)
{	
	
	cf_CheckCloseMnth('06',ACC_MTH,"정산월");  	
	if(FV_BOOLEAN_CLOSE) return;
	
	cf_CheckCloseDay('04',substr(TODAY(),0,8),"정산월");  	
	if(FV_BOOLEAN_CLOSE) return;
	
	
	if(ds_excelList.GetRowCount() ==0){
		alert("처리대상이 없습니다. ");
		return false;
	}
	
	f_setDsGroup();
	
	
	if(confirm(cf_getMessage(MSG_00136, "저장")) == 1){
		
		var sSvcID = "saveCmmsAccExcelUpload";
		var sInDs  = "ds_handWrite=ds_excelList:U ds_accCmms=ds_accCmms";
		var sOutDs = "";
		var sArg   = "sktst.acc.SAC#saveHandWriteAccMonthList";

		cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	}
	
}


/*******************************************************************************
* 함수명 : f_setDsGroup 
* 기능명 : tacc_cmms_acc_m (도매 수수료 월정산에 확정수수료 넣기 위한 grouping 처리 
*******************************************************************************/

function f_setDsGroup(){
	
	ds_accCmms.ClearData();
	
	if(ds_excelList.GetRowCount() >0){
		
		var sArrProdCd = "";
		
		
		for(var i=0;i<ds_excelList.rowcount; i++){
		
		    var sOutAccPlcCd = ds_excelList.GetColumn(i, "ACC_PLC");
			var sOutDealCoCd = ds_excelList.GetColumn(i, "DEAL_CO_CD");
			var sOutSlCl = ds_excelList.GetColumn(i, "SL_CL");
			var sOutAccMth = ds_excelList.GetColumn(i, "ACC_MTH");
			var sOutFixCnsgCmms = ds_excelList.GetColumn(i, "FIX_CNSG_CMMS");
			
		    var sMoney = 0;
		    var sInRow = ds_accCmms.FindRow("ACC_PLC",sOutAccPlcCd);
		    var rowCount = ds_accCmms.GetRowCount(); 
		    
		    if(ds_accCmms.GetRowCount() ==0 || sInRow < 0){
				 ds_accCmms.AddRow();
				 ds_accCmms.SetColumn(rowCount, "DEAL_CO_CD", sOutDealCoCd);
				 ds_accCmms.SetColumn(rowCount, "ACC_PLC", sOutAccPlcCd);
				 ds_accCmms.SetColumn(rowCount, "ACC_MTH", sOutAccMth);
				 ds_accCmms.SetColumn(rowCount, "SL_CL", sOutSlCl);
				 ds_accCmms.SetColumn(rowCount, "FIX_CNSG_CMMS", sOutFixCnsgCmms);
		    }else{
				sMoney += toNumber(ds_accCmms.GetColumn(sInRow, "FIX_CNSG_CMMS")) + toNumber(ds_excelList.GetColumn(i, "FIX_CNSG_CMMS"));
				ds_accCmms.SetColumn(sInRow, "FIX_CNSG_CMMS", sMoney);
		    }
			
		}
	
	}
}

/*******************************************************************************
* 함수명 : f_setTotalCount
* 기능명 :  오류데이터 건수 Display  
*******************************************************************************/
function f_setTotalCount(stErrorTotCount) {
	st_errorTotCount.Text = stErrorTotCount + " 건";
}


/*******************************************************************************
* 함수명 : f_isNumber
* 기능명 :  숫자인지 check
*******************************************************************************/
function f_isNumber(sNumber)
{
	var i;
	
	var digit = replace(sNumber,'-',''); //-은 제외
	//숫자인지 check
	for(i=0; i<length(digit); i++) {
		if(asc(CharAt(digit, i)) < 48
		   || asc(CharAt(digit, i)) > 57) {
			return false;
		}
	}
	
	return true;
}

function Button1_OnClick(obj)
{
	cf_debug("ds_tempExcelList");
}

function Button2_OnClick(obj)
{
	cf_debug("ds_tempExcelList");
}

function Button3_OnClick(obj)
{
	cf_debug("ds_errorExcelList");
}

function Button4_OnClick(obj)
{
	cf_debug("ds_code");
}

function btn_errorExport_OnClick(obj)
{
	cf_exportExcel(grd_errorExcelList);
}
]]></Script>
</Window>