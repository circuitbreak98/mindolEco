<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="735" Id="ACCPSS00110" Left="8" OnLoadCompleted="ACCPSS00110_OnLoadCompleted" PidAttrib="7" Title="할부채권정산등록" Top="8" Ver="1.0" Width="700" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_accUkey">
				<Contents>
					<colinfo id="deal_co_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="u_pay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_pay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_pay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_pay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_pay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_pay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_pay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_rpay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_rpay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_pay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_pay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_rpay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_supl_rpay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="u_dedt_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_obj_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_rpay_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_adpay_deal_co_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="dedt_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_obj_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="adpay_deal_co_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="u_key_trms_dtm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_accClose">
				<Contents>
					<colinfo id="pos_agency" size="256" summ="default" type="STRING"/>
					<colinfo id="new_allot_pay" size="256" summ="default" type="STRING"/>
					<colinfo id="chg_allot_pay" size="256" summ="default" type="STRING"/>
					<colinfo id="new_allot_rpay" size="256" summ="default" type="STRING"/>
					<colinfo id="chg_allot_rpay" size="256" summ="default" type="STRING"/>
					<colinfo id="usim_allot_pay" size="256" summ="default" type="STRING"/>
					<colinfo id="usim_allot_rpay" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_new_allot_pay" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_chg_allot_pay" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_new_allot_rpay" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_chg_allot_rpay" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="svc_crdt" size="256" summ="default" type="STRING"/>
					<colinfo id="dedt_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_obj_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="adpay_deal_co_amt" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents>
					<colinfo id="acc_mth" size="256" summ="default" type="STRING"/>
					<colinfo id="pos_agency" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save_ukey">
				<Contents>
					<colinfo id="deal_co_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_mth" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_plc" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="dedt_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_obj_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="adpay_deal_co_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmks" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save_cnfm">
				<Contents>
					<colinfo id="deal_co_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_mth" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_plc" size="256" summ="default" type="STRING"/>
					<colinfo id="u_key_trms_dtm" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_usim_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_new_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_chg_allot_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_pay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_new_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="supl_rpay_chg_vat" size="256" summ="default" type="STRING"/>
					<colinfo id="dedt_allot_bond_pamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_obj_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rpay_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="adpay_deal_co_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmks" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Border="RaisedEdge" Height="39" Id="div_search" Left="10" Style="sty_div_dataview" TabOrder="5" Text="Div0" Top="10" Width="678">
			<Contents>
				<Static Align="Right" Height="20" Id="Static0" Left="225" Style="sty_lb_dataview" TabOrder="1" Text="정산월" Top="7" VAlign="Middle" Width="68"></Static>
				<Edit Border="Flat" Enable="FALSE" Height="20" Id="edt_agencyNm" Left="94" LeftMargin="2" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="2" Top="7" Width="116"></Edit>
				<MaskEdit Border="Flat" Enable="FALSE" Height="20" Id="cal_accMth" Left="297" LeftMargin="2" Mask="@@@@-@@" MaxLength="6" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="7" Type="STRING" Width="116"></MaskEdit>
				<Static Align="Right" Height="20" Id="Static1" Left="13" Style="sty_lb_dataview" TabOrder="4" Text="대리점" Top="7" VAlign="Middle" Width="68"></Static>
				<Edit Border="Flat" Enable="FALSE" Height="20" Id="edt_accPlc" Left="506" LeftMargin="2" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="5" Top="7" Width="116"></Edit>
				<Static Align="Right" Height="20" Id="Static2" Left="425" Style="sty_lb_dataview" TabOrder="6" Text="정산처" Top="7" VAlign="Middle" Width="68"></Static>
			</Contents>
		</Div>
		<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="10" LeftMargin="15" Style="sty_img_tit" TabOrder="6" Text="할부채권&#32;정산&#32;내역&#32;" Top="59" Width="192"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_accClose" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="504" Enable="FALSE" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="422" Id="grd_accClose" InputPanel="FALSE" Left="10" LineColor="user33" MinWidth="100" Right="400" RowHeight="21" Style="sty_Grid" TabOrder="7" TabStop="FALSE" Top="82" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="390">
			<contents>
				<format id="Default">
					<columns>
						<col width="77"/>
						<col width="220"/>
						<col width="98"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" text="구분"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" text="항목명"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" text="마감금액"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="&apos;단말기\n할부채권&apos;" rowspan="4"/>
						<cell align="left" col="1" display="normal" text="신규&#32;할부채권매입금&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="new_allot_pay" display="number" edit="number"/>
						<cell align="left" col="1" display="normal" row="1" text="기변&#32;할부채권매입금&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="chg_allot_pay" display="number" edit="number" row="1"/>
						<cell align="left" col="1" display="normal" row="2" text="신규&#32;할부채권매입금&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="new_allot_rpay" display="number" row="2"/>
						<cell align="left" col="1" display="normal" row="3" text="기변&#32;할부채권매입금&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="chg_allot_rpay" display="number" row="3"/>
						<cell align="center" col="0" display="text" expr="&apos;USIM\n채권&apos;" row="4" rowspan="2"/>
						<cell align="left" col="1" display="normal" row="4" text="USIM&#32;채권매입금&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="usim_allot_pay" display="number" row="4"/>
						<cell align="left" col="1" display="normal" row="5" text="USIM&#32;채권매입금&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="usim_allot_rpay" display="number" row="5"/>
						<cell align="center" col="0" display="text" expr="&apos;할부이자\n부가세&apos;" row="6" rowspan="4"/>
						<cell align="left" col="1" display="normal" row="6" text="신규&#32;할부이자부가세&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="pay_new_allot_vat" display="number" row="6"/>
						<cell align="left" col="1" display="normal" row="7" text="기변&#32;할부이자부가세&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="pay_chg_allot_vat" display="number" row="7"/>
						<cell align="left" col="1" display="normal" row="8" text="신규&#32;할부이자부가세&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="rpay_new_allot_vat" display="number" row="8"/>
						<cell align="left" col="1" display="normal" row="9" text="기변&#32;할부이자부가세&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="rpay_chg_allot_vat" display="number" row="9"/>
						<cell align="center" col="0" display="text" expr="&apos;부가단말\n할부채권&apos;" row="10" rowspan="4"/>
						<cell align="left" col="1" display="normal" row="10" text="부가단말&#32;신규&#32;할부채권매입금&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_new_allot_pay" display="number" row="10"/>
						<cell align="left" col="1" display="normal" row="11" text="부가단말&#32;기변&#32;할부채권매입금&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_chg_allot_pay" display="text" row="11"/>
						<cell align="left" col="1" display="normal" row="12" text="부가단말&#32;신규&#32;할부채권매입금&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_new_allot_rpay" display="text" row="12"/>
						<cell align="left" col="1" display="normal" row="13" text="부가단말&#32;기변&#32;할부채권매입금&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_chg_allot_rpay" display="text" row="13"/>
						<cell align="center" col="0" display="text" expr="&apos;부가단말\n할부이자\n부가세&apos;" row="14" rowspan="4"/>
						<cell align="left" col="1" display="normal" row="14" text="부가단말&#32;신규&#32;할부이자부가세&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_pay_new_vat" display="text" row="14"/>
						<cell align="left" col="1" display="normal" row="15" text="부가단말&#32;기변&#32;할부이자부가세&#32;지급"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_pay_chg_vat" display="text" row="15"/>
						<cell align="left" col="1" display="normal" row="16" text="부가단말&#32;신규&#32;할부이자부가세&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_rpay_new_vat" display="text" row="16"/>
						<cell align="left" col="1" display="normal" row="17" text="부가단말&#32;기변&#32;할부이자부가세&#32;환수"/>
						<cell align="right" bkcolor="user32" col="2" colid="supl_rpay_chg_vat" display="text" row="17"/>
						<cell align="center" col="0" colspan="2" display="text" row="18" text="할부채권&amp;USIM&#32;채권&#32;총금액&#32;(A)"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="new_allot_pay+chg_allot_pay+new_allot_rpay+chg_allot_rpay+usim_allot_pay+usim_allot_rpay+pay_new_allot_vat&#32;+&#32;pay_chg_allot_vat&#32;+&#32;rpay_new_allot_vat&#32;+&#32;rpay_chg_allot_vat&#32;+supl_new_allot_pay&#32;+&#32;supl_chg_allot_pay&#32;+&#32;supl_new_allot_rpay&#32;+&#32;supl_chg_allot_rpay&#32;+&#32;supl_pay_new_vat&#32;+&#32;supl_pay_chg_vat&#32;+&#32;supl_rpay_new_vat&#32;+&#32;supl_rpay_chg_vat" row="18"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_save" ImageID="btn_c_2" Left="564" LeftMargin="5" OnClick="btn_save_OnClick" Style="sty_btn_c" TabOrder="8" Text="저장" Top="698" Width="60"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_close" ImageID="btn_d_2" Left="628" LeftMargin="5" OnClick="btn_close_OnClick" Style="sty_btn_d" TabOrder="9" Text="닫기" Top="698" Width="60"></Button>
		<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="10" LeftMargin="15" Style="sty_img_tit" TabOrder="10" Text="할부채권&#32;공제&#32;내역" Top="512" Width="192"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_accClose" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="690" Enable="FALSE" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="149" Id="grd_dedtClose" InputPanel="FALSE" Left="10" LineColor="user33" MinWidth="100" Right="398" RowHeight="21" Style="sty_Grid" TabOrder="11" TabStop="FALSE" Top="541" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="388">
			<contents>
				<format id="Default">
					<columns>
						<col width="72"/>
						<col width="228"/>
						<col width="90"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" text="구분"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" text="항목명"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" text="마감금액"/>
					</head>
					<body>
						<cell align="center" col="0" colspan="2" display="normal" text="할부채권&#32;매입금&#32;공제(B)"/>
						<cell align="right" bkcolor="user32" col="2" colid="dedt_allot_bond_pamt" display="number" edit="number"/>
						<cell align="center" col="0" display="normal" expr="&apos;SKN\n개통여신&apos;" row="1" rowspan="4"/>
						<cell align="left" col="1" display="normal" row="1" text="상환대상&#32;금액(C)"/>
						<cell align="right" bkcolor="user32" col="2" colid="svc_crdt" display="number" row="1"/>
						<cell align="left" col="1" display="normal" row="2" text="상환액(F=Min(A-B,C)-D)"/>
						<cell bkcolor="user32" col="2" colid="rpay_amt" display="number" row="2"/>
						<cell align="left" col="1" display="normal" row="3" text="대리점&#32;선지급(D)"/>
						<cell bkcolor="user32" col="2" colid="adpay_deal_co_amt" display="number" row="3"/>
						<cell align="left" col="1" display="normal" row="4" text="미상환액(수수료/장려금공제대상)&#32;(C-E)"/>
						<cell bkcolor="user32" col="2" display="number" expr="svc_crdt&#32;-&#32;rpay_amt" row="4"/>
						<cell align="center" col="0" colspan="2" display="normal" row="5" text="대리점&#32;입금액&#32;(A-B-E)"/>
						<cell bkcolor="user32" col="2" display="number" expr="(new_allot_pay+chg_allot_pay+new_allot_rpay+chg_allot_rpay+usim_allot_pay+usim_allot_rpay+supl_new_allot_pay&#32;+&#32;supl_chg_allot_pay+supl_new_allot_rpay+supl_chg_allot_rpay)-svc_crdt&#32;-adpay_deal_co_amt" row="5"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Cursor="HAND" Height="21" Id="btn_excel" ImageID="btn_i_exceldown_w" Left="669" OnClick="btn_excel_OnClick" TabOrder="1" Text="Button1" ToolTipText="Excel&#32;Download" Top="57" Width="19"></Button>
		<Button Cursor="HAND" Height="21" Id="btn_excel2" ImageID="btn_i_exceldown_w" Left="666" OnClick="btn_excel2_OnClick" TabOrder="3" Text="Button1" ToolTipText="Excel&#32;Download" Top="514" Width="19"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_accUkey" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="504" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="422" Id="grd_accUkey" InputPanel="FALSE" Left="398" LineColor="user33" MinWidth="100" Right="688" RowHeight="21" Style="sty_Grid" TabOrder="2" TabStop="FALSE" Top="82" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="290">
			<contents>
				<format id="Default">
					<columns>
						<col width="98"/>
						<col width="98"/>
						<col width="98"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" text="U.Key금액"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" text="정산금액"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" text="확정금액"/>
					</head>
					<body>
						<cell align="right" bkcolor="user32" col="0" colid="u_pay_new_allot_bond_pamt" display="number"/>
						<cell align="right" col="1" colid="pay_new_allot_bond_pamt" display="number" edit="number"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_pay_new_allot_bond_pamt&#32;+&#32;pay_new_allot_bond_pamt"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_pay_chg_allot_bond_pamt" display="number" row="1"/>
						<cell align="right" col="1" colid="pay_chg_allot_bond_pamt" display="number" edit="number" row="1"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_pay_chg_allot_bond_pamt&#32;+&#32;pay_chg_allot_bond_pamt" row="1"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_new_allot_bond_pamt" display="number" row="2"/>
						<cell align="right" col="1" colid="rpay_new_allot_bond_pamt" display="number" edit="number" row="2"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_rpay_new_allot_bond_pamt&#32;+&#32;rpay_new_allot_bond_pamt" row="2"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_chg_allot_bond_pamt" display="number" row="3"/>
						<cell align="right" col="1" colid="rpay_chg_allot_bond_pamt" display="number" edit="number" row="3"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_rpay_chg_allot_bond_pamt&#32;+&#32;rpay_chg_allot_bond_pamt" row="3"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_pay_usim_bond_pamt" display="number" row="4"/>
						<cell align="right" col="1" colid="pay_usim_bond_pamt" display="number" edit="number" row="4"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_pay_usim_bond_pamt&#32;+&#32;pay_usim_bond_pamt" row="4"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_usim_bond_pamt" display="number" row="5"/>
						<cell align="right" col="1" colid="rpay_usim_bond_pamt" display="number" edit="number" row="5"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_rpay_usim_bond_pamt&#32;+&#32;rpay_usim_bond_pamt" row="5"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_pay_new_allot_vat" display="number" row="6"/>
						<cell align="right" col="1" colid="pay_new_allot_vat" display="number" edit="number" row="6"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_pay_new_allot_vat&#32;+&#32;pay_new_allot_vat" row="6"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_pay_chg_allot_vat" display="number" row="7"/>
						<cell align="right" col="1" colid="pay_chg_allot_vat" display="number" edit="number" row="7"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_pay_chg_allot_vat&#32;+&#32;pay_chg_allot_vat" row="7"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_new_allot_vat" display="number" row="8"/>
						<cell align="right" col="1" colid="rpay_new_allot_vat" display="number" edit="number" row="8"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_rpay_new_allot_vat&#32;+&#32;rpay_new_allot_vat" row="8"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_chg_allot_vat" display="number" row="9"/>
						<cell align="right" col="1" colid="rpay_chg_allot_vat" display="number" edit="number" row="9"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_rpay_chg_allot_vat&#32;+&#32;rpay_chg_allot_vat" row="9"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_supl_pay_new_pamt" display="number" row="10"/>
						<cell align="right" col="1" colid="supl_pay_new_pamt" display="number" row="10"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_supl_pay_new_pamt+supl_pay_new_pamt" row="10"/>
						<cell bkcolor="user32" col="0" colid="u_supl_pay_chg_pamt" display="number" row="11"/>
						<cell col="1" colid="supl_pay_chg_pamt" display="number" row="11"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_pay_chg_pamt+supl_pay_chg_pamt" row="11"/>
						<cell bkcolor="user32" col="0" colid="u_supl_rpay_new_pamt" display="number" row="12"/>
						<cell col="1" colid="supl_rpay_new_pamt" display="number" row="12"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_rpay_new_pamt&#32;+&#32;supl_rpay_new_pamt" row="12"/>
						<cell bkcolor="user32" col="0" colid="u_supl_rpay_chg_pamt" display="number" row="13"/>
						<cell col="1" colid="supl_rpay_chg_pamt" display="number" row="13"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_rpay_chg_pamt&#32;+&#32;supl_rpay_chg_pamt" row="13"/>
						<cell bkcolor="user32" col="0" colid="u_supl_pay_new_vat" display="number" row="14"/>
						<cell col="1" colid="supl_pay_new_vat" display="number" row="14"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_pay_new_vat&#32;+&#32;supl_pay_new_vat" row="14"/>
						<cell bkcolor="user32" col="0" colid="u_supl_pay_chg_vat" display="number" row="15"/>
						<cell col="1" colid="supl_pay_chg_vat" display="number" row="15"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_pay_chg_vat&#32;+&#32;supl_pay_chg_vat" row="15"/>
						<cell bkcolor="user32" col="0" colid="u_supl_rpay_new_vat" display="number" row="16"/>
						<cell col="1" colid="supl_rpay_new_vat" display="number" row="16"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_rpay_new_vat&#32;+&#32;supl_rpay_new_vat" row="16"/>
						<cell bkcolor="user32" col="0" colid="u_supl_rpay_chg_vat" display="number" row="17"/>
						<cell col="1" colid="supl_rpay_chg_vat" display="number" row="17"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_supl_rpay_chg_vat&#32;+&#32;supl_rpay_chg_vat" row="17"/>
						<cell bkcolor="user32" col="0" display="number" expr="u_pay_new_allot_bond_pamt+u_pay_chg_allot_bond_pamt+u_rpay_new_allot_bond_pamt+u_rpay_chg_allot_bond_pamt+u_pay_usim_bond_pamt+u_rpay_usim_bond_pamt+u_pay_new_allot_vat&#32;+u_pay_chg_allot_vat+u_rpay_new_allot_vat+u_rpay_chg_allot_vat+u_supl_pay_new_pamt&#32;+&#32;u_supl_pay_chg_pamt&#32;+u_supl_rpay_new_pamt&#32;+u_supl_rpay_chg_pamt+u_supl_pay_new_vat+u_supl_pay_chg_vat+u_supl_rpay_new_vat+u_supl_rpay_chg_vat" row="18"/>
						<cell col="1" display="number" expr="pay_new_allot_bond_pamt+pay_chg_allot_bond_pamt+rpay_new_allot_bond_pamt+rpay_chg_allot_bond_pamt+pay_usim_bond_pamt+rpay_usim_bond_pamt+pay_new_allot_vat&#32;+pay_chg_allot_vat+rpay_new_allot_vat+rpay_chg_allot_vat+supl_pay_new_pamt&#32;+&#32;supl_pay_chg_pamt&#32;+supl_rpay_new_pamt&#32;+supl_rpay_chg_pamt+supl_pay_new_vat+supl_pay_chg_vat+supl_rpay_new_vat+supl_rpay_chg_vat" row="18"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_pay_new_allot_bond_pamt+u_pay_chg_allot_bond_pamt+u_rpay_new_allot_bond_pamt+u_rpay_chg_allot_bond_pamt+u_pay_usim_bond_pamt+u_rpay_usim_bond_pamt+pay_new_allot_bond_pamt+pay_chg_allot_bond_pamt+rpay_new_allot_bond_pamt+rpay_chg_allot_bond_pamt+pay_usim_bond_pamt+rpay_usim_bond_pamt+u_pay_new_allot_vat&#32;+u_pay_chg_allot_vat+u_rpay_new_allot_vat+u_rpay_chg_allot_vat&#32;+&#32;pay_new_allot_vat&#32;+pay_chg_allot_vat+rpay_new_allot_vat+rpay_chg_allot_vat+u_supl_pay_new_pamt&#32;+&#32;u_supl_pay_chg_pamt&#32;+u_supl_rpay_new_pamt&#32;+u_supl_rpay_chg_pamt+u_supl_pay_new_vat+u_supl_pay_chg_vat+u_supl_rpay_new_vat+u_supl_rpay_chg_vat+supl_pay_new_pamt&#32;+&#32;supl_pay_chg_pamt&#32;+supl_rpay_new_pamt&#32;+supl_rpay_chg_pamt+supl_pay_new_vat+supl_pay_chg_vat+supl_rpay_new_vat+supl_rpay_chg_vat" row="18"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_accUkey" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="690" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="149" Id="grd_dedtUkey" InputPanel="FALSE" Left="396" LineColor="user33" MinWidth="100" Right="688" RowHeight="21" Style="sty_Grid" TabOrder="4" TabStop="FALSE" Top="541" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="292">
			<contents>
				<format id="Default">
					<columns>
						<col width="98"/>
						<col width="98"/>
						<col width="98"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" text="U.Key금액"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" text="정산금액"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" text="확정금액"/>
					</head>
					<body>
						<cell align="right" bkcolor="user32" col="0" colid="u_dedt_allot_bond_pamt" display="number"/>
						<cell align="right" col="1" colid="dedt_allot_bond_pamt" display="number" edit="number"/>
						<cell align="right" bkcolor="user32" col="2" display="number" expr="u_dedt_allot_bond_pamt+dedt_allot_bond_pamt"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_obj_amt" display="number" row="1"/>
						<cell col="1" colid="rpay_obj_amt" display="number" edit="number" row="1"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_rpay_obj_amt&#32;+&#32;rpay_obj_amt" row="1"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_rpay_amt" display="number" row="2"/>
						<cell col="1" colid="rpay_amt" display="number" edit="number" row="2"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_rpay_amt&#32;+&#32;rpay_amt" row="2"/>
						<cell align="right" bkcolor="user32" col="0" colid="u_adpay_deal_co_amt" display="number" row="3"/>
						<cell col="1" colid="adpay_deal_co_amt" display="number" edit="number" row="3"/>
						<cell bkcolor="user32" col="2" display="number" expr="u_adpay_deal_co_amt&#32;+&#32;adpay_deal_co_amt" row="3"/>
						<cell align="right" bkcolor="user32" col="0" display="number" expr="u_rpay_obj_amt&#32;-&#32;u_rpay_amt" row="4"/>
						<cell col="1" display="number" expr="rpay_obj_amt&#32;-&#32;rpay_amt" row="4"/>
						<cell bkcolor="user32" col="2" display="number" expr="(u_rpay_obj_amt&#32;-&#32;u_rpay_amt)+(rpay_obj_amt&#32;-&#32;rpay_amt)" row="4"/>
						<cell align="right" bkcolor="user32" col="0" display="number" expr="(u_pay_new_allot_bond_pamt+u_pay_chg_allot_bond_pamt+u_rpay_new_allot_bond_pamt+u_rpay_chg_allot_bond_pamt+u_pay_usim_bond_pamt+u_rpay_usim_bond_pamt+u_pay_new_allot_vat&#32;+u_pay_chg_allot_vat+u_rpay_new_allot_vat+u_rpay_chg_allot_vat+u_supl_pay_new_pamt&#32;+&#32;u_supl_pay_chg_pamt+u_supl_rpay_new_pamt+u_supl_rpay_chg_pamt+u_supl_pay_new_vat+u_supl_pay_chg_vat+u_supl_rpay_new_vat+u_supl_rpay_chg_vat)&#32;-&#32;u_dedt_allot_bond_pamt&#32;-&#32;u_rpay_amt" row="5"/>
						<cell col="1" display="number" expr="(pay_new_allot_bond_pamt+pay_chg_allot_bond_pamt+rpay_new_allot_bond_pamt+rpay_chg_allot_bond_pamt+pay_usim_bond_pamt+rpay_usim_bond_pamt+pay_new_allot_vat&#32;+pay_chg_allot_vat+rpay_new_allot_vat+rpay_chg_allot_vat+supl_pay_new_pamt&#32;+&#32;supl_pay_chg_pamt+supl_rpay_new_pamt+supl_rpay_chg_pamt+supl_pay_new_vat+supl_pay_chg_vat+supl_rpay_new_vat+supl_rpay_chg_vat)&#32;-&#32;dedt_allot_bond_pamt&#32;-&#32;rpay_amt" row="5"/>
						<cell bkcolor="user32" col="2" display="number" expr="((u_pay_new_allot_bond_pamt+u_pay_chg_allot_bond_pamt+u_rpay_new_allot_bond_pamt+u_rpay_chg_allot_bond_pamt+u_pay_usim_bond_pamt+u_rpay_usim_bond_pamt+u_pay_new_allot_vat&#32;+u_pay_chg_allot_vat+u_rpay_new_allot_vat+u_rpay_chg_allot_vat+u_supl_pay_new_pamt&#32;+&#32;u_supl_pay_chg_pamt+u_supl_rpay_new_pamt+u_supl_rpay_chg_pamt+u_supl_pay_new_vat+u_supl_pay_chg_vat+u_supl_rpay_new_vat+u_supl_rpay_chg_vat)&#32;-&#32;u_dedt_allot_bond_pamt&#32;-&#32;u_rpay_amt)+((pay_new_allot_bond_pamt+pay_chg_allot_bond_pamt+rpay_new_allot_bond_pamt+rpay_chg_allot_bond_pamt+pay_usim_bond_pamt+rpay_usim_bond_pamt+pay_new_allot_vat&#32;+pay_chg_allot_vat+rpay_new_allot_vat+rpay_chg_allot_vat+supl_pay_new_pamt&#32;+&#32;supl_pay_chg_pamt+supl_rpay_new_pamt+supl_rpay_chg_pamt+supl_pay_new_vat+supl_pay_chg_vat+supl_rpay_new_vat+supl_rpay_chg_vat)&#32;-&#32;dedt_allot_bond_pamt&#32;-&#32;rpay_amt)" row="5"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID  : ACCPSS00110
* 업무명      : 정산 - 상품매출정산 
* 프로그램명  : 할부채권정산등록 
--------------------------------------------------------------------------------
* 작성자      : 심연정 
* 작성일      : 2009.02.04
--------------------------------------------------------------------------------
* 1. 변경이력
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

//==============================================================================
// 공통 스크립트 로딩
//==============================================================================
#include "lib::lib_commF.js"
#include "lib::lib_commPopup.js"
#include "lib::lib_util.js" 
#include "lib::lib_commMsg.js"

//==============================================================================
// 전역변수선언
//==============================================================================

var FV_LOGIN_ID     = gds_session.GetColumn(0, "loginId");  //사용자계정
var FV_USER_NM      = gds_session.GetColumn(0, "userNm");   //사용자명 
var FV_ORG_ID       = gds_session.GetColumn(0, "orgId");    //조직코드
var FV_ORG_CL       = gds_session.GetColumn(0, "orgCl");    //조직구분
var FV_SUP_ORG_ID   = gds_session.GetColumn(0, "supOrgId"); //상위조직코드
var FV_USER_GRP     = gds_session.GetColumn(0, "userGrp");  //사용자그룹
var FV_ORG_AREA     = gds_session.GetColumn(0, "orgAreaId");//근무지코드
var FV_POS_AGENCY_ID =gds_session.GetColumn(0,"posAgencyId");         // 소속 대리점ID
var FV_POS_AGENCY_NM = "" ;       // 소속 대리점명

var FV_POS_AGENCY_UKEY_ID =gds_session.GetColumn(0,"posAgencyUkeyId");  // 소속 대리점UKEY ID
var FV_ACC_MTH = "";
var FV_LAST_ACC_MTH = "";
var FV_UEKY_TRANS_DT = "";

/*******************************************************************************
 * @description    : 최초 폼 로드시 발생 - 이벤트
*******************************************************************************/
function ACCPSS00110_OnLoadCompleted(obj)
{
    // 권한 설정
    cf_setAuth(pFrmNum);
    
    ds_condition.ClearData();
    
    //cf_setGrdChecknSortEvent(grd_list);
    
    div_search.cal_accMth.Value = payDtm;
    // div_search.edt_agencyId.Text = posAgency ;
    div_search.edt_agencyNm.Text = posAgencyNm;
    div_search.edt_accPlc.Text = accPlc;

    // f_set_gridFocus(grd_fixList, 0, 0);
    
    cf_setParam(ds_condition, "acc_mth", payDtm); 
    cf_setParam(ds_condition, "pos_agency", posAgency); 
    //ds_accUkey.AddRow();
    ds_accClose.AddRow();
    ds_save_ukey.AddRow();
    ds_save_cnfm.AddRow();
    f_search();
    // ds_fixList.AddRow();
    // ds_fixList.SetColumn(0,"skt_rtn_amt","0");
}
/*******************************************************************************
 * @description    : 입금 미확정 수납대행 리스트 조회
*******************************************************************************/
function f_search()
{
    var sSvcID  = "svcChag";
    var sInDs   = "nc_input_fieldDs=ds_condition";
    var sOutDs  = "ds_accClose=ds_accClose ds_accUkey=ds_accUkey";
    var sArg    = "sktst.acc.PSS#getBondDtl";
    
    cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}
/*******************************************************************************
 * @description    :  콜백
*******************************************************************************/
function f_callBack(sSvcID)
{   
     if(sSvcID == "svcChag"){

        if(ds_accClose.GetRowCount() ==0){
            ds_accClose.AddRow();
        }
        if(ds_accUkey.GetRowCount() ==0){
            alert("U.Key 금액이 전송되지 않았습니다.");
            btn_save.Visible = false;
        }
        f_set_color();
        
        	grd_accUkey.Editable = false;
			grd_dedtUkey.Editable = false;
			
        if(!uf_IsNull(erpFixYn)){
			alert("ERP 전송이 완료되었습니다.");
			grd_accUkey.Editable = false;
			grd_dedtUkey.Editable = false;
			btn_save.Visible = false;
        }
        
     }
     if(sSvcID == "svcSaveUkey"){
        f_save_Cnfm();
     }
     if(sSvcID == "svcSaveCnfm"){
		this.Close();
     }
    
}
/*******************************************************************************
 * @description    : 닫기- 이벤트
*******************************************************************************/
function btn_close_OnClick(obj)
{
    this.Close();
}

/*******************************************************************************
 * @description    : 저장버튼 이벤트
*******************************************************************************/
function btn_save_OnClick(obj)
{
	/*
	cf_CheckCloseMnth('03',div_search.cal_accMth.value,"정산월");  // 03: 정산 	
    if(FV_BOOLEAN_CLOSE) return; // 입력한 일자가 마감 되었을 경우 '1'(true) 리턴.
   
    cf_CheckCloseDay('04',Left(cf_getDate(), 8),"저장일"); 
	if(FV_BOOLEAN_CLOSE) return; // 입력한 일자가 마감 되었을 경우 '1'(true) 리턴.
	 */
	 
    f_set_ds_ukey();
    f_set_ds_cnfm();
    // 마감월 체크
	//cf_CheckCloseMnth('03',div_search.cal_accMth.value,"정산월"); // 03: 정산
	//if(FV_BOOLEAN_CLOSE) return; // 입력한 일자가 마감 되었을 경우 '1'(true) 리턴.
    f_save_Ukey();
    //this.Close();
    
}
/*******************************************************************************
 * @description    : 글자색 변경
*******************************************************************************/
function f_set_color(){
        if(ds_accUkey.GetColumn(0,"u_pay_new_allot_bond_pamt") != ds_accClose.GetColumn(0,"pay_new_allot_bond_pamt")){
            grd_accClose.SetCellProp("body",2,"color", "red");
        }
        if(ds_accUkey.GetColumn(0,"u_pay_chg_allot_bond_pamt") != ds_accClose.GetColumn(0,"chg_allot_pay")){
            grd_accClose.SetCellProp("body",4,"color", "red");
        }
        if(ds_accUkey.GetColumn(0,"u_rpay_new_allot_bond_pamt") != ds_accClose.GetColumn(0,"new_allot_rpay")){
            grd_accClose.SetCellProp("body",6,"color", "red");
        }
        if(ds_accUkey.GetColumn(0,"u_rpay_chg_allot_bond_pamt") != ds_accClose.GetColumn(0,"chg_allot_rpay")){
            grd_accClose.SetCellProp("body",8,"color", "red");
        }
        if(ds_accUkey.GetColumn(0,"u_pay_usim_bond_pamt") != ds_accClose.GetColumn(0,"usim_allot_pay")){
            grd_accClose.SetCellProp("body",11,"color", "red");
        }
       
        if(ds_accUkey.GetColumn(0,"u_rpay_usim_bond_pamt") != ds_accClose.GetColumn(0,"usim_allot_rpay")){
            grd_accClose.SetCellProp("body",13,"color", "red");
        }
                       
        if(grd_accClose.GetCellText("body",0,16) != grd_accUkey.GetCellText("body",0,18)){
            grd_accClose.SetCellProp("body",16,"color", "red");
        }
        if(grd_accClose.GetCellText("body",0,18) != grd_accUkey.GetCellText("body",0,21)){
            grd_accClose.SetCellProp("body",18,"color", "red");
        }   
        if(grd_accClose.GetCellText("body",0,20) != grd_accUkey.GetCellText("body",0,24)){
            grd_accClose.SetCellProp("body",20,"color", "red");
        }
        if(grd_accClose.GetCellText("body",0,22) != grd_accUkey.GetCellText("body",0,27)){
            grd_accClose.SetCellProp("body",22,"color", "red");
        }       
        if(grd_accClose.GetCellText("body",0,25) != grd_accUkey.GetCellText("body",0,30)){
            grd_accClose.SetCellProp("body",25,"color", "red");
        }
        
        if(grd_accClose.GetCellText("body",0,27) != grd_accUkey.GetCellText("body",0,33)){
            grd_accClose.SetCellProp("body",27,"color", "red");
        }                                       
        if(grd_accClose.GetCellText("body",0,29) != grd_accUkey.GetCellText("body",0,36)){
            grd_accClose.SetCellProp("body",29,"color", "red");
        }
        
        if(grd_accClose.GetCellText("body",0,31) != grd_accUkey.GetCellText("body",0,39)){
            grd_accClose.SetCellProp("body",31,"color", "red");
        }
        if(grd_accClose.GetCellText("body",0,34) != grd_accUkey.GetCellText("body",0,42)){
            grd_accClose.SetCellProp("body",34,"color", "red");
        }   
        if(grd_accClose.GetCellText("body",0,36) != grd_accUkey.GetCellText("body",0,45)){
            grd_accClose.SetCellProp("body",36,"color", "red");
        }
        if(grd_accClose.GetCellText("body",0,38) != grd_accUkey.GetCellText("body",0,48)){
            grd_accClose.SetCellProp("body",38,"color", "red");
        }       
        if(grd_accClose.GetCellText("body",0,40) != grd_accUkey.GetCellText("body",0,51)){
            grd_accClose.SetCellProp("body",40,"color", "red");
        }
        if(grd_accClose.GetCellText("body",0,42) != grd_accUkey.GetCellText("body",0,54)){
            grd_accClose.SetCellProp("body",42,"color", "red");
        }               
        
        /*
        if(grd_accClose.GetCellText("body",0,44) != grd_accUkey.GetCellText("body",0,57)){
            grd_accClose.SetCellProp("body",44,"color", "red");
        }  
        
        if(grd_accClose.GetCellText("body",0,46) != grd_accUkey.GetCellText("body",0,60)){
            grd_accClose.SetCellProp("body",46,"color", "red");
        }  
        
        if(grd_accClose.GetCellText("body",0,48) != grd_accUkey.GetCellText("body",0,63)){
            grd_accClose.SetCellProp("body",48,"color", "red");
        }  
        */
                
        if(grd_dedtClose.GetCellText("body",0,1) != grd_dedtUkey.GetCellText("body",0,0)){
            grd_dedtClose.SetCellProp("body",1,"color", "red");
        }
        if(grd_dedtClose.GetCellText("body",0,4) != grd_dedtUkey.GetCellText("body",0,3)){
            grd_dedtClose.SetCellProp("body",4,"color", "red");
        }
        if(grd_dedtClose.GetCellText("body",0,6) != grd_dedtUkey.GetCellText("body",0,6)){
            grd_dedtClose.SetCellProp("body",6,"color", "red");
        }
        if(grd_dedtClose.GetCellText("body",0,8) != grd_dedtUkey.GetCellText("body",0,9)){
            grd_dedtClose.SetCellProp("body",8,"color", "red");
        }
        if(grd_dedtClose.GetCellText("body",0,10) != grd_dedtUkey.GetCellText("body",0,12)){
            grd_dedtClose.SetCellProp("body",10,"color", "red");
        }
        if(grd_dedtClose.GetCellText("body",0,12) != grd_dedtUkey.GetCellText("body",0,15)){
            grd_dedtClose.SetCellProp("body",12,"color", "red");
        }
}

/*******************************************************************************
 * @description    : 저장전 데이터셋 설정_ukey
*******************************************************************************/
function f_set_ds_ukey(){
    ds_save_ukey.SetColumn(0,"deal_co_cd",ds_accUkey.GetColumn(0,"deal_co_cd"));
    ds_save_ukey.SetColumn(0,"acc_mth",ds_condition.GetColumn(0,"acc_mth"));
    ds_save_ukey.SetColumn(0,"acc_plc","10001");
    ds_save_ukey.SetColumn(0,"pay_new_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_pay_new_allot_bond_pamt"));
    ds_save_ukey.SetColumn(0,"pay_chg_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_pay_chg_allot_bond_pamt"));
    ds_save_ukey.SetColumn(0,"rpay_new_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_rpay_new_allot_bond_pamt"));
    ds_save_ukey.SetColumn(0,"rpay_chg_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_rpay_chg_allot_bond_pamt"));
    ds_save_ukey.SetColumn(0,"pay_usim_bond_pamt",ds_accUkey.GetColumn(0,"u_pay_usim_bond_pamt"));
    ds_save_ukey.SetColumn(0,"rpay_usim_bond_pamt",ds_accUkey.GetColumn(0,"u_rpay_usim_bond_pamt"));
    ds_save_ukey.SetColumn(0,"pay_new_allot_vat",ds_accUkey.GetColumn(0,"u_pay_new_allot_vat"));
    ds_save_ukey.SetColumn(0,"pay_chg_allot_vat",ds_accUkey.GetColumn(0,"u_pay_chg_allot_vat"));
    ds_save_ukey.SetColumn(0,"rpay_new_allot_vat",ds_accUkey.GetColumn(0,"u_rpay_new_allot_vat"));
    ds_save_ukey.SetColumn(0,"rpay_chg_allot_vat",ds_accUkey.GetColumn(0,"u_rpay_chg_allot_vat"));
    ds_save_ukey.SetColumn(0,"supl_pay_new_pamt",ds_accUkey.GetColumn(0,"u_supl_pay_new_pamt"));
    ds_save_ukey.SetColumn(0,"supl_pay_chg_pamt",ds_accUkey.GetColumn(0,"u_supl_pay_chg_pamt"));
    ds_save_ukey.SetColumn(0,"supl_rpay_new_pamt",ds_accUkey.GetColumn(0,"u_supl_rpay_new_pamt"));
    ds_save_ukey.SetColumn(0,"supl_rpay_chg_pamt",ds_accUkey.GetColumn(0,"u_supl_rpay_chg_pamt"));
    ds_save_ukey.SetColumn(0,"supl_pay_new_vat",ds_accUkey.GetColumn(0,"u_supl_pay_new_vat"));
    ds_save_ukey.SetColumn(0,"supl_pay_chg_vat",ds_accUkey.GetColumn(0,"u_supl_pay_chg_vat"));
    ds_save_ukey.SetColumn(0,"supl_rpay_new_vat",ds_accUkey.GetColumn(0,"u_supl_rpay_new_vat"));
    ds_save_ukey.SetColumn(0,"supl_rpay_chg_vat",ds_accUkey.GetColumn(0,"u_supl_rpay_chg_vat"));
    ds_save_ukey.SetColumn(0,"dedt_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_dedt_allot_bond_pamt"));
    ds_save_ukey.SetColumn(0,"rpay_obj_amt",ds_accUkey.GetColumn(0,"u_rpay_obj_amt"));
    ds_save_ukey.SetColumn(0,"rpay_amt",ds_accUkey.GetColumn(0,"u_rpay_amt"));
    ds_save_ukey.SetColumn(0,"adpay_deal_co_amt",ds_accUkey.GetColumn(0,"u_adpay_deal_co_amt"));
    //ds_save_ukey.SetColumn(0,"rmks",ds_accUkey.GetColumn(0,"rmks")));
}

/*******************************************************************************
 * @description    : 저장전 데이터셋 설정_확정
*******************************************************************************/

function f_set_ds_cnfm(){
    ds_save_cnfm.SetColumn(0,"deal_co_cd",ds_accUkey.GetColumn(0,"deal_co_cd"));
    ds_save_cnfm.SetColumn(0,"acc_mth",ds_condition.GetColumn(0,"acc_mth"));
    ds_save_cnfm.SetColumn(0,"acc_plc","10001");
    ds_save_cnfm.SetColumn(0,"u_key_trms_dtm",ds_accUkey.GetColumn(0,"u_key_trms_dtm"));
    ds_save_cnfm.SetColumn(0,"pay_new_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_pay_new_allot_bond_pamt") + ds_accUkey.GetColumn(0,"pay_new_allot_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"pay_chg_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_pay_chg_allot_bond_pamt") + ds_accUkey.GetColumn(0,"pay_chg_allot_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"rpay_new_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_rpay_new_allot_bond_pamt") + ds_accUkey.GetColumn(0,"rpay_new_allot_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"rpay_chg_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_rpay_chg_allot_bond_pamt") + ds_accUkey.GetColumn(0,"rpay_chg_allot_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"pay_usim_bond_pamt",ds_accUkey.GetColumn(0,"u_pay_usim_bond_pamt") + ds_accUkey.GetColumn(0,"pay_usim_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"rpay_usim_bond_pamt",ds_accUkey.GetColumn(0,"u_rpay_usim_bond_pamt") + ds_accUkey.GetColumn(0,"rpay_usim_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"pay_new_allot_vat",ds_accUkey.GetColumn(0,"u_pay_new_allot_vat") + ds_accUkey.GetColumn(0,"pay_new_allot_vat"));
    ds_save_cnfm.SetColumn(0,"pay_chg_allot_vat",ds_accUkey.GetColumn(0,"u_pay_chg_allot_vat") + ds_accUkey.GetColumn(0,"pay_chg_allot_vat"));
    ds_save_cnfm.SetColumn(0,"rpay_new_allot_vat",ds_accUkey.GetColumn(0,"u_rpay_new_allot_vat") + ds_accUkey.GetColumn(0,"rpay_new_allot_vat"));
    ds_save_cnfm.SetColumn(0,"rpay_chg_allot_vat",ds_accUkey.GetColumn(0,"u_rpay_chg_allot_vat") + ds_accUkey.GetColumn(0,"rpay_chg_allot_vat"));
    ds_save_cnfm.SetColumn(0,"supl_pay_new_pamt",ds_accUkey.GetColumn(0,"u_supl_pay_new_pamt") + ds_accUkey.GetColumn(0,"supl_pay_new_pamt"));
    ds_save_cnfm.SetColumn(0,"supl_pay_chg_pamt",ds_accUkey.GetColumn(0,"u_supl_pay_chg_pamt") + ds_accUkey.GetColumn(0,"supl_pay_chg_pamt"));
    ds_save_cnfm.SetColumn(0,"supl_rpay_new_pamt",ds_accUkey.GetColumn(0,"u_supl_rpay_new_pamt") + ds_accUkey.GetColumn(0,"supl_rpay_new_pamt"));
    ds_save_cnfm.SetColumn(0,"supl_rpay_chg_pamt",ds_accUkey.GetColumn(0,"u_supl_rpay_chg_pamt") + ds_accUkey.GetColumn(0,"supl_rpay_chg_pamt"));
    ds_save_cnfm.SetColumn(0,"supl_pay_new_vat",ds_accUkey.GetColumn(0,"u_supl_pay_new_vat") + ds_accUkey.GetColumn(0,"supl_pay_new_vat"));
    ds_save_cnfm.SetColumn(0,"supl_pay_chg_vat",ds_accUkey.GetColumn(0,"u_supl_pay_chg_vat") + ds_accUkey.GetColumn(0,"supl_pay_chg_vat"));
    ds_save_cnfm.SetColumn(0,"supl_rpay_new_vat",ds_accUkey.GetColumn(0,"u_supl_rpay_new_vat") + ds_accUkey.GetColumn(0,"supl_rpay_new_vat"));
    ds_save_cnfm.SetColumn(0,"supl_rpay_chg_vat",ds_accUkey.GetColumn(0,"u_supl_rpay_chg_vat") + ds_accUkey.GetColumn(0,"supl_rpay_chg_vat"));
    ds_save_cnfm.SetColumn(0,"dedt_allot_bond_pamt",ds_accUkey.GetColumn(0,"u_dedt_allot_bond_pamt") + ds_accUkey.GetColumn(0,"dedt_allot_bond_pamt"));
    ds_save_cnfm.SetColumn(0,"rpay_obj_amt",ds_accUkey.GetColumn(0,"u_rpay_obj_amt") + ds_accUkey.GetColumn(0,"rpay_obj_amt"));
    ds_save_cnfm.SetColumn(0,"rpay_amt",ds_accUkey.GetColumn(0,"u_rpay_amt") + ds_accUkey.GetColumn(0,"rpay_amt"));
    ds_save_cnfm.SetColumn(0,"adpay_deal_co_amt",ds_accUkey.GetColumn(0,"u_adpay_deal_co_amt") + ds_accUkey.GetColumn(0,"adpay_deal_co_amt"));
    //ds_save_cnfm.SetColumn(0,"rmks",toNumber(ds_accUkey.GetColumn(0,"rmks")));
}

function f_save_Ukey(){
    var sSvcID  = "svcSaveUkey";
    var sInDs   = "ds_save_ukey=ds_save_ukey";
    var sOutDs  = "";
    var sArg    = "sktst.acc.PSS#saveAllotBondUkey";

    // 공통 트랜잭션 호출
    cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}

function f_save_Cnfm(){
    var sSvcID  = "svcSaveCnfm";
    var sInDs   = "ds_save_cnfm=ds_save_cnfm";
    var sOutDs  = "";
    var sArg    = "sktst.acc.PSS#saveAllotBondAcc";

    // 공통 트랜잭션 호출
    cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}
/*******************************************************************************
 * @description    : excel export
*******************************************************************************/
function btn_excel_OnClick(obj)
{
    cf_setExcelInfo("grd_accClose", "할부채권정산내역" );
    cf_setExcelInfo("grd_accUkey", "할부채권정산내역" , "d1");
    cf_exportDinamicExcel();    
}

function btn_excel2_OnClick(obj)
{
    cf_setExcelInfo("grd_dedtClose", "할부채권공제내역" );
    cf_setExcelInfo("grd_dedtUkey", "할부채권공제내역" , "d1");
    cf_exportDinamicExcel();
}
 
]]></Script>
</Window>