<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="600" Id="POLASP00400" Left="8" OnLoadCompleted="POLASP00400_OnLoadCompleted" PidAttrib="7" Title="부가상품수수료&#32;등록" Top="8" Ver="1.0" Width="830" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_PayCondCd">
				<Contents>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
					<record>
						<COMM_CD_VAL>01</COMM_CD_VAL>
						<COMM_CD_VAL_NM>P</COMM_CD_VAL_NM>
					</record>
					<record>
						<COMM_CD_VAL>02</COMM_CD_VAL>
						<COMM_CD_VAL_NM>M</COMM_CD_VAL_NM>
					</record>
					<record>
						<COMM_CD_VAL>00</COMM_CD_VAL>
						<COMM_CD_VAL_NM>PM</COMM_CD_VAL_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_month">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
					</record>
					<record>
						<CODE>02</CODE>
					</record>
					<record>
						<CODE>03</CODE>
					</record>
					<record>
						<CODE>04</CODE>
					</record>
					<record>
						<CODE>05</CODE>
					</record>
					<record>
						<CODE>06</CODE>
					</record>
					<record>
						<CODE>07</CODE>
					</record>
					<record>
						<CODE>08</CODE>
					</record>
					<record>
						<CODE>09</CODE>
					</record>
					<record>
						<CODE>10</CODE>
					</record>
					<record>
						<CODE>11</CODE>
					</record>
					<record>
						<CODE>12</CODE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_suplSvcCmms" OnColumnChanged="ds_suplSvcCmms_OnColumnChanged">
				<Contents>
					<colinfo id="SPOL_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_TS" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_STA_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_END_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_OPER" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_SUBJ" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_SCHD_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PLST_APLY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_MDL_APLY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="OPR_MTHD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_COND_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOIN_RT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMMS" size="256" summ="default" type="STRING"/>
					<colinfo id="CMMS_M" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_APLY_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="BAK_APLY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_DVS" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents>
					<colinfo id="SPOL_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_TS" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_STA_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_END_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MIN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="END_MIN" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TCNT" size="256" summ="default" type="STRING"/>
					<record>
						<APLY_END_DTM></APLY_END_DTM>
						<APLY_STA_DTM></APLY_STA_DTM>
						<END_HOUR></END_HOUR>
						<END_MIN></END_MIN>
						<HOUR></HOUR>
						<LAST_YN></LAST_YN>
						<MIN></MIN>
						<ORG_ID></ORG_ID>
						<POL_TS></POL_TS>
						<POL_YM></POL_YM>
						<SPOL_ID></SPOL_ID>
						<TCNT></TCNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_orgInfo" OnColumnChanged="ds_orgInfo_OnColumnChanged">
				<Contents>
					<colinfo id="ORG_ID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_NM_1" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT1" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_ID_2" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_NM_2" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_ID_3" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_NM_3" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT3" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_ID_4" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_NM_4" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT4" size="256" summ="default" type="STRING"/>
					<colinfo id="LRGFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MDLFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="SMLFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="EMLFLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_polOper">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_polSubj">
				<Contents>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_polYm">
				<Contents>
					<colinfo id="POL_YM" size="256" summ="default" type="STRING"/>
					<record>
						<POL_YM>2009</POL_YM>
					</record>
					<record>
						<POL_YM>2008</POL_YM>
					</record>
					<record>
						<POL_YM>2007</POL_YM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_slNet">
				<Contents>
					<colinfo id="SL_NET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SL_NET_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dsNet">
				<Contents>
					<colinfo id="DS_NET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_NET_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleTyp" OnColumnChanged="ds_saleTyp_OnColumnChanged">
				<Contents>
					<colinfo id="SALE_TYP_CD_1" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_TYP_CD_2" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_TYP_CD_3" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECT3" size="256" summ="default" type="STRING"/>
					<colinfo id="LRGFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MDLFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="SMLFLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_objtModel">
				<Contents>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CHRTIC_1_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CHRTIC_2_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SKT_OPER_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_aplyModel">
				<Contents>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CHRTIC_1_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CHRTIC_2_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SKT_OPER_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mfact">
				<Contents>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rdoYn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<NAME>예</NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<NAME>아니오</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prodChrtic1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prodChrtic2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sktOperYn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<NAME>전체</NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<NAME>예</NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<NAME>아니오</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_payCl">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<NAME>지급</NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<NAME>환수</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bakAplyYn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>N</CODE>
						<NAME>선지급</NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<NAME>후지급</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleTypCdMax" OnColumnChanged="ds_saleTyp_OnColumnChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleTypCdMid" OnColumnChanged="ds_saleTyp_OnColumnChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleTypCdMin" OnColumnChanged="ds_saleTyp_OnColumnChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_agrmtPrd">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plstAplyYn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<NAME>예</NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<NAME>아니오</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_suplSvc">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPL_SVC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPL_SVC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PR_MNY" size="256" summ="default" type="STRING"/>
					<colinfo id="IDM_LMT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDS_PRD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PLST_APLY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
					<record>
						<ENDS_PRD_CD></ENDS_PRD_CD>
						<IDM_LMT_CD></IDM_LMT_CD>
						<PLST_APLY_YN></PLST_APLY_YN>
						<POL_NM></POL_NM>
						<PR_MNY></PR_MNY>
						<SELECTED></SELECTED>
						<SEQ>Y</SEQ>
						<SUPL_SVC_CD>예</SUPL_SVC_CD>
						<SUPL_SVC_NM></SUPL_SVC_NM>
					</record>
					<record>
						<ENDS_PRD_CD></ENDS_PRD_CD>
						<IDM_LMT_CD></IDM_LMT_CD>
						<PLST_APLY_YN></PLST_APLY_YN>
						<POL_NM></POL_NM>
						<PR_MNY></PR_MNY>
						<SELECTED></SELECTED>
						<SEQ>N</SEQ>
						<SUPL_SVC_CD>아니오</SUPL_SVC_CD>
						<SUPL_SVC_NM></SUPL_SVC_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spolSuplMgmt">
				<Contents>
					<colinfo id="SPOL_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_TS" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_STA_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_END_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_OPER" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_SUBJ" size="256" summ="default" type="STRING"/>
					<colinfo id="ACC_SCHD_MTH" size="256" summ="default" type="STRING"/>
					<colinfo id="PLST_APLY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_DVS" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_DVS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_suplSvcCmms">
				<Contents>
					<colinfo id="SPOL_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_TS" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="OPR_MTHD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_COND_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_APLY_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="CMMS" size="256" summ="default" type="STRING"/>
					<colinfo id="CMMS_M" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_DVS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_objtSalePlc">
				<Contents>
					<colinfo id="ORG_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_APLY_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_aplySalePlc">
				<Contents>
					<colinfo id="ORG_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_APLY_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_payInfo">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPL_SVC_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPL_SVC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPL_SVC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PR_MNY" size="256" summ="default" type="STRING"/>
					<colinfo id="IDM_LMT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDS_PRD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PLST_APLY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="POL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SELECTED" size="256" summ="default" type="STRING"/>
					<record>
						<ENDS_PRD_CD></ENDS_PRD_CD>
						<IDM_LMT_CD></IDM_LMT_CD>
						<PLST_APLY_YN></PLST_APLY_YN>
						<POL_NM></POL_NM>
						<PR_MNY></PR_MNY>
						<SELECTED></SELECTED>
						<SEQ>Y</SEQ>
						<SUPL_SVC_CD>예</SUPL_SVC_CD>
						<SUPL_SVC_CL></SUPL_SVC_CL>
						<SUPL_SVC_NM></SUPL_SVC_NM>
					</record>
					<record>
						<ENDS_PRD_CD></ENDS_PRD_CD>
						<IDM_LMT_CD></IDM_LMT_CD>
						<PLST_APLY_YN></PLST_APLY_YN>
						<POL_NM></POL_NM>
						<PR_MNY></PR_MNY>
						<SELECTED></SELECTED>
						<SEQ>N</SEQ>
						<SUPL_SVC_CD>아니오</SUPL_SVC_CD>
						<SUPL_SVC_CL></SUPL_SVC_CL>
						<SUPL_SVC_NM></SUPL_SVC_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_suplSvcCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_idmLmtCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_endsPrdCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oprMthdcd">
				<Contents>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
					<record>
						<COMM_CD_VAL>01</COMM_CD_VAL>
						<COMM_CD_VAL_NM>AND</COMM_CD_VAL_NM>
					</record>
					<record>
						<COMM_CD_VAL>02</COMM_CD_VAL>
						<COMM_CD_VAL_NM>OR</COMM_CD_VAL_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_salePlcAplyCl">
				<Contents>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
					<record>
						<COMM_CD_VAL>01</COMM_CD_VAL>
						<COMM_CD_VAL_NM>정산처별</COMM_CD_VAL_NM>
					</record>
					<record>
						<COMM_CD_VAL>02</COMM_CD_VAL>
						<COMM_CD_VAL_NM>판매처별</COMM_CD_VAL_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dealCoCl">
				<Contents>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
					<record>
						<COMM_CD_VAL></COMM_CD_VAL>
						<COMM_CD_VAL_NM>전체</COMM_CD_VAL_NM>
					</record>
					<record>
						<COMM_CD_VAL>A3</COMM_CD_VAL>
						<COMM_CD_VAL_NM>판매점</COMM_CD_VAL_NM>
					</record>
					<record>
						<COMM_CD_VAL>A4</COMM_CD_VAL>
						<COMM_CD_VAL_NM>MM</COMM_CD_VAL_NM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Tab Border="Flat" Height="381" Id="tab_suplSvcCmms" Left="5" MouseOverColor="user12" OnChanged="tab_suplSvcCmms_OnChanged" SelColor="user11" SelectFont="돋움,9,Bold" Style="sty_tab" TabIndex="3" TabOrder="2" Top="91" Width="820">
			<Contents>
				<TabPage BorderColor="black" Height="352" Id="tab_orgInfo" ImageID="tab_blue" Left="2" TabOrder="19" Text="조직정보" Top="27" Width="816">
					<Image Align="Left" Height="25" Id="Image2" ImageID="bul_tit" Left="5" LeftMargin="15" Style="sty_img_tit" TabOrder="1" Text="조직정보" Top="5" Width="192"></Image>
					<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="495" LeftMargin="15" Style="sty_img_tit" TabOrder="2" Text="판매처" Top="5" Width="192"></Image>
					<Grid AutoFit="TRUE" BindDataset="ds_orgInfo" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="347" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="317" Id="grd_orgInfo" InputPanel="FALSE" Left="5" LineColor="user33" MinWidth="100" OnHeadClick="tab_suplSvcCmms_tab_orgInfo_grd_orgInfo_OnHeadClick" Right="480" RowHeight="21" Style="sty_Grid" TabOrder="3" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="475">
						<contents>
							<format id="Default">
								<columns>
									<col width="22"/>
									<col width="93"/>
									<col width="22"/>
									<col width="93"/>
									<col width="22"/>
									<col width="110"/>
									<col width="22"/>
									<col width="140"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="본부"/>
									<cell bkcolor="user34" col="2" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="3" color="user35" display="text" text="영업팀"/>
									<cell bkcolor="user34" col="4" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="5" color="user35" display="text" text="영업센터"/>
									<cell bkcolor="user34" col="6" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="7" color="user35" display="text" text="*&#32;대리점"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECT1" display='expr:iif(LRGFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(LRGFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="1"/>
									<cell col="1" colid="ORG_NM_1" display="text" suppress="2"/>
									<cell align="center" col="2" colid="SELECT2" display='expr:iif(MDLFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(MDLFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="3"/>
									<cell col="3" colid="ORG_NM_2" display="text" suppress="4"/>
									<cell align="center" col="4" colid="SELECT3" display='expr:iif(SMLFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(SMLFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="5"/>
									<cell col="5" colid="ORG_NM_3" display="text" suppress="6"/>
									<cell align="center" col="6" colid="SELECT4" display='expr:iif(EMLFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(EMLFLAG&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="7"/>
									<cell col="7" colid="ORG_NM_4" display="text" suppress="8"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button Cursor="HAND" Height="21" Id="Button5" ImageID="btn_i_exceldown_w" Left="793" OnClick="btn_export_OnClick" TabOrder="4" Text="Button1" ToolTipText="Excel&#32;Download" Top="6" Width="19"></Button>
					<Grid AutoFit="TRUE" BindDataset="ds_objtSalePlc" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="345" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="233" Id="grd_objtSalePlc" InputPanel="FALSE" Left="495" LineColor="user33" MinWidth="100" MultiSelect="TRUE" OnHeadClick="tab_suplSvcCmms_tab_orgInfo_grd_objtSalePlc_OnHeadClick" OnMouseOver="tab_suplSvcCmms_tab_orgInfo_grd_objtSalePlc_OnMouseOver" Right="635" RowHeight="21" Style="sty_Grid" TabOrder="5" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="140">
						<contents>
							<format id="Default">
								<columns>
									<col width="22"/>
									<col width="137"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="대상&#32;판매처"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="DEAL_CO_NM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button Cursor="HAND" Height="21" Id="btn_toAplySalePlc" ImageID="btn_i_right_b" Left="644" OnClick="tab_suplSvcCmms_tab_orgInfo_btn_toAplySalePlc_OnClick" TabOrder="7" Text="Button1" Top="167" Width="19"></Button>
					<Button Cursor="HAND" Height="21" Id="btn_toObjtSalePlc" ImageID="btn_i_left_b" Left="644" OnClick="tab_suplSvcCmms_tab_orgInfo_btn_toObjtSalePlc_OnClick" TabOrder="6" Text="Button1" Top="191" Width="19"></Button>
					<Grid AutoFit="TRUE" BindDataset="ds_aplySalePlc" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="345" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="233" Id="grd_aplySalePlc" InputPanel="FALSE" Left="672" LineColor="user33" MinWidth="100" MultiSelect="TRUE" OnHeadClick="tab_suplSvcCmms_tab_orgInfo_grd_aplySalePlc_OnHeadClick" OnMouseOver="tab_suplSvcCmms_tab_orgInfo_grd_aplySalePlc_OnMouseOver" Right="812" RowHeight="21" Style="sty_Grid" TabOrder="8" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="140">
						<contents>
							<format id="Default">
								<columns>
									<col width="22"/>
									<col width="137"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="*&#32;적용&#32;판매처"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="DEAL_CO_NM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Div Border="Raised" Height="70" Id="div_process" Left="493" Style="sty_div_input" TabOrder="9" Text="질의내용" Top="30" Width="319">
						<Contents>
							<Static Align="Right" Height="20" Id="Static0" Left="8" Style="sty_lb_Search" TabOrder="1" Text="구분" Top="37" VAlign="Middle" Width="30"></Static>
							<Combo Border="Flat" CodeColumn="COMM_CD_VAL" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_dealCoCl" INDEX="0" InnerDataset="ds_dealCoCl" Left="40" OnChanged="tab_suplSvcCmms_tab_orgInfo_div_process_cmb_dealCoCl_OnChanged" Style="sty_ipt_form" TabOrder="2" Top="35" Width="100"></Combo>
							<Static Align="Right" Border="None" Height="20" Id="Static5" Left="124" Style="sty_lb_Search" TabOrder="4" Text="영업그룹" Top="37" VAlign="Middle" Width="84"></Static>
							<Combo Border="Flat" Enable="FALSE" Height="20" Id="cmb_saleGrp" INDEX="0" Left="210" OnChanged="tab_suplSvcCmms_tab_orgInfo_div_process_cmb_saleGrp_OnChanged" Style="sty_ipt_form" TabOrder="3" Top="35" Width="100"></Combo>
							<Static Align="Right" Height="20" Id="Static6" Left="19" Style="sty_lb_Search" TabOrder="5" Text="적용&#32;구분" Top="7" VAlign="Middle" Width="76"></Static>
							<Radio BindDataset="ds_suplSvcCmms" Border="None" CodeColumn="COMM_CD_VAL" Column="SALE_PLC_APLY_CL" ColumnCount="2" DataColumn="COMM_CD_VAL_NM" Height="20" Id="rdo_salePlcAplyCl" INDEX="-1" InnerDataset="ds_salePlcAplyCl" Left="102" LeftMargin="5" OnClick="tab_suplSvcCmms_tab_orgInfo_div_process_rdo_salePlcAplyCl_OnClick" RightMargin="25" Style="sty_opt_input" TabOrder="6" Top="7" Width="207"></Radio>
						</Contents>
					</Div>
				</TabPage>
				<TabPage BorderColor="black" Height="352" Id="tab_prodInfo" ImageID="tab_blue" Left="2" TabOrder="19" Text="상품정보" Top="27" Width="816">
					<Div Border="Raised" Height="40" Id="div_process" Left="5" Style="sty_div_input" TabOrder="7" Text="질의내용" Top="5" Width="807">
						<Contents>
							<Combo Border="Flat" CodeColumn="DEAL_CO_CD" DataColumn="DEAL_CO_NM" Height="20" Id="cmb_mfact" InnerDataset="ds_mfact" Left="281" OnChanged="tab_suplSvcCmms_tab_prodInfo_div_process_cmb_mfact_OnChanged" Style="sty_ipt_form" TabOrder="1" Top="5" Width="90"></Combo>
							<Static Align="Right" Height="20" Id="Static6" Left="14" Style="sty_lb_Search" TabOrder="2" Text="전&#32;모델&#32;적용" Top="7" VAlign="Middle" Width="76"></Static>
							<Static Align="Right" Height="20" Id="Static3" Left="210" Style="sty_lb_Search" TabOrder="3" Text="제조사" Top="7" VAlign="Middle" Width="68"></Static>
							<Combo Border="Flat" CodeColumn="COMM_CD_VAL" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_prodChrtic1" Left="440" OnChanged="tab_suplSvcCmms_tab_prodInfo_div_process_cmb_mfact_OnChanged" Style="sty_ipt_form" TabOrder="4" Top="6" Width="66"></Combo>
							<Static Align="Right" Height="20" Id="Static0" Left="370" Style="sty_lb_Search" TabOrder="5" Text="상품특성1" Top="7" VAlign="Middle" Width="68"></Static>
							<Combo Border="Flat" CodeColumn="COMM_CD_VAL" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_prodChrtic2" Left="587" OnChanged="tab_suplSvcCmms_tab_prodInfo_div_process_cmb_mfact_OnChanged" Style="sty_ipt_form" TabOrder="6" Top="5" Width="66"></Combo>
							<Static Align="Right" Height="20" Id="Static1" Left="516" Style="sty_lb_Search" TabOrder="7" Text="상품특성2" Top="7" VAlign="Middle" Width="68"></Static>
							<Radio BindDataset="ds_suplSvcCmms" Border="None" CodeColumn="CODE" Column="ALL_MDL_APLY_YN" ColumnCount="2" DataColumn="NAME" Height="20" Id="rdo_mdlAdpt" INDEX="-1" InnerDataset="ds_rdoYn" Left="94" LeftMargin="5" OnClick="tab_suplSvcCmms_tab_prodInfo_div_process_rdo_mdlAdpt_OnClick" RightMargin="25" Style="sty_opt_input" TabOrder="8" Top="7" Width="129"></Radio>
							<Static Align="Right" Height="20" Id="Static2" Left="658" Style="sty_lb_Search" TabOrder="10" Text="SKT운영" Top="7" VAlign="Middle" Width="68"></Static>
							<Combo Border="Flat" CodeColumn="CODE" DataColumn="NAME" Height="20" Id="cmb_sktOperYn" InnerDataset="ds_sktOperYn" Left="729" OnChanged="tab_suplSvcCmms_tab_prodInfo_div_process_cmb_mfact_OnChanged" Style="sty_ipt_form" TabOrder="9" Top="5" Width="66"></Combo>
						</Contents>
					</Div>
					<Image Align="Left" Height="25" Id="Image2" ImageID="bul_tit" Left="5" LeftMargin="15" Style="sty_img_tit" TabOrder="2" Text="대상&#32;모델" Top="48" Width="192"></Image>
					<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="432" LeftMargin="15" Style="sty_img_tit" TabOrder="3" Text="적용&#32;모델" Top="48" Width="182"></Image>
					<Grid AutoFit="TRUE" BindDataset="ds_aplyModel" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="348" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="275" Id="grd_aplyModel" InputPanel="FALSE" Left="432" LineColor="user33" MinWidth="100" MultiSelect="TRUE" OnHeadClick="tab_suplSvcCmms_tab_prodInfo_grd_aplyModel_OnHeadClick" Right="811" RowHeight="21" Style="sty_Grid" TabOrder="6" TabStop="true" Top="73" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="379">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="106"/>
									<col width="103"/>
									<col width="68"/>
									<col width="67"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="제조사"/>
									<cell bkcolor="user34" col="2" color="user35" display="text" text="*&#32;모델명"/>
									<cell bkcolor="user34" col="3" color="user35" display="text" text="상품특성1"/>
									<cell bkcolor="user34" col="4" color="user35" display="text" text="상품특성2"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="DEAL_CO_NM" display="text"/>
									<cell col="2" colid="PROD_NM" display="text"/>
									<cell col="3" colid="PROD_CHRTIC_1_CD" combocol="COMM_CD_VAL" combodataset="ZBAS_C_00020_2" combotext="COMM_CD_VAL_NM" display="combo"/>
									<cell col="4" colid="PROD_CHRTIC_2_CD" combocol="COMM_CD_VAL" combodataset="ZBAS_C_00030_3" combotext="COMM_CD_VAL_NM" display="combo"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoFit="TRUE" BindDataset="ds_objtModel" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="348" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="275" Id="grd_objtModel" InputPanel="FALSE" Left="5" LineColor="user33" MinWidth="100" MultiSelect="TRUE" OnHeadClick="tab_suplSvcCmms_tab_prodInfo_grd_objtModel_OnHeadClick" Right="384" RowHeight="21" Style="sty_Grid" TabOrder="1" TabStop="true" Top="73" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="379">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="106"/>
									<col width="103"/>
									<col width="68"/>
									<col width="67"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="제조사"/>
									<cell bkcolor="user34" col="2" color="user35" display="text" text="모델명"/>
									<cell bkcolor="user34" col="3" color="user35" display="text" text="상품특성1"/>
									<cell bkcolor="user34" col="4" color="user35" display="text" text="상품특성2"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="DEAL_CO_NM" display="text"/>
									<cell col="2" colid="PROD_NM" display="text"/>
									<cell col="3" colid="PROD_CHRTIC_1_CD" combocol="COMM_CD_VAL" combodataset="ZBAS_C_00020_2" combotext="COMM_CD_VAL_NM" display="combo"/>
									<cell col="4" colid="PROD_CHRTIC_2_CD" combocol="COMM_CD_VAL" combodataset="ZBAS_C_00030_3" combotext="COMM_CD_VAL_NM" display="combo"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button Cursor="HAND" Height="21" Id="btn_toAplyModel" ImageID="btn_i_right_b" Left="399" OnClick="tab_suplSvcCmms_tab_prodInfo_btn_toAplyModel_OnClick" TabOrder="5" Text="Button1" Top="176" Width="19"></Button>
					<Button Cursor="HAND" Height="21" Id="btn_toObjtModel" ImageID="btn_i_left_b" Left="399" OnClick="tab_suplSvcCmms_tab_prodInfo_btn_toObjtModel_OnClick" TabOrder="4" Text="Button1" Top="200" Width="19"></Button>
					<Button Cursor="HAND" Height="21" Id="Button8" ImageID="btn_i_exceldown_w" Left="791" OnClick="btn_export_OnClick2" TabOrder="8" Text="Button1" ToolTipText="Excel&#32;Download" Top="51" Width="19"></Button>
				</TabPage>
				<TabPage BorderColor="black" Height="352" Id="tab_saleInfo" ImageID="tab_blue" Left="2" TabOrder="19" Text="영업정보" Top="27" Width="816">
					<Grid AutoFit="TRUE" BindDataset="ds_slNet" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="347" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="317" Id="grd_slNet" InputPanel="FALSE" Left="5" LineColor="user33" MinWidth="100" OnHeadClick="tab_suplSvcCmms_tab_saleInfo_grd_slNet_OnHeadClick" Right="193" RowHeight="21" Style="sty_Grid" TabOrder="4" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="188">
						<contents>
							<format id="Default">
								<columns>
									<col width="35"/>
									<col width="173"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="*&#32;영업망"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display='expr:iif(sl_net_cd&#32;==null,&quot;none&quot;,&quot;checkbox&quot;)' edit='expr:iif(sl_net_cd&#32;==null,&quot;none&quot;,&quot;checkbox&quot;)'/>
									<cell col="1" colid="SL_NET_NM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoFit="TRUE" BindDataset="ds_dsNet" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="347" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="317" Id="grd_dsNet" InputPanel="FALSE" Left="204" LineColor="user33" MinWidth="100" OnHeadClick="tab_suplSvcCmms_tab_saleInfo_grd_dsNet_OnHeadClick" Right="392" RowHeight="21" Style="sty_Grid" TabOrder="5" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="188">
						<contents>
							<format id="Default">
								<columns>
									<col width="35"/>
									<col width="173"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="*&#32;유통망"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display='expr:iif(ds_net_cd&#32;==null,&quot;none&quot;,&quot;checkbox&quot;)' edit='expr:iif(ds_net_cd&#32;==null,&quot;none&quot;,&quot;checkbox&quot;)'/>
									<cell col="1" colid="DS_NET_NM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoFit="TRUE" BindDataset="ds_saleTyp" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="347" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="317" Id="grd_saleTyp" InputPanel="FALSE" Left="403" LineColor="user33" MinWidth="100" OnHeadClick="tab_suplSvcCmms_tab_saleInfo_grd_saleTyp_OnHeadClick" Right="812" RowHeight="21" Style="sty_Grid" TabOrder="6" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="409">
						<contents>
							<format id="Default">
								<columns>
									<col width="35"/>
									<col width="100"/>
									<col width="35"/>
									<col width="100"/>
									<col width="35"/>
									<col width="100"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="대분류"/>
									<cell bkcolor="user34" col="2" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="3" color="user35" display="text" text="중분류"/>
									<cell bkcolor="user34" col="4" color="user35" display="checkbox" edit="checkbox"/>
									<cell bkcolor="user34" col="5" color="user35" display="text" text="*&#32;소분류"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECT1" display='expr:iif(lrgFlag&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(lrgFlag&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="1"/>
									<cell col="1" colid="SALE_TYP_CD_1" combocol="COMM_CD_VAL" combodataset="ds_saleTypCdMax" combotext="COMM_CD_VAL_NM" display="combo" suppress="2"/>
									<cell align="center" col="2" colid="SELECT2" display='expr:iif(mdlFlag&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(mdlFlag&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="3"/>
									<cell col="3" colid="SALE_TYP_CD_2" combocol="COMM_CD_VAL" combodataset="ds_saleTypCdMid" combotext="COMM_CD_VAL_NM" display="combo" suppress="4"/>
									<cell align="center" col="4" colid="SELECT3" display='expr:iif(smlFlag&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' edit='expr:iif(smlFlag&#32;==&quot;Y&quot;,&quot;checkbox&quot;,&quot;none&quot;)' suppress="5"/>
									<cell col="5" colid="SALE_TYP_CD_3" combocol="COMM_CD_VAL" combodataset="ds_saleTypCdMin" combotext="COMM_CD_VAL_NM" display="combo" suppress="6"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="403" LeftMargin="15" Style="sty_img_tit" TabOrder="3" Text="판매유형" Top="5" Width="192"></Image>
					<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="204" LeftMargin="15" Style="sty_img_tit" TabOrder="2" Text="유통망" Top="5" Width="192"></Image>
					<Image Align="Left" Height="25" Id="Image2" ImageID="bul_tit" Left="5" LeftMargin="15" Style="sty_img_tit" TabOrder="1" Text="영업망" Top="5" Width="192"></Image>
				</TabPage>
				<TabPage BorderColor="black" Height="352" Id="tab_payInfo" ImageID="tab_blue" Left="2" TabOrder="1" Text="지급정보" Top="27" Width="816">
					<Image Align="Left" Height="25" Id="Image2" ImageID="bul_tit" Left="5" LeftMargin="15" Style="sty_img_tit" TabOrder="1" Text="장려금에&#32;사용된&#32;부가상품" Top="5" Width="192"></Image>
					<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="4" LeftMargin="15" Style="sty_img_tit" TabOrder="2" Text="지급조건" Top="253" Width="192"></Image>
					<Div Border="Raised" Height="74" Id="div_payCon" Left="4" Style="sty_div_input" TabOrder="3" Text="Div0" Top="274" Width="810">
						<Contents>
							<Static Align="Right" Height="20" Id="Static2" Left="308" Style="sty_lb_Basic" TabOrder="2" Text="수수료" Top="13" VAlign="Middle" Width="60"></Static>
							<Edit Align="RIGHT" BindDataset="ds_suplSvcCmms" Border="Flat" Column="CMMS" Height="20" Id="edt_cmms" Left="373" LeftMargin="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="1" Top="15" Width="100"></Edit>
							<Static Align="Right" Height="20" Id="Static5" Left="37" Style="sty_lb_Basic" TabOrder="3" Text="지급조건" Top="39" VAlign="Middle" Width="60"></Static>
							<Radio BindDataset="ds_suplSvcCmms" Border="None" CodeColumn="COMM_CD_VAL" Column="PAY_COND_CD" ColumnCount="3" DataColumn="COMM_CD_VAL_NM" Height="22" Id="rdo_PayCondCd" INDEX="-1" InnerDataset="ds_PayCondCd" Left="99" LeftMargin="5" OnClick="tab_suplSvcCmms_tab_payInfo_div_payCon_rdo_PayCondCd_OnClick" RightMargin="14" Style="sty_opt_input" TabOrder="4" Top="38" Width="140"></Radio>
							<Image Height="21" Id="Image3" ImageID="bul_mand" Left="32" TabOrder="5" Top="38" Transparent="TRUE" Width="20"></Image>
							<Image Height="21" Id="Image0" ImageID="bul_mand" Left="317" TabOrder="6" Top="14" Transparent="TRUE" Width="20"></Image>
							<Image Height="21" Id="Image1" ImageID="bul_mand" Left="32" TabOrder="9" Top="13" Transparent="TRUE" Width="20"></Image>
							<Static Align="Right" Height="20" Id="Static0" Left="37" Style="sty_lb_Basic" TabOrder="7" Text="연산조건" Top="13" VAlign="Middle" Width="60"></Static>
							<Radio BindDataset="ds_suplSvcCmms" Border="None" CodeColumn="COMM_CD_VAL" Column="OPR_MTHD_CD" ColumnCount="2" DataColumn="COMM_CD_VAL_NM" Height="22" Id="rdo_oprMthdcd" INDEX="-1" InnerDataset="ds_oprMthdcd" Left="99" LeftMargin="5" RightMargin="22" Style="sty_opt_input" TabOrder="8" Top="10" Width="121"></Radio>
							<Edit Align="RIGHT" BindDataset="ds_suplSvcCmms" Border="Flat" Column="CMMS_M" Height="20" Id="Edit0" Left="373" LeftMargin="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="10" Top="39" Width="100"></Edit>
							<Static Align="Right" Height="20" Id="Static1" Left="308" Style="sty_lb_Basic" TabOrder="11" Text="수수료" Top="39" VAlign="Middle" Width="60"></Static>
							<Image Height="21" Id="Image2" ImageID="bul_mand" Left="317" TabOrder="12" Top="38" Transparent="TRUE" Width="20"></Image>
							<Static Align="Right" Height="20" Id="StaticP" Left="473" Style="sty_lb_Basic" TabOrder="13" Text="(P수수료)" Top="15" VAlign="Middle" Width="63"></Static>
							<Static Align="Right" Height="20" Id="StaticM" Left="476" Style="sty_lb_Basic" TabOrder="14" Text="(M수수료)" Top="39" VAlign="Middle" Width="63"></Static>
							<Image Height="21" Id="Image4" ImageID="bul_mand" Left="589" TabOrder="17" Top="14" Transparent="TRUE" Width="20"></Image>
							<Static Align="Right" Height="20" Id="Static3" Left="598" Style="sty_lb_Basic" TabOrder="16" Text="유치율" Top="13" VAlign="Middle" Width="42"></Static>
							<Edit Align="RIGHT" BindDataset="ds_suplSvcCmms" Border="Flat" Column="JOIN_RT" Height="20" Id="edi_joinRt" Left="645" LeftMargin="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="15" Top="15" Width="100"></Edit>
							<Static Align="Center" Height="20" Id="Static4" Left="743" Style="sty_lb_Basic" TabOrder="18" Text="%" Top="15" VAlign="Middle" Width="20"></Static>
						</Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_payInfo" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="243" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="213" Id="grd_payInfo" InputPanel="FALSE" Left="462" LineColor="user33" MinWidth="100" MultiSelect="TRUE" OnHeadClick="tab_suplSvcCmms_tab_payInfo_grd_payInfo_OnHeadClick" OnMouseOver="tab_suplSvcCmms_tab_payInfo_grd_payInfo_OnMouseOver" Right="812" RowHeight="21" Style="sty_Grid" TabOrder="4" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="350">
						<contents>
							<format id="Default">
								<columns>
									<col width="25"/>
									<col width="70"/>
									<col width="100"/>
									<col width="60"/>
									<col width="70"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="상품구분"/>
									<cell bkcolor="user34" col="2" color="user35" display="text" text="부가상품명"/>
									<cell bkcolor="user34" col="3" color="user35" display="text" text="유치"/>
									<cell bkcolor="user34" col="4" color="user35" display="text" text="유지"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="SUPL_SVC_CL" combocol="COMM_CD_VAL" combodataset="ds_suplSvcCd" combotext="COMM_CD_VAL_NM" display="combo"/>
									<cell col="2" colid="SUPL_SVC_NM" display="text"/>
									<cell col="3" colid="IDM_LMT_CD" combocol="COMM_CD_VAL" combodataset="ds_idmLmtCd" combotext="COMM_CD_VAL_NM" display="combo" edit="combo" expandimage="btn_combo" expandshow="true" expandsize="19"/>
									<cell col="4" colid="ENDS_PRD_CD" combocol="COMM_CD_VAL" combodataset="ds_endsPrdCd" combotext="COMM_CD_VAL_NM" display="combo" edit="combo" expandimage="btn_combo" expandshow="true" expandsize="19"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Div Border="Raised" Height="40" Id="div_process" Left="5" Style="sty_div_input" TabOrder="8" Text="질의내용" Top="30" Width="416">
						<Contents>
							<Combo BindDataset="ds_suplSvcCd" Border="Flat" CodeColumn="COMM_CD_VAL" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_suplSvcCd" ImeMode="none" Left="88" OnChanged="tab_suplSvcCmms_tab_payInfo_div_process_cmb_suplSvcCd_OnChanged" Style="sty_ipt_form" TabOrder="1" Top="6" Width="170"></Combo>
							<Static Align="Right" Height="20" Id="Static0" Left="-6" Style="sty_lb_Search" TabOrder="2" Text="부가상품구분" Top="7" VAlign="Middle" Width="90"></Static>
						</Contents>
					</Div>
					<Grid AutoFit="TRUE" BindDataset="ds_suplSvc" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="243" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="171" Id="grd_suplSvc" InputPanel="FALSE" Left="5" LineColor="user33" MinWidth="100" MultiSelect="TRUE" OnHeadClick="tab_suplSvcCmms_tab_payInfo_grd_suplSvc_OnHeadClick" OnMouseOver="tab_suplSvcCmms_tab_payInfo_grd_suplSvc_OnMouseOver" Right="421" RowHeight="21" Style="sty_Grid" TabOrder="5" TabStop="true" Top="72" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="416">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="60"/>
									<col width="120"/>
									<col width="50"/>
									<col width="70"/>
									<col width="60"/>
								</columns>
								<head>
									<cell bkcolor="user34" col="0" color="user35" display="checkbox"/>
									<cell bkcolor="user34" col="1" color="user35" display="text" text="상품구분"/>
									<cell bkcolor="user34" col="2" color="user35" display="text" text="부가상품명"/>
									<cell bkcolor="user34" col="3" color="user35" display="text" text="유치"/>
									<cell bkcolor="user34" col="4" color="user35" display="text" text="유지"/>
									<cell bkcolor="user34" col="5" color="user35" display="text" text="장려금"/>
								</head>
								<body>
									<cell align="center" col="0" colid="SELECTED" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="SUPL_SVC_CL" combocol="COMM_CD_VAL" combodataset="ds_suplSvcCd" combotext="COMM_CD_VAL_NM" display="combo"/>
									<cell col="2" colid="SUPL_SVC_NM" display="text"/>
									<cell col="3" colid="IDM_LMT_CD" combocol="COMM_CD_VAL" combodataset="ds_idmLmtCd" combotext="COMM_CD_VAL_NM" display="combo" expandimage="btn_combo" expandshow="true" expandsize="19"/>
									<cell col="4" colid="ENDS_PRD_CD" combocol="COMM_CD_VAL" combodataset="ds_endsPrdCd" combotext="COMM_CD_VAL_NM" display="combo" expandimage="btn_combo" expandshow="true" expandsize="19"/>
									<cell align="right" col="5" colid="PR_MNY" display="number" edit="integer"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button Cursor="HAND" Height="21" Id="btn_toPayInfo" ImageID="btn_i_right_b" Left="432" OnClick="tab_suplSvcCmms_tab_payInfo_btn_toPayInfo_OnClick" TabOrder="7" Text="Button1" Top="104" Width="19"></Button>
					<Button Cursor="HAND" Height="21" Id="btn_toSuplSvc" ImageID="btn_i_left_b" Left="432" OnClick="tab_suplSvcCmms_tab_payInfo_btn_toSuplSvc_OnClick" TabOrder="6" Text="Button1" Top="128" Width="19"></Button>
					<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="461" LeftMargin="15" Style="sty_img_tit" TabOrder="9" Text="지급정보" Top="5" Width="192"></Image>
				</TabPage>
			</Contents>
		</Tab>
		<Div Border="Raised" Height="71" Id="div_search" Left="10" Style="sty_div_input" TabOrder="1" Text="질의내용" Top="8" Width="810">
			<Contents>
				<MaskEdit BindDataset="ds_suplSvcCmms" Border="Flat" Column="ACC_SCHD_MTH" Height="20" Id="cal_accSchdMth" Left="318" LeftMargin="2" Mask="@@@@-@@" MaxLength="6" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="19" Top="39" Type="STRING" Width="80"></MaskEdit>
				<Static Align="Right" Height="20" Id="Static2" Left="421" Style="sty_lb_Basic" TabOrder="1" Text="정책명칭" Top="39" VAlign="Middle" Width="60"></Static>
				<Shape Bottom="33" Height="1" Id="Shape0" Left="-1" LineColor="user9" Right="829" TabOrder="2" Top="32" Width="830"></Shape>
				<Static Align="Right" Height="20" Id="Static5" Left="22" Style="sty_lb_Basic" TabOrder="3" Text="적용년월" Top="7" VAlign="Middle" Width="76"></Static>
				<Edit BindDataset="ds_suplSvcCmms" Border="Flat" CheckLength="Byte" Column="POL_NM" Height="20" Id="edt_polNm" ImeMode="native" Left="486" LeftMargin="2" MaxLength="50" RightMargin="2" Style="sty_ipt_form" TabOrder="4" Top="39" Width="312"></Edit>
				<MaskEdit BindDataset="ds_condition" Border="Flat" Column="POL_YM" Height="20" Id="cal_polYm" Left="102" LeftMargin="2" Mask="@@@@-@@" MaxLength="6" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="5" Top="7" Type="STRING" Width="129"></MaskEdit>
				<Button Cursor="HAND" Height="18" Id="btn_monthCalendar" ImageID="btn_i_calendar" Left="213" OnClick="btn_monthCalendar_OnClick" TabOrder="6" Text="Button3" Top="8" Width="17"></Button>
				<Image Height="21" Id="Image3" ImageID="bul_mand" Left="418" TabOrder="7" Top="38" Transparent="TRUE" Width="20"></Image>
				<Static Align="Right" Height="20" Id="Static3" Left="246" Style="sty_lb_Basic" TabOrder="8" Text="적용기간" Top="7" VAlign="Middle" Width="68"></Static>
				<Calendar BindDataset="ds_condition" Border="Flat" ButtonImageID="btn_i_calendar" Column="APLY_STA_DTM" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_aplyStaDtm" Left="318" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" OnChanged="div_search_cal_aplyStaDtm_OnChanged" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="9" TodayColor="user26" Top="7" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="113"></Calendar>
				<Edit Align="CENTER" BindDataset="ds_condition" Border="Flat" Column="HOUR" Font="굴림,-1" Height="20" Id="edt_hour" ImeMode="none" Left="432" MaxLength="2" Number="TRUE" OnChanged="div_search_edt_hour_OnChanged" Style="sty_ipt_search" TabOrder="12" Top="7" Width="27"></Edit>
				<Edit Align="CENTER" BindDataset="ds_condition" Border="Flat" Column="MIN" Font="굴림,-1" Height="20" Id="edt_min" ImeMode="none" Left="460" MaxLength="2" Number="TRUE" OnChanged="div_search_edt_min_OnChanged" Style="sty_ipt_search" TabOrder="13" Top="7" Width="27"></Edit>
				<Static Align="Center" Height="20" Id="Static4" Left="489" TabOrder="10" Text="~" Top="7" VAlign="Middle" Width="20"></Static>
				<Calendar BindDataset="ds_condition" Border="Flat" ButtonImageID="btn_i_calendar" Column="APLY_END_DTM" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_aplyEndDtm" Left="510" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" OnChanged="div_search_cal_aplyEndDtm_OnChanged" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="11" TodayColor="user26" Top="7" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="113"></Calendar>
				<Edit Align="CENTER" BindDataset="ds_condition" Border="Flat" Column="END_HOUR" Font="굴림,-1" Height="20" Id="edt_endHour" ImeMode="none" Left="624" MaxLength="2" Number="TRUE" OnChanged="div_search_edt_endHour_OnChanged" Style="sty_ipt_search" TabOrder="14" Top="7" Width="27"></Edit>
				<Edit Align="CENTER" BindDataset="ds_condition" Border="Flat" Column="END_MIN" Font="굴림,-1" Height="20" Id="edt_endMin" ImeMode="none" Left="652" MaxLength="2" Number="TRUE" OnChanged="div_search_edt_endMin_OnChanged" Style="sty_ipt_search" TabOrder="15" Top="7" Width="27"></Edit>
				<Button Align="Left" ButtonStyle="TRUE" Height="21" Id="btn_search" ImageID="btn_a_6" Left="689" LeftMargin="5" OnClick="df_searchSet" Style="sty_btn_a" TabOrder="16" Text="대상모델소급" Top="6" Width="110"></Button>
				<Static Align="Right" Height="20" Id="Static0" Left="238" Style="sty_lb_Basic" TabOrder="17" Text="정산예정월" Top="39" VAlign="Middle" Width="76"></Static>
				<Button Cursor="HAND" Height="18" Id="btn_accCalendar" ImageID="btn_i_calendar" Left="381" OnClick="btn_monthCalendar_OnClick" TabOrder="18" Text="Button3" Top="40" Width="17"></Button>
				<Static Align="Right" Height="20" Id="Static7" Left="22" Style="sty_lb_Basic" TabOrder="20" Text="적용구분" Top="39" VAlign="Middle" Width="76"></Static>
				<Radio BindDataset="ds_suplSvcCmms" Border="None" CodeColumn="CODE" Column="BAK_APLY_YN" ColumnCount="2" DataColumn="NAME" Height="20" Id="rdo_bakAply" INDEX="-1" InnerDataset="ds_bakAplyYn" Left="102" LeftMargin="5" OnClick="div_search_rdo_bakAply_OnClick" RightMargin="5" Style="sty_opt_input" TabOrder="21" Top="39" Value="Y" Width="129"></Radio>
			</Contents>
		</Div>
		<Div Border="Raised" Height="73" Id="div_dataview" Left="10" Style="sty_div_input" TabOrder="3" Text="Div0" Top="482" Width="810">
			<Contents>
				<TextArea BindDataset="ds_suplSvcCmms" Border="Flat" CheckLength="Byte" Column="RMKS" Height="53" Id="txt_rmks" Left="88" MaxLength="200" Style="sty_ipt_form" TabOrder="1" Top="7" VScroll="TRUE" Width="709"></TextArea>
				<Static Align="Right" Height="20" Id="Static8" Left="24" Style="sty_lb_Basic" TabOrder="2" Text="비고" Top="7" VAlign="Middle" Width="60"></Static>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_delete" ImageID="btn_d_2" Left="761" LeftMargin="5" OnClick="df_delete" Style="sty_btn_d" TabOrder="5" Text="삭제" Top="565" Visible="FALSE" Width="60"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_save" ImageID="btn_c_2" Left="696" LeftMargin="5" OnClick="df_save" Style="sty_btn_c" TabOrder="4" Text="저장" Top="565" Visible="FALSE" Width="60"></Button>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID : POLASP00400 
* 업무명      : 도매가격표정책관리
* 프로그램명  : 부가상품수수료 등록
--------------------------------------------------------------------------------
* 작성자      : 장화수
* 작성일      : 2009.01.14
--------------------------------------------------------------------------------
* 1. 변경이력 
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

/*******************************************************************************
// 1. 전 처리기
*******************************************************************************/
#include "lib::lib_commF.js"
#include "lib::lib_util.js"

/*******************************************************************************
// 2. 폼 변수 정의
*******************************************************************************/
var FV_STR_NAME; // 사용자 이름
var PRE_FIX_STRD_SALE_PRC = 0;
var PRE_APLY_STA_DTM = ""; 
var PRE_APLY_END_DTM = "";
var	MOD_YMD = "";
var	MOD_YMD_END = "";
var POSAGENCYID = "";
var FV_ORG_ID;	//조직코드
var TM_ORG_ID;	//조직코드
var	CHK_ORG = "";  //조직정보 체크유무

/*******************************************************************************
* 함수명 : POLASP00400_OnLoadCompleted
* 기능명 : OnLoadCompleted 이벤트
*******************************************************************************/
function POLASP00400_OnLoadCompleted(obj)
{	
    ds_condition.SetColumn(0,"TCNT",1);
	// 권한 설정
	cf_setAuth(pFrmNum);
	
	POSAGENCYID = gds_session.GetColumn(0, "posAgencyId");

    http.Sync = true;
	f_setCmCode();

	df_search();
    CHK_ORG = "";
	http.Sync = false;
}

/*******************************************************************************
* 함수명 : df_reSet
* 기능명 : 화면 초기화
*******************************************************************************/
function df_reSet(sArg)
{
    ds_condition.SetColumn(0,"TCNT",1);
	// 권한 설정
	cf_setAuth(pFrmNum);
	
    http.Sync = true;
	df_search(sArg);
    CHK_ORG = "";
	http.Sync = false;
}


function f_setCmCode()
{
	// 공통 코드를 위한 데이타셋 설정
	cf_setCommonCodeDsEnv();
	//cf_setCommonCode("div_search.cmb_polOper", "ZPOL_C_00290");   //정책운영
	//cf_setCommonCode("ds_polSubj", "ZPOL_C_00300");   //정책주관
	//ds_mfact.SetColumn(0,"COMM_CD_VAL","선택");  //정책주관
	//ds_mfact.SetColumn(0,"COMM_CD_VAL_NM","");
	cf_setCommonCode("ds_prodChrtic1", "ZBAS_C_00020");   //상품특성1
	cf_setCommonCode("ds_prodChrtic2", "ZBAS_C_00030");   //상품특성2
	
	cf_setCommonCode("tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1", "ZBAS_C_00020", "전체");  //상품특성1
	cf_setCommonCode("tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic2", "ZBAS_C_00030", "전체");  //상품특성2
	cf_setCommonCode("ds_saleTypCdMax", "ZPOL_C_00020");  //판매유형코드 대
	cf_setCommonCode("ds_saleTypCdMid", "ZPOL_C_00030");  //판매유형코드 중
	cf_setCommonCode("ds_saleTypCdMin", "ZPOL_C_00040");  //판매유형코드 소
	cf_setCommonCode("ds_PayCondCd", "ZPOL_C_00220");  //지급조건
	cf_setCommonCode("ds_oprMthdCd", "ZPOL_C_00530");  //연산방법
	cf_setCommonCode("ds_agrmtPrd", "ZPOL_C_00230");  //약정기간코드	
	ds_mfact.SetColumn(0,"DEAL_CO_NM","전체");  //제조사
	ds_mfact.SetColumn(0,"DEAL_CO_CD","");

	cf_setCommonCode("ds_suplSvcCd", "ZBAS_C_00320");  //상품구분코드	
	cf_setCommonCode("tab_suplSvcCmms.tab_payInfo.div_process.cmb_suplSvcCd", "ZBAS_C_00320", "전체");  //상품구분코드
	cf_setCommonCode("ds_idmLmtCd", "ZBAS_C_00330");  //유치기한코드	
	cf_setCommonCode("ds_endsPrdCd", "ZBAS_C_00340");  //유지기한코드	
	cf_setCommonCode("tab_suplSvcCmms.tab_orgInfo.div_process.cmb_saleGrp", "ZBAS_C_00130", "전체"); // 영업 그룹

	
	
	// 설정된 코드를 기반으로 공통 코드를 추가 및 데이타 바인딩
	cf_checkCommonCode();
}

function f_setBakPayInfo()
{
}

function f_setCode()
{
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_mfact.index = 0;   //제조사
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.index = 0;  //상품특성1
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic2.index = 0;  //상품특성2
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_sktOperYn.index = 0;   //SK운영
	//tab_suplSvcCmms.tab_prodInfo.div_process.rdo_mdlAdpt.index = 0;     //전모델적용

	
	var chkYn = true;
	
	if(uf_isNull(ds_condition.GetColumn(0,"SPOL_ID"))== false) {   //리스트 클릭시 수정모드
		ds_condition.SetColumn(0,"POL_YM",ds_suplSvcCmms.GetColumn(0,"POL_YM"));  //적용년월
		//div_search.cmb_year.Value = substr(ds_suplSvcCmms.GetColumn(0,"POL_YM"),0,4);  //적용년
		//div_search.cmb_month.Value = substr(ds_suplSvcCmms.GetColumn(0,"POL_YM"),4,2);  //적용월

		if(uf_isNull(PRE_APLY_STA_DTM)== true && uf_isNull(MOD_YMD)== true) {   //적용시작일시를 안바꿨을때..
			ds_condition.SetColumn(0,"APLY_STA_DTM",substr(ds_suplSvcCmms.GetColumn(0,"APLY_STA_DTM"),0,8));  //적용시작년월일
			ds_condition.SetColumn(0,"HOUR",substr(ds_suplSvcCmms.GetColumn(0,"APLY_STA_DTM"),8,2));  //적용시작시
			ds_condition.SetColumn(0,"MIN",substr(ds_suplSvcCmms.GetColumn(0,"APLY_STA_DTM"),10,2));  //적용시작분
			
			ds_condition.SetColumn(0,"APLY_END_DTM",substr(ds_suplSvcCmms.GetColumn(0,"APLY_END_DTM"),0,8));  //적용종료년월일
			ds_condition.SetColumn(0,"END_HOUR",substr(ds_suplSvcCmms.GetColumn(0,"APLY_END_DTM"),8,2));  //적용종료시
			ds_condition.SetColumn(0,"END_MIN",substr(ds_suplSvcCmms.GetColumn(0,"APLY_END_DTM"),10,2));  //적용종료분
						
			//초기 적용시작일시
			PRE_APLY_STA_DTM = div_search.cal_aplyStaDtm.Value+Right("0"+div_search.edt_hour.Text,2)+Right("0"+div_search.edt_min.Text,2);
			//초기 적용종료일시
			PRE_APLY_END_DTM = div_search.cal_aplyEndDtm.Value+Right("0"+div_search.edt_Endhour.Text,2)+Right("0"+div_search.edt_EndMin.Text,2);
		} else {
			ds_condition.SetColumn(0,"APLY_STA_DTM",substr(MOD_YMD,0,8));  //적용시작년월일
			ds_condition.SetColumn(0,"HOUR",substr(MOD_YMD,8,2));  //적용시작시
			ds_condition.SetColumn(0,"MIN",substr(MOD_YMD,10,2));  //적용시작분
			
			ds_condition.SetColumn(0,"APLY_END_DTM",substr(MOD_YMD_END,0,8));  //적용종료년월일
			ds_condition.SetColumn(0,"END_HOUR",substr(MOD_YMD_END,8,2));  //적용종료시
			ds_condition.SetColumn(0,"END_MIN",substr(MOD_YMD_END,10,2));  //적용종료분
			
			//alert(ds_gnrlPrMny.GetColumn(0,"APLY_STA_DTM"));
			PRE_APLY_STA_DTM = ds_suplSvcCmms.GetColumn(0,"APLY_STA_DTM");
			PRE_APLY_END_DTM = ds_suplSvcCmms.GetColumn(0,"APLY_END_DTM");
			MOD_YMD = "";
			MOD_YMD_END = "";
		}


		//var chkYn = true;
		if ( ds_condition.getColumn(0,"LAST_YN") == "N" ) {  //해당 정책건에 대한 최종이력이 아니면...
			 chkYn = false;
		} else {
			 chkYn = true;
		}



				
		div_search.cal_polYm.Enable = false;  //적용년월 수정불가 여부
		//div_search.cmb_month.Enable = chkYn;  //적용월 수정불가 여부

		div_search.rdo_bakAply.Enable = chkYn;  //적용구분 수정불가 여부
	    div_search.cal_accSchdMth.Enable = chkYn;
	    div_search.btn_accCalendar.Enable = chkYn;
		
		div_search.cal_aplyStaDtm.Enable = chkYn;  //적용시작년월 수정불가 여부
		div_search.edt_hour.Enable = chkYn;  //적용시작시 수정불가 여부
		div_search.edt_min.Enable = chkYn;  //적용시작분 수정불가 여부
		
		div_search.cal_aplyEndDtm.Enable = chkYn;  //적용종료년월 수정불가 여부
		div_search.edt_endHour.Enable = chkYn;  //적용종료시 수정불가 여부
		div_search.edt_endMin.Enable = chkYn;  //적용종료분 수정불가 여부

		div_search.edt_polNm.Enable = true;  //정책명칭 수정불가 여부
		
		//btn_delete.Enable = true;  //삭제 불가 여부

		//div_search.cmb_spolSuplMgmt.Enable = false;

/**	
//사용자 요구로 권한 해제함.
if(uf_isNull(ds_suplSvcCmms.getColumn(0,"SPOL_ID"))== true) {
            btn_save.Visible   = true;
            btn_delete.Visible = true;
} else {
	    //저장, 삭제 버튼을 로그인한 사용자와 작성한자의 조직이 틀리면... 
        if( ds_suplSvcCmms.getColumn(0,"MOD_DVS") != gds_session.GetColumn(0, "orgid") ) { 
            btn_save.Visible   = false;
            btn_delete.Visible = false;
        }
}	
**/	
	} else {   //신규 등록 모드

		ds_suplSvcCmms.AddRow(0);
		//ds_suplSvcCmms.AddRow(0);
		//ds_suplSvcCmms.DeleteRow(nRow);
		
        
		if(uf_isNull(PRE_APLY_STA_DTM)== true && uf_isNull(MOD_YMD)== true) {   //적용시작일시를 안바꿨을때..
			ds_condition.SetColumn(0,"APLY_STA_DTM",ds_condition.GetColumn(0,"POL_YM")+"01");  //적용시작년월일
			ds_condition.SetColumn(0,"HOUR","00");  //적용시작시
			ds_condition.SetColumn(0,"MIN","00");  //적용시작분
			
			var lastDay = uf_MonthLastDay(ds_condition.GetColumn(0,"POL_YM")+"01");
			ds_condition.SetColumn(0,"APLY_END_DTM",ds_condition.GetColumn(0,"POL_YM")+lastDay);  //적용종료년월일
			ds_condition.SetColumn(0,"END_HOUR","23");  //적용종료시
			ds_condition.SetColumn(0,"END_MIN","59");  //적용종료분
		} else {
			ds_condition.SetColumn(0,"APLY_STA_DTM",substr(MOD_YMD,0,8));  //적용시작년월일
			ds_condition.SetColumn(0,"HOUR",substr(MOD_YMD,8,2));  //적용시작시
			ds_condition.SetColumn(0,"MIN",substr(MOD_YMD,10,2));  //적용시작분
			
			ds_condition.SetColumn(0,"APLY_END_DTM",substr(MOD_YMD_END,0,8));  //적용종료년월일
			ds_condition.SetColumn(0,"END_HOUR",substr(MOD_YMD_END,8,2));  //적용종료시
			ds_condition.SetColumn(0,"END_MIN",substr(MOD_YMD_END,10,2));  //적용종료분
			
			//alert(ds_gnrlPrMny.GetColumn(0,"APLY_STA_DTM"));
			MOD_YMD = "";
			MOD_YMD_END = "";
		}


		//alert(ds_condition.GetColumn(0,"POL_YM"));
		//ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",substr(AddMonth(ds_condition.GetColumn(0,"POL_YM")+"01"),0,6));
		//div_search.cmb_accSchdYear.Value = substr(cal_accSchdMth,0,4);  //정산예정년
		//div_search.cmb_accSchdMonth = substr(cal_accSchdMth,4,2);  //정산예정월
				
		//초기 적용시작일시
		PRE_APLY_STA_DTM = "";	
        //초기 적용종료일시
		PRE_APLY_END_DTM = "";


        //div_search.cmb_polOper.Index = 0;    //정책운영
		//div_search.rdo_vatAply.Value =  "Y";   //부가세포함여부
		//div_search.rdo_plstAply.Value =  "Y";   //가격표반영여부
		tab_suplSvcCmms.tab_prodInfo.div_process.rdo_mdlAdpt.Value =  "N";  //전모델적용여부

	
		var chkYn = true;

		div_search.cal_polYm.Enable = false;  //적용년월 수정불가 여부
		//div_search.cmb_month.Enable = chkYn;  //적용월 수정불가 여부
		
		div_search.rdo_bakAply.Enable = true;  //적용구분 수정불가 여부
	    div_search.cal_accSchdMth.Enable = true;
	    div_search.btn_accCalendar.Enable = true;
		
		div_search.cal_aplyStaDtm.Enable = true;  //적용시작년월 수정불가 여부
		div_search.edt_hour.Enable = true;  //적용시작시 수정불가 여부
		div_search.edt_min.Enable = true;  //적용시작분 수정불가 여부
		
		div_search.cal_aplyEndDtm.Enable = true;  //적용종료년월 수정불가 여부
		div_search.edt_endHour.Enable = true;  //적용종료시 수정불가 여부
		div_search.edt_endMin.Enable = true;  //적용종료분 수정불가 여부
		
		div_search.edt_polNm.Enable = true;  //정책명칭 수정불가 여부

		//btn_delete.Enable = false;  //삭제 불가 여부
	
	    //div_search.cmb_spolSuplMgmt.Enable = chkYn;
	    //alert(chkYn);
	    //ds_suplSvcCmms.SetColumn(0,"POL_NM"," ");

	}
		

    //선지급 후지급 세팅
    //신규등록이나 이력없이 1차만 있을때 수정모드
    if (uf_isNull(ds_suplSvcCmms.GetColumn(0,"ACC_SCHD_MTH"))== true) {
		ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",ds_condition.GetColumn(0,"POL_YM"));
    }
    if (ds_condition.GetColumn(0,"POL_YM") == ds_suplSvcCmms.GetColumn(0,"ACC_SCHD_MTH")) {
			div_search.rdo_bakAply.Enable = chkYn;  //적용구분 수정불가 여부
			div_search.cal_accSchdMth.Enable = false;
			div_search.btn_accCalendar.Enable = false;
		   //ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",ds_condition.GetColumn(0,"POL_YM"));
		    ds_suplSvcCmms.SetColumn(0,"BAK_APLY_YN","N");
    } else {
			div_search.rdo_bakAply.Enable = chkYn;  //적용구분 수정불가 여부
			div_search.cal_accSchdMth.Enable = chkYn;
			div_search.btn_accCalendar.Enable = chkYn;
			ds_suplSvcCmms.SetColumn(0,"BAK_APLY_YN","Y");
    }
    if (ds_suplSvcCmms.GetColumn(0,"POL_TS") != "1") {
			div_search.rdo_bakAply.Enable = false;  //적용구분 수정불가 여부
			div_search.cal_accSchdMth.Enable = false;
			div_search.btn_accCalendar.Enable = false;
    }
	if(uf_isNull(ds_condition.GetColumn(0,"SPOL_ID"))== true) {   //신규등록시
			div_search.rdo_bakAply.Enable = chkYn;  //적용구분 수정불가 여부
			div_search.cal_accSchdMth.Enable = false;
			div_search.btn_accCalendar.Enable = false;
	}
    //선지급 후지급 세팅 끝
	
	
	//trace(ds_suplSvcCmms.SaveXML());
	//trace(tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.DataColumn);
	//trace(tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.DataColumn);
	div_search.btn_monthCalendar.Enable = false;  //적용년월 달력 팜업
				
	//조직정보 전체 체크되고 수정불가
	//tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.Enable = false;	
		
    //상품정보 전모델적용 수정불가
	tab_suplSvcCmms.tab_prodInfo.div_process.rdo_mdlAdpt.Enable = false;
    //상품정보 제조사 선택불가
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_mfact.Enable = true;
    //상품정보 상품특성1 선택불가
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.Enable = true;
    //상품정보 상품특성2 선택불가
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic2.Enable = true;
    //상품정보 SKT운영 선택불가
	tab_suplSvcCmms.tab_prodInfo.div_process.cmb_sktOperYn.Enable = true;

    //상품정보 대상모델 수정불가
	tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Enable = true;
    //상품정보 적용모델 수정불가
	tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Enable = true;
    //상품정보 적용모델로 이동버튼 클릭불가
	tab_suplSvcCmms.tab_prodInfo.btn_toAplyModel.Enable = true;
    //상품정보 대상모델로 이동버튼 클릭불가
	tab_suplSvcCmms.tab_prodInfo.btn_toObjtModel.Enable = true;

    //영업정보 영업망 선택불가
	tab_suplSvcCmms.tab_saleInfo.grd_slNet.Enable = true;
    //영업정보 유통망 선택불가
	tab_suplSvcCmms.tab_saleInfo.grd_dsNet.Enable = true;
    //영업정보 판매유형 선택불가
	tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.Enable = true;


    //지급정보 선택불가
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.Enable = true;
    //지급정보 지급조건 선택여부
	tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Enable = true;
    //지급정보 수수료 수정여부
	tab_suplSvcCmms.tab_payInfo.div_payCon.edt_cmms.Enable = true;
	//tab_suplSvcCmms.tab_payInfo.div_dataview1.txt_rmks.Enable = false;
	

	
	
	//btn_save.Enable = true;  //저장 불가 여부
	btn_delete.Enable = chkYn;  //삭제 불가 여부
	
	div_search.rdo_bakAply.Enable = false;   //선지급여부

	    if (cf_idAuthSet(gds_session.GetColumn(0, "loginId")) == "OK") {
            btn_save.Visible   = true;
            btn_delete.Visible   = true;
	    }

	
}




/*******************************************************************************
* 함수명 : ds_orgInfo_OnColumnChanged
* 기능명 : 조직정보
*******************************************************************************/

function f_orgInfo()
{
	
	tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.Redraw = false;
	ds_orgInfo.FireEvent = false;
	
	//대중소 체크박스 초기화
	f_oLmsInit(ds_orgInfo,"ORG_ID_1","ORG_ID_2","ORG_ID_3","ORG_ID_4");
	
	
	tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.Redraw = true;
	ds_orgInfo.FireEvent = true;	
	
	
}


function ds_orgInfo_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
   //-----------------------------------------------------
   FV_ORG_ID = gds_session.GetColumn(0,"orgId");
   TM_ORG_ID = ds_orgInfo.GetColumn(nRow,"ORG_ID_3");

   if ( CHK_ORG != "ORG|"+nRow+"|"+strColumnID ) {
     	//대리점매핑
		FV_ORG_ID = cf_orgMapping(FV_ORG_ID,TM_ORG_ID);
		
		if ( FV_ORG_ID == "P10001" || FV_ORG_ID == "P00000" ) {
		} else {
			if ( FV_ORG_ID != TM_ORG_ID ) {
				alert("소속된 조직이 아닙니다.");
				CHK_ORG = "ORG|"+nRow+"|"+strColumnID;
				ds_orgInfo.SetColumn(nRow,strColumnID,varOldValue);
				return false;
			}
			if ( strColumnID == "SELECT1" ) {
				alert("소속된 조직이 아닙니다.");
				CHK_ORG = "ORG|"+nRow+"|"+strColumnID;
				ds_orgInfo.SetColumn(nRow,strColumnID,varOldValue);
				return false;
			}
		}
   } else {
		CHK_ORG = "";
   }
   //-----------------------------------------------------
	
	tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.Redraw = false;
	ds_orgInfo.FireEvent = false;
	//대중소 체크박스 클릭시 엑션
    f_oLmsOnClick(ds_orgInfo,"ORG_ID_1","ORG_ID_2","ORG_ID_3","ORG_ID_4",nRow,strColumnID,varOldValue,varNewValue);	
	
	ds_orgInfo.FireEvent = true;
	tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.Redraw = true;
}


/*-----------------------------------------------------------------------------------
 * Method : dvGrRate_grRate_OnHeadClick
 * Desc   : grid헤더 클릭시 모두체크
 *----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_orgInfo_grd_orgInfo_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0 || nCell==2 || nCell==4 || nCell==6)
	{
		FV_ORG_ID = gds_session.GetColumn(0,"orgId");
		if ( FV_ORG_ID == "P10001" ) {
		} else {
		   alert("소속된 조직이 아닙니다.");
		   return false;
		}
		
		f_gridcheckAll(obj,ds_orgInfo,nCell);  //전부 체크
	}
}



/*******************************************************************************
* 함수명 : f_saleTyp
* 기능명 : 영업정보
*******************************************************************************/


function f_saleTyp()
{
	
	tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.Redraw = false;
	ds_saleTyp.FireEvent = false;
	tab_suplSvcCmms.tab_saleInfo.grd_slNet.Redraw = false;
	ds_slNet.FireEvent = false;
	tab_suplSvcCmms.tab_saleInfo.grd_dsNet.Redraw = false;
	ds_dsNet.FireEvent = false;
	
	//대중소 체크박스 초기화
	f_oLmsInit(ds_saleTyp,"SALE_TYP_CD_1","SALE_TYP_CD_2","SALE_TYP_CD_3","");
	
	
	tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.Redraw = true;
	ds_saleTyp.FireEvent = true;	
	tab_suplSvcCmms.tab_saleInfo.grd_slNet.Redraw = true;
	ds_slNet.FireEvent = true;
	tab_suplSvcCmms.tab_saleInfo.grd_dsNet.Redraw = true;
	ds_dsNet.FireEvent = true;
	
		
}


function ds_saleTyp_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	
	tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.Redraw = false;
	ds_saleTyp.FireEvent = false;

	//대중소 체크박스 클릭시 엑션
    f_oLmsOnClick(ds_saleTyp,"SALE_TYP_CD_1","SALE_TYP_CD_2","SALE_TYP_CD_3","",nRow,strColumnID,varOldValue,varNewValue);	
	
	ds_saleTyp.FireEvent = true;
	tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.Redraw = true;
}


/*-----------------------------------------------------------------------------------
 * Method : tab_suplSvcCmms_tab_saleInfo_grd_saleTyp_OnHeadClick
 * Desc   : 판매유형 grid헤더 클릭시 모두체크
 *----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_saleInfo_grd_saleTyp_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0 || nCell==2 || nCell==4 || nCell==6)
	{
		if ( ds_condition.getColumn(0,"LAST_YN") == "Y" ) {  //해당 정책건에 대한 최종이력이면...
			f_gridcheckAll(obj,ds_saleTyp,nCell);  //전부 체크
		}
	}
}


/*-----------------------------------------------------------------------------------
 * Method : dvGrRate_grRate_OnHeadClick
 * Desc   : 영업망 grid헤더 클릭시 모두체크
 *----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_saleInfo_grd_slNet_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0)
	{
		if ( ds_condition.getColumn(0,"LAST_YN") == "Y" ) {  //해당 정책건에 대한 최종이력이면...
			f_gridcheckOneAll(obj,ds_slNet);  //전부 체크
		}
	}
}


/*-----------------------------------------------------------------------------------
 * Method : dvGrRate_grRate_OnHeadClick
 * Desc   : 유통망 grid헤더 클릭시 모두체크
 *----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_saleInfo_grd_dsNet_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0)
	{
		if ( ds_condition.getColumn(0,"LAST_YN") == "Y" ) {  //해당 정책건에 대한 최종이력이면...
			f_gridcheckOneAll(obj,ds_dsNet);  //전부 체크
		}
	}
}




/*******************************************************************************
* 함수명 : f_prodInfo
* 기능명 : 상품정보
*******************************************************************************/




/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_div_process_cmb_mfact_OnChanged
* 기능명 : 대상모델 조회(제조사 select박스 선택시)
*----------------------------------------------------------------------------------*/

function tab_suplSvcCmms_tab_prodInfo_div_process_cmb_mfact_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
		f_setObjModelFilter();			
}



/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_div_process_cmb_prodChrtic1_OnChanged
* 기능명 : 대상모델 조회(상품특성1 select박스 선택시)
*----------------------------------------------------------------------------------*/

function tab_suplSvcCmms_tab_prodInfo_div_process_cmb_prodChrtic1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
		f_setObjModelFilter();			
}



/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_div_process_cmb_prodChrtic2_OnChanged
* 기능명 : 대상모델 조회(상품특성2 select박스 선택시)
*----------------------------------------------------------------------------------*/

function tab_suplSvcCmms_tab_prodInfo_div_process_cmb_prodChrtic2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
		f_setObjModelFilter();		
}



/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_div_process_cmb_sktOperYn_OnChanged
* 기능명 : 대상모델 조회(SKT운영 select박스 선택시)
*----------------------------------------------------------------------------------*/

function tab_suplSvcCmms_tab_prodInfo_div_process_cmb_sktOperYn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{	
		f_setObjModelFilter();			
}


/*-----------------------------------------------------------------------------------
* 함수명 : f_setObjModelFilter
* 기능명 : 대상모델 조회
*----------------------------------------------------------------------------------*/
function f_setObjModelFilter()
{
        var strMfact       = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_mfact.value;
        var strProdChrtic1 = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.value;
        var strProdChrtic2 = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic2.value;
        var strSktOperYn   = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_sktOperYn.value;
		var sFilterDs      = "";

		//ds_objtModel.Unfilter();
		if(uf_isNull(strMfact) == false){
			sFilterDs += " DEAL_CO_CD='" + strMfact + "' &&";
		}
		if (uf_isNull(strProdChrtic1) == false) {
			sFilterDs += " PROD_CHRTIC_1_CD='" + strProdChrtic1 + "' &&";
		}
		if (uf_isNull(strProdChrtic2) == false) {
			sFilterDs += " PROD_CHRTIC_2_CD='" + strProdChrtic2 + "' &&";
		}
		if (uf_isNull(strSktOperYn) == false) {
			sFilterDs += " SKT_OPER_YN='" + strSktOperYn + "' &&";
		}
			//sFilterDs += " 1=1";
			//alert(SubStr(sFilterDs,0,Length(sFilterDs)-2));
		ds_objtModel.Filter(SubStr(sFilterDs,0,Length(sFilterDs)-2));
}


/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_grd_objtModel_OnHeadClick
* 기능명 : 대상모델 모두 선택
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_prodInfo_grd_objtModel_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(object(obj.bindDataset).getRowCount() > 0)
	{
		var sType = obj.GetCellProp("head", nCell, "display");
		if(sType == "checkbox")	
		{
			obj.Redraw = false;
			var oGrdDs = object(obj.bindDataSet);
			var nGrdDsRouCount = oGrdDs.RowCount();
			var sValue = '0';
			//그리드의 셀이 checkbox로 되어 있는 경우만.
			var sChkValue = obj.GetCellProp("head", nCell, "text");		
			
			if (sChkValue == 1) sValue='0';
			else sValue='1';
			
			obj.SetCellProp("head",nCell,"text",sValue);
	
			for (i=0; i<nGrdDsRouCount; i++)
			{
				oGrdDs.SetColumn(i, "SELECTED", sValue);
			}
			obj.Redraw = true;
		}
		else
		{
			cf_markGridSort(obj, nCell, nX, nY, nPivotIndex);
		}
	}
	
}

/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_grd_aplyModel_OnHeadClick
* 기능명 : 적용모델 모두 선택
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_prodInfo_grd_aplyModel_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(object(obj.bindDataset).getRowCount() > 0)
	{
		var sType = obj.GetCellProp("head", nCell, "display");
		if(sType == "checkbox")	
		{
			obj.Redraw = false;
			var oGrdDs = object(obj.bindDataSet);
			var nGrdDsRouCount = oGrdDs.RowCount();
			var sValue = '0';
			//그리드의 셀이 checkbox로 되어 있는 경우만.
			var sChkValue = obj.GetCellProp("head", nCell, "text");		
			
			if (sChkValue == 1) sValue='0';
			else sValue='1';
			
			obj.SetCellProp("head",nCell,"text",sValue);
	
			for (i=0; i<nGrdDsRouCount; i++)
			{
				oGrdDs.SetColumn(i, "SELECTED", sValue);
			}
			obj.Redraw = true;
		}
		else
		{
			cf_markGridSort(obj, nCell, nX, nY, nPivotIndex);
		}
	}
}


/*-----------------------------------------------------------------------------------
* 기능명 : 그리드에서 셀을 더블클릭했을때
function tab_suplSvcCmms_tab_prodInfo_grd_objtModel_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	for( var i=0; i<ds_objtModel.rowcount; i++ ){		
		if(ds_objtModel.GetColumn(i, "PROD_CD") == ds_aplyModel.GetColumn(nRow, "MDL_ID") ){
			return;
		}
    }
    
    f_moveShuttle(ds_objtModel, ds_aplyModel);    	
    ds_aplyModel.Sort("PROD_NM");  	
}

function tab_suplSvcCmms_tab_prodInfo_grd_aplyModel_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	for( var i=0; i<ds_aplyModel.rowcount; i++ ){		
		if(ds_aplyModel.GetColumn(i, "MDL_ID") == ds_objtModel.GetColumn(nRow, "PROD_CD") ){
			return;
		}
    }
    
    f_moveShuttle(ds_aplyModel, ds_objtModel);    	
    ds_objtModel.Sort("PROD_NM"); 
}
*----------------------------------------------------------------------------------*/





/*-----------------------------------------------------------------------------------
* 함수명 : f_moveShuttle
* 기능명 : ource Dataset에 있는 row를 Target Dataset으로 이동함
*----------------------------------------------------------------------------------*/

function f_moveShuttle(ds, dsTarget)
{
	dsTarget.addRow();
	ds.copyToRow(ds.row, dsTarget.id, dsTarget.row );	
	ds.DeleteRow(ds.row);
}

/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_btn_toAplyModel_OnClick
* 기능명 : 대상모델에서 적용모델로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_prodInfo_btn_toAplyModel_OnClick(obj)
{
	if(ds_objtModel.currow == -1 ){
	    //선택된 대상모델 없습니다.
		alert(cf_getMessage(MSG_00134, "대상모델"));
		return;
	}
	
	tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Redraw = false;
	tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Redraw  = false;

	var sHead = tab_suplSvcCmms.tab_prodInfo.grd_objtModel.GetCellProp("head",0,"text");
	var nTotCnt = ds_objtModel.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;

	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_objtModel.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_objtModel.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_objtModel.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_aplyModel.AddRow();
			ds_aplyModel.CopyRow(ds_aplyModel.lastrow,ds_objtModel,nRow);
			ds_aplyModel.SetColumn(ds_aplyModel.lastrow, "SELECTED", "0");
			ds_objtModel.DeleteRow(nRow);
	   }
	}

	//ds_aplyModel.Sort("PROD_NM");
	tab_suplSvcCmms.tab_prodInfo.grd_objtModel.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Redraw = true;
	tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Redraw  = true;
}

/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_prodInfo_btn_toObjtModel_OnClick
* 기능명 : 적용모델에서 대상모델로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_prodInfo_btn_toObjtModel_OnClick(obj)
{
	if(ds_aplyModel.currow == -1 ){
	    //선택된 적용모델 없습니다.
		alert(cf_getMessage(MSG_00134, "적용모델"));
		return;
	}

	tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Redraw = false;
	tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Redraw  = false;
	
	var sHead = tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.GetCellProp("head",0,"text");
	var nTotCnt = ds_aplyModel.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
	
	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_aplyModel.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_aplyModel.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_aplyModel.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_objtModel.AddRow();
			ds_objtModel.CopyRow(ds_objtModel.lastrow,ds_aplyModel,nRow);
			ds_objtModel.SetColumn(ds_objtModel.lastrow, "SELECTED", "0");
			ds_aplyModel.DeleteRow(nRow);
	   }
	}

	//ds_objtModel.Sort("PROD_NM");
	tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Redraw = true;
	tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Redraw  = true;
}



/*-----------------------------------------------------------------------------------
 * Method : tab_suplSvcCmms_tab_prodInfo_div_process_rdo_mdlAdpt_OnClick
 * Desc   :  전모델 적용
 *----------------------------------------------------------------------------------*/

function tab_suplSvcCmms_tab_prodInfo_div_process_rdo_mdlAdpt_OnClick(obj)
{
	//tab_suplSvcCmms.tab_prodInfo.div_process.rdo_mdlAdpt.Value
	//alert(obj.Value);
    if ( obj.Value == "Y") {
        tab_suplSvcCmms.tab_prodInfo.div_process.cmb_mfact.index = 0;  //제조사 전체로 세팅
        tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.index = 0;  //상품특성1 전체로 세팅
        tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic2.index = 0;  //상품특성2 전체로 세팅
        tab_suplSvcCmms.tab_prodInfo.div_process.cmb_sktOperYn.index = 0;  //SK운영여부 전체로 세팅

        var strMfact       = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_mfact.value;
        var strProdChrtic1 = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic1.value;
        var strProdChrtic2 = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_prodChrtic2.value;
        var strSktOperYn   = tab_suplSvcCmms.tab_prodInfo.div_process.cmb_sktOperYn.value;
		var sFilterDs      = "";

		//ds_objtModel.Unfilter();
		if(uf_isNull(strMfact)== false) {
			sFilterDs += " DEAL_CO_CD='" + strMfact + "' &&";
		}
		if (strProdChrtic1 != "") {
			sFilterDs += " PROD_CHRTIC_1_CD='" + strProdChrtic1 + "' &&";
		}
		if (strProdChrtic2 != "") {
			sFilterDs += " PROD_CHRTIC_2_CD='" + strProdChrtic2 + "' &&";
		}
		if (strSktOperYn != "") {
			sFilterDs += " SKT_OPER_YN='" + strSktOperYn + "' &&";
		}
			//sFilterDs += " 1=1";
			//alert(SubStr(sFilterDs,0,Length(sFilterDs)-2));
		ds_objtModel.Filter(SubStr(sFilterDs,0,Length(sFilterDs)-2));  //대상모델 전체 조회
    
		//f_gridcheckOneAll(obj,ds_objtModel);  //전부 체크
		
		//tab_suplSvcCmms_tab_prodInfo_btn_toAplyModel_OnClick();   //적용모델로 이동

    
		tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Redraw = false;
		tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Redraw  = false;
	
		//var sHead = tab_suplSvcCmms.tab_prodInfo.grd_objtModel.GetCellProp("head",0,"text");
		var nTotCnt = ds_objtModel.GetCount();

        if( nTotCnt > 0 ) {
			if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
		
			for(var nRow=nTotCnt; nRow>=0; nRow--){
					ds_aplyModel.AddRow();
					ds_aplyModel.CopyRow(ds_aplyModel.lastrow,ds_objtModel,nRow);
					ds_aplyModel.SetColumn(ds_aplyModel.lastrow, "SELECTED", "0");
					ds_objtModel.DeleteRow(nRow);
			}
		
			ds_aplyModel.Sort("PROD_NM");
			//tab_suplSvcCmms.tab_prodInfo.grd_objtModel.SetCellProp("head",0,"text","0");

        }
	
		tab_suplSvcCmms.tab_prodInfo.grd_objtModel.Redraw = true;
		tab_suplSvcCmms.tab_prodInfo.grd_aplyModel.Redraw  = true;
    
    
    
    }

}




/*******************************************************************************
* 함수명 : f_payInfo
* 기능명 : 지급정보
*******************************************************************************/


//지급정보 부가서비스 해드클릭
function tab_suplSvcCmms_tab_payInfo_grd_suplSvc_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0)
	{
		f_gridcheckOneAll(obj,ds_suplSvc);  //전부 체크
	}	
}




//지급정보 해드클릭
function tab_suplSvcCmms_tab_payInfo_grd_payInfo_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0)
	{
		f_gridcheckOneAll(obj,ds_payInfo);  //전부 체크
	}		
}


/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_payInfo_btn_toPayInfo_OnClick
* 기능명 : 부가서비스에서 지급정보로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_payInfo_btn_toPayInfo_OnClick(obj)
{
	if(ds_suplSvc.currow == -1 ){
	    //선택된 부가서비스가 없습니다.
		alert(cf_getMessage(MSG_00134, "부가서비스"));
		return;
	}
	
	tab_suplSvcCmms.tab_payInfo.grd_suplSvc.Redraw = false;
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.Redraw  = false;

	var sHead = tab_suplSvcCmms.tab_payInfo.grd_suplSvc.GetCellProp("head",0,"text");
	var nTotCnt = ds_suplSvc.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;

	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_suplSvc.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_suplSvc.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_suplSvc.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			//ds_payInfo.SetColumn(ds_payInfo.lastrow, "IDM_LMT_CD", "1");
			//ds_payInfo.SetColumn(ds_payInfo.lastrow, "ENDS_PRD_CD", "0");
			//ds_payInfo.SetColumn(ds_payInfo.lastrow, "PLST_APLY_YN", "N");
			ds_payInfo.SetColumn(ds_payInfo.lastrow, "SELECTED", "0");
			var nExistRow = 0;
			nExistRow = ds_payInfo.FindRow("SUPL_SVC_CD",ds_suplSvc.GetColumn(nRow,"SUPL_SVC_CD"));	
			//alert(ds_payInfo.GetCount()+"======"+nExistRow+"==="+ds_suplSvc.GetColumn(nRow,"SUPL_SVC_CD"));
			ds_payInfo.AddRow();
			ds_payInfo.CopyRow(ds_payInfo.lastrow,ds_suplSvc,nRow);
			if( nExistRow > -1 ){
				ds_payInfo.DeleteRow(ds_payInfo.lastrow);
			    alert(ds_suplSvc.GetColumn(nRow,"SUPL_SVC_NM") + "은 이미 선택한 부가상품입니다.("+nExistRow+")");
			    break;
			} else {
				ds_suplSvc.DeleteRow(nRow);
			}
	   }
	}



	ds_payInfo.Sort("SUPL_SVC_NM");
	tab_suplSvcCmms.tab_payInfo.grd_suplSvc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_payInfo.grd_suplSvc.Redraw = true;
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.Redraw  = true;
	
}



/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_payInfo_btn_toSuplSvc_OnClick
* 기능명 : 지급정보에서 부가서비스로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_payInfo_btn_toSuplSvc_OnClick(obj)
{
	if(ds_payInfo.currow == -1 ){
	    //선택된 적용모델 없습니다.
		alert(cf_getMessage(MSG_00134, "적용모델"));
		return;
	}

	tab_suplSvcCmms.tab_payInfo.grd_suplSvc.Redraw = false;
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.Redraw  = false;
	
	var sHead = tab_suplSvcCmms.tab_payInfo.grd_payInfo.GetCellProp("head",0,"text");
	var nTotCnt = ds_payInfo.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
	
	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_payInfo.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_payInfo.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_payInfo.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_suplSvc.AddRow();
			ds_suplSvc.CopyRow(ds_suplSvc.lastrow,ds_payInfo,nRow);
			//ds_suplSvc.SetColumn(ds_suplSvc.lastrow, "IDM_LMT_CD", "1");
			//ds_suplSvc.SetColumn(ds_suplSvc.lastrow, "ENDS_PRD_CD", "0");
			ds_suplSvc.SetColumn(ds_suplSvc.lastrow, "SELECTED", "0");
			ds_payInfo.DeleteRow(nRow);
	   }
	}

	ds_suplSvc.Sort("PROD_NM");
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_payInfo.grd_suplSvc.Redraw = true;
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.Redraw  = true;
	
}










/*******************************************************************************
* 함수명 : f_oLmsInit
* 기능명 : 조직정보, 영업정보 판매유형의  대중소 체크박스 만들기
*******************************************************************************/
function f_oLmsInit(OBJ,TARGET_1,TARGET_2,TARGET_3,TARGET_4)
{

    //체크박스 만들기
	for( var idx=0; idx<=OBJ.rowcount; idx++ ){
	
		if(idx == 0){
			OBJ.SetColumn(0,"LRGFLAG","Y");
			OBJ.SetColumn(0,"MDLFLAG","Y");
			OBJ.SetColumn(0,"SMLFLAG","Y");
			OBJ.SetColumn(0,"EMLFLAG","Y");
		}else{
			if(OBJ.GetColumn(idx,TARGET_1) == OBJ.GetColumn(idx-1,TARGET_1)){
				OBJ.SetColumn(idx,"LRGFLAG","N");
			}else{ 
				OBJ.SetColumn(idx,"LRGFLAG","Y");
			}
			
			if(OBJ.GetColumn(idx,TARGET_2) == OBJ.GetColumn(idx-1,TARGET_2)){
				OBJ.SetColumn(idx,"MDLFLAG","N");
			}else{
				OBJ.SetColumn(idx,"MDLFLAG","Y");
			}	
					
			if(OBJ.GetColumn(idx,TARGET_3) == OBJ.GetColumn(idx-1,TARGET_3)){
				OBJ.SetColumn(idx,"SMLFLAG","N");
			}else{
				OBJ.SetColumn(idx,"SMLFLAG","Y");
			}					
			if (OBJ==ds_orgInfo) {
				if(OBJ.GetColumn(idx,TARGET_4) == OBJ.GetColumn(idx-1,TARGET_4)){
					OBJ.SetColumn(idx,"EMLFLAG","N");
				}else{
					OBJ.SetColumn(idx,"EMLFLAG","Y");
				}					
			}
		}
	}
	
    //대,중 분류 체크박스에 체크하기
    f_oLmsInitChecked(OBJ,"SELECT1",TARGET_1);
    f_oLmsInitChecked(OBJ,"SELECT2",TARGET_2);
	if (OBJ==ds_orgInfo) {
		f_oLmsInitChecked(OBJ,"SELECT3",TARGET_3);
	}


}

/*******************************************************************************
* 함수명 : f_oLmsInitChecked
* 기능명 : 조직정보, 영업정보 판매유형의  대중소 체크박스에 DB에서 가져온 정보대로 체크하기
*******************************************************************************/
function f_oLmsInitChecked(OBJ,SELECT,TARGET)
{
	for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
		if(OBJ.GetColumn(idx,TARGET) != OBJ.GetColumn(idx+1,TARGET)){
			var iCnt = 0;
			var oCnt = idx;
			for( var id=idx ; id>=0; id-- ){
				if(OBJ.GetColumn(id,SELECT) == "1"){
					iCnt++;
				}
				if(OBJ.GetColumn(id,TARGET) != OBJ.GetColumn(id-1,TARGET)){
					oCnt = (oCnt - id)+1;
					break;
				}					
			}
			var selected = 0;
			if( iCnt == oCnt ) { selected = 1; }
			for( var id=idx ; id>=0; id-- ){
				OBJ.SetColumn(id,SELECT,selected);
				//if (OBJ==ds_saleTyp) {
				//  alert(iCnt+" : "+oCnt+" : "+selected);
				//}
				if(OBJ.GetColumn(id,TARGET) != OBJ.GetColumn(id-1,TARGET)){
					break;
				}
			}
		}					
	}
}

/*******************************************************************************
* 함수명 : f_oLmsOnClick
* 기능명 : 조직정보, 영업정보 판매유형의  대중소 체크박스 클릭시 엑션
*******************************************************************************/
function f_oLmsOnClick(OBJ,TARGET_1,TARGET_2,TARGET_3,TARGET_4,nRow,strColumnID,varOldValue,varNewValue)
{

	if(strColumnID == "SELECT1"){  //------------------------------------------
		for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
			if(OBJ.GetColumn(idx,TARGET_1) == OBJ.GetColumn(nRow,TARGET_1)){
				OBJ.SetColumn(idx,strColumnID,varNewValue);
				OBJ.SetColumn(idx,"SELECT2",varNewValue);
				OBJ.SetColumn(idx,"SELECT3",varNewValue);
				OBJ.SetColumn(idx,"SELECT4",varNewValue);
		    }
		}
	}else if(strColumnID == "SELECT2"){  //------------------------------------
		for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
			if(OBJ.GetColumn(idx,TARGET_2) == OBJ.GetColumn(nRow,TARGET_2)){
				if(OBJ.GetColumn(idx,"SELECT1") == 1){
					OBJ.SetColumn(idx,strColumnID,varOldValue);
					OBJ.SetColumn(idx,"SELECT3",varOldValue);
					OBJ.SetColumn(idx,"SELECT4",varOldValue);
				}else{
				    //alert("ccc: "+varNewValue);
					OBJ.SetColumn(idx,strColumnID,varNewValue);
					OBJ.SetColumn(idx,"SELECT3",varNewValue);				
					OBJ.SetColumn(idx,"SELECT4",varNewValue);				
				}
			}
			
			if (OBJ != ds_saleTyp) {  //'''''''''''''''''''''''''''
				if(idx =OBJ.lastrow){
					var inx = OBJ.SearchRow(TARGET_1 + "==" + quote(OBJ.GetColumn(nRow,TARGET_1)) +
										   " && SELECT2 !=" + quote("1"));
					
					if(inx == -1){
						for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
							if(OBJ.GetColumn(idx,TARGET_1) == OBJ.GetColumn(nRow,TARGET_1)){
								OBJ.SetColumn(idx,"SELECT1","1");
							}
						}
					}
											  
				}	
			}	//''''''''''''''''''''''''''''''''''''''''''''''''
			
		}
	}else if(strColumnID == "SELECT3"){  //-----------------------------------
		for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
			if(OBJ.GetColumn(idx,TARGET_3) == OBJ.GetColumn(nRow,TARGET_3)){
				if(OBJ.GetColumn(idx,"SELECT2") == 1){
					OBJ.SetColumn(idx,strColumnID,varOldValue);
					OBJ.SetColumn(idx,"SELECT4",varOldValue);
				}else{
				    //alert(OBJ.GetColumn(nRow,"SALE_TYP_CD_3")+": 소분류 체크: "+varNewValue);
					OBJ.SetColumn(idx,strColumnID,varNewValue);
					OBJ.SetColumn(idx,"SELECT4",varNewValue);				
				}
			}
			
			if (OBJ != ds_saleTyp) {  //'''''''''''''''''''''''''''
				if(idx =OBJ.lastrow){
					var idx = OBJ.SearchRow(TARGET_1 + "==" + quote(OBJ.GetColumn(nRow,TARGET_1)) +
								   " && " + TARGET_2 + "==" + quote(OBJ.GetColumn(nRow,TARGET_2)) +
										   " && SELECT3 !=" + quote("1"));
					if(idx == -1){
						for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
							if(OBJ.GetColumn(idx,TARGET_2) == OBJ.GetColumn(nRow,TARGET_2)){
								OBJ.SetColumn(idx,"SELECT2","1");  //체크
							}
						}
					}
					
					var inx = OBJ.SearchRow(TARGET_1 + "==" + quote(OBJ.GetColumn(nRow,TARGET_1)) +
										   " && SELECT2 !=" + quote("1"));
					
					if(inx == -1){
						for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
							if(OBJ.GetColumn(idx,TARGET_1) == OBJ.GetColumn(nRow,TARGET_1)){
								OBJ.SetColumn(idx,"SELECT1","1");   //체크
							}
						}
					}								  
				}	
			}	//'''''''''''''''''''''''''''''''''''''''''''''''
			
		}
		
	}else if(strColumnID == "SELECT4"){  //----------------------------------
		for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
			if(OBJ.GetColumn(idx,TARGET_4) == OBJ.GetColumn(nRow,TARGET_4)){
				if(OBJ.GetColumn(idx,"SELECT3") == 1){
					OBJ.SetColumn(idx,strColumnID,varOldValue);
				}else{
					OBJ.SetColumn(idx,strColumnID,varNewValue);
				}
			}
			
			if (OBJ != ds_saleTyp) {  //'''''''''''''''''''''''''''
				if(idx =OBJ.lastrow){
					var idx = OBJ.SearchRow(TARGET_1 + "==" + quote(OBJ.GetColumn(nRow,TARGET_1)) +
								   " && " + TARGET_2 + "==" + quote(OBJ.GetColumn(nRow,TARGET_2)) +
								   " && " + TARGET_3 + "==" + quote(OBJ.GetColumn(nRow,TARGET_3)) +
										   " && SELECT4 !=" + quote("1"));
					if(idx == -1){
						for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
							if(OBJ.GetColumn(idx,TARGET_3) == OBJ.GetColumn(nRow,TARGET_3)){
								OBJ.SetColumn(idx,"SELECT3","1");  //체크
							}
						}
					}
	
					
					var idx = OBJ.SearchRow(TARGET_1 + "==" + quote(OBJ.GetColumn(nRow,TARGET_1)) +
								   " && " + TARGET_2 + "==" + quote(OBJ.GetColumn(nRow,TARGET_2)) +
										   " && SELECT3 !=" + quote("1"));
					if(idx == -1){
						for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
							if(OBJ.GetColumn(idx,TARGET_2) == OBJ.GetColumn(nRow,TARGET_2)){
								OBJ.SetColumn(idx,"SELECT2","1");  //체크
							}
						}
					}
					
					var inx = OBJ.SearchRow(TARGET_1 + "==" + quote(OBJ.GetColumn(nRow,TARGET_1)) +
										   " && SELECT2 !=" + quote("1"));
					
					if(inx == -1){
						for( var idx =0 ; idx<=OBJ.RowCount(); idx++ ){
							if(OBJ.GetColumn(idx,TARGET_1) == OBJ.GetColumn(nRow,TARGET_1)){
								OBJ.SetColumn(idx,"SELECT1","1");   //체크
							}
						}
					}								  
				}	
			}	//'''''''''''''''''''''''''''''''''''''''''''''''''''
			
		}



	}  //----------------------------------------------------------------------

	if (OBJ==ds_orgInfo) {
		f_moveAplyToObjtSalePlc();  //조직정보 체크해제시 적용판매처에서 대상판매처로 이동
		f_setSalePlcFilter();  //대상판매처 필터(필더가 마지막 순서 중요)
	}


}

/*******************************************************************************
* 함수명 : f_GridCheckAll 
* 기능명 : Grid의 checkbox를 한꺼번에 check/uncheck하는 기능
* 파라미터
 * @param  : grid - Grid
 * @param  : ds - Dataset
 * @return : None
*******************************************************************************/
function f_gridCheckAll(grid,ds,nCell)
{
	// Check Box 전체 선택
	var nCount = ds.rowcount;
	if(nCell == 0 || nCell == 2 || nCell == 4 || nCell==6){
		if( grid.GetCellProp("head", nCell, "Text") == "1" ) {
			for ( var irow=0; irow < nCount; irow++ ) {
				ds.SetColumn(irow,"SELECT1","0");
				ds.SetColumn(irow,"SELECT2","0");
				ds.SetColumn(irow,"SELECT3","0");
				if(ds.ID == "ds_orgInfo") {
				ds.SetColumn(irow,"SELECT4","0");
				}
				grid.SetCellProp("head",0,"text","0");	
				grid.SetCellProp("head",2,"text","0");
				grid.SetCellProp("head",4,"text","0");
				if(ds.ID == "ds_orgInfo") {
				grid.SetCellProp("head",6,"text","0");
				}
			}
		} else {
			for ( var irow=0; irow < nCount; irow++ ){
				ds.SetColumn(irow,"SELECT1","1");
				ds.SetColumn(irow,"SELECT2","1");
				ds.SetColumn(irow,"SELECT3","1");
				if(ds.ID == "ds_orgInfo") {
				ds.SetColumn(irow,"SELECT4","1");
				}
				grid.SetCellProp("head",0,"text","1");	
				grid.SetCellProp("head",2,"text","1");
				grid.SetCellProp("head",4,"text","1");							
				if(ds.ID == "ds_orgInfo") {
				grid.SetCellProp("head",6,"text","1");							
				}
			}
			
		}
	}
}


function f_gridcheckOneAll(grid,ds)
{
	// Check Box 전체 선택
	var nCount = ds.rowcount;
	if( grid.GetCellProp("head", 0, "Text") == "1" ) {
		for ( var irow=0; irow < nCount; irow++ ) {
			ds.SetColumn(irow,"SELECTED","0");
			grid.SetCellProp("head",0,"text","0");				
		}
	} else {
		for ( var irow=0; irow < nCount; irow++ ){
			ds.SetColumn(irow,"SELECTED","1");
			grid.SetCellProp("head",0,"text","1");				
		}
	}
}




/*******************************************************************************
* 함수명 : f_callBack 
* 기능명 : 트랜잭션 콜백 
* 파라미터
1. sSvcID  : 서비스 아이디
*******************************************************************************/
function f_callBack(sSvcID)
{	
	if(sSvcID == "svcSearch")  //초기 폼로드시 
	{
	    //trace(ds_suplSvcCmms.SaveXML());
		//http.Sync = true;
			tab_suplSvcCmms.TabIndex = 0;
			f_setCode();        //적용날짜, 예정월, 코드 등등  초기 세팅	
			f_orgInfo();
			f_saleTyp();
			f_setSalePlcFilter();			
			f_setObjtSalePlcFilter();		
			f_setAplySalePlcFilter();
			//f_payInfo_Init();
			//trace(ds_addSaleAmtCd.SaveXML());
		//http.Sync = false;
		
		
	}
	if(sSvcID == "svcSave")
	{
		var sArg  = "POL_YM=" + quote(ds_suplSvcCmms.getColumn(0,"POL_YM")); 
		gf_OpenWindow( "100000067", sArg); 
		this.close();
	}
	if(sSvcID == "svcAdd")
	{
		var sArg  = "POL_YM=" + quote(ds_suplSvcCmms.getColumn(0,"POL_YM")); 
		gf_OpenWindow( "100000067", sArg); 
		this.close();
	}	
	if(sSvcID == "svcDelete")
	{
		var sArg  = "POL_YM=" + quote(ds_suplSvcCmms.getColumn(0,"POL_YM")); 
		gf_OpenWindow( "100000067", sArg); 
		this.close();
	}	

	
	tab_suplSvcCmms_tab_payInfo_div_payCon_rdo_PayCondCd_OnClick();

}

/*-----------------------------------------------------------------------------------
* 함수명 : f_setSalePlcFilter
* 기능명 : 대상판매처 조회
*----------------------------------------------------------------------------------*/
function f_setSalePlcFilter()
{
        //var sOrgId       = "";
        
	    tab_suplSvcCmms.tab_orgInfo.div_process.cmb_dealCoCl.Index = 0;    //약정기간
        
		f_setObjtSalePlcFilter();


}




/*******************************************************************************
* 함수명 : df_search
* 기능명 : 공통 조회 버튼 클릭
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function df_search(sArg)
{
	//alert(sArg);
	if (uf_isNull(sArg)== true) {
		ds_condition.SetColumn(0,"SPOL_ID",SPOL_ID);
		ds_condition.SetColumn(0,"POL_YM",POL_YM);
		ds_condition.SetColumn(0,"POL_TS",POL_TS);
		ds_condition.SetColumn(0,"APLY_STA_DTM",APLY_STA_DTM);
		ds_condition.SetColumn(0,"LAST_YN",LAST_YN);
	} else {
		// 리셋시.. 넘어온 파라메터를 데이타셋으로 세팅
		PRE_APLY_STA_DTM = "";
		PRE_APLY_END_DTM = "";
		ds_condition.clearData();
		ds_condition.addRow();
		var arrParams = sArg.split(" ", "webstyle");
		for(var i=0, n=arrParams.length; i<n; i++)
		{
			var arrParamInfo= arrParams[i].split("=","webstyle");
			var sParamName = arrParamInfo[0];
			var sparamValue = arrParamInfo[1];
			ds_condition.setColumn(0, sParamName, unQuote(sparamValue));
		}
	}

	if(uf_isNull(ds_suplSvcCmms.GetColumn(0,"SPOL_ID"))== true) {   //신규등록시
	
		if(uf_isNull(PRE_APLY_STA_DTM)== true && uf_isNull(MOD_YMD)== true) {   //적용시작일시를 안바꿨을때..
			//ds_condition.SetColumn(0,"APLY_STA_DTM",ds_condition.GetColumn(0,"POL_YM")+"010000");
			ds_condition.SetColumn(0,"APLY_STA_DTM",APLY_STA_DTM);
			if (uf_isNull(ds_condition.GetColumn(0,"APLY_STA_DTM"))== true) {
				ds_condition.SetColumn(0,"APLY_STA_DTM",ds_condition.GetColumn(0,"POL_YM")+"010000");
			}
		} else {
			ds_condition.SetColumn(0,"APLY_STA_DTM",MOD_YMD);
		}

	}
	
	//trace("============="+ds_condition.SaveXML());
    ds_condition.setColumn(0, "ORG_ID", POSAGENCYID);

	var sSvcID = "svcSearch";
	var sInDs = "nc_input_fieldDs=ds_condition";
	var sOutDs  = " ds_suplSvcCmms=ds_suplSvcCmms ";   //부가서비스장려금 기본정보
		sOutDs += " ds_orgInfo=ds_orgInfo ";             //조직정보
		sOutDs += " ds_slNet=ds_slNet ";                 //영업망
		sOutDs += " ds_dsNet=ds_dsNet ";                 //유통망
		sOutDs += " ds_saleTyp=ds_saleTyp ";             //판매유형
		sOutDs += " ds_mfact=ds_mfact ";                 //제조사
		sOutDs += " ds_objtModel=ds_objtModel ";         //대상모델
		sOutDs += " ds_aplyModel=ds_aplyModel ";		 //적용모델
		sOutDs += " ds_suplSvc=ds_suplSvc ";		     //지급정보 부가서비스
		sOutDs += " ds_payInfo=ds_payInfo ";		     //지급정보
		sOutDs += " ds_objtSalePlc=ds_objtSalePlc ";     //대상판매점
		sOutDs += " ds_aplySalePlc=ds_aplySalePlc ";     //적용판매점
	var sArg = "sktst.pol.ASP#getSuplSvcCmmsDetail";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);

}




/*******************************************************************************
* 함수명 : df_insert
* 기능명 : 공통 신규 버튼 클릭
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function df_insert(sButtonID)
{
	
}

/*******************************************************************************
* 함수명 : df_update
* 기능명 : 공통 수정 버튼 클릭
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function df_update(sButtonID)
{

}

/*******************************************************************************
* 함수명 : df_close
* 기능명 : 화면 종료
*******************************************************************************/
function df_close(sButtonID)
{
	this.close();
}


/*******************************************************************************
 * @description    : 공통 저장 함수
*******************************************************************************/
function df_save()
{
	// 마감여부 체크 입력한 일자가 마감 되었을 경우 '1'(true) 리턴.
	cf_CheckCloseMnth('04',ds_condition.getColumn(0,"POL_YM"),'적용기간'); 
	//마감이 됬다면... 저장못함.
	if(FV_BOOLEAN_CLOSE) return;
	
	
	if (!(f_pre_save())) return;  //유효성 체크

	var sSvcID = "";
	var sInDs = "";
	var sOutDs = "";
	var sArg = "";
	var APLY_STA_DTM = "";
	var APLY_END_DTM = "";
	
	APLY_STA_DTM = div_search.cal_aplyStaDtm.Value+Right("0"+div_search.edt_hour.Text,2)+Right("0"+div_search.edt_min.Text,2);
	APLY_END_DTM = div_search.cal_aplyEndDtm.Value+Right("0"+div_search.edt_endHour.Text,2)+Right("0"+div_search.edt_endMin.Text,2);
	ds_suplSvcCmms.SetColumn(0,"APLY_STA_DTM",APLY_STA_DTM);
	ds_suplSvcCmms.SetColumn(0,"APLY_END_DTM",APLY_END_DTM);
	ds_suplSvcCmms.SetColumn(0,"POL_YM",div_search.cal_polYm.Value);
	//alert(ds_suplSvcCmms.GetColumn(0,"ACC_SCHD_MTH"));
	//ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",div_search.cmb_accSchdYear.Value+div_search.cmb_accSchdMonth.Value);
	//trace(ds_aplyModel.SaveXML());
    //alert(PRE_APLY_STA_DTM+"___"+APLY_STA_DTM);
	if(PRE_APLY_STA_DTM == APLY_STA_DTM){
	    //저장하시겠습니까?
		if(confirm(cf_getMessage(MSG_00063, "")) == 1){
			sSvcID = "svcSave";

			sInDs  = " ds_suplSvcCmms=ds_suplSvcCmms ";      //부가상품수수료 기본정보
			sInDs += " ds_orgInfo=ds_orgInfo ";              //조직정보
			sInDs += " ds_slNet=ds_slNet ";                  //영업망
			sInDs += " ds_dsNet=ds_dsNet ";                  //유통망
			sInDs += " ds_aplyModel=ds_aplyModel ";		     //적용모델
			sInDs += " ds_saleTyp=ds_saleTyp ";              //판매유형
			sInDs += " ds_payInfo=ds_payInfo ";		         //지급정보
			sInDs += " ds_aplySalePlc=ds_aplySalePlc ";		 //적용판매처

			sOutDs = "";

			sArg = "sktst.pol.ASP#saveSuplSvcCmms";
			cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
		}
		
	}else{
	
		if(uf_isNull(ds_suplSvcCmms.GetColumn(0,"SPOL_ID"))== true) {   //리스트 클릭시 수정모드
						//새로운 부가상품수수료 정책을 반영하시겠습니까?
						if(confirm(cf_getMessage(MSG_00136, "새로운 부가상품수수료 정책을 반영")) == 1){
							
							sSvcID = "svcAdd";
				
							sInDs  = " ds_suplSvcCmms=ds_suplSvcCmms ";      //부가상품수수료 기본정보
							sInDs += " ds_orgInfo=ds_orgInfo ";              //조직정보
							sInDs += " ds_slNet=ds_slNet ";                  //영업망
							sInDs += " ds_dsNet=ds_dsNet ";                  //유통망
							sInDs += " ds_aplyModel=ds_aplyModel ";		     //적용모델
							sInDs += " ds_saleTyp=ds_saleTyp ";              //판매유형
							sInDs += " ds_payInfo=ds_payInfo ";		         //지급정보
							sInDs += " ds_aplySalePlc=ds_aplySalePlc ";		 //적용판매처
				
							sOutDs = "";
				
							 sArg = "sktst.pol.ASP#addSuplSvcCmms";
							 cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
						}
		} else {
				//저장하시겠습니까?
				if(confirm(cf_getMessage(MSG_00136, "소급 변경 ")) == 1){
					sSvcID = "svcSave";
		
					sInDs  = " ds_suplSvcCmms=ds_suplSvcCmms ";       //부가상품수수료 기본정보
					sInDs += " ds_orgInfo=ds_orgInfo ";              //조직정보
					sInDs += " ds_slNet=ds_slNet ";                  //영업망
					sInDs += " ds_dsNet=ds_dsNet ";                  //유통망
					sInDs += " ds_aplyModel=ds_aplyModel ";		     //적용모델
					sInDs += " ds_saleTyp=ds_saleTyp ";              //판매유형
					sInDs += " ds_payInfo=ds_payInfo ";		         //지급정보
					sInDs += " ds_aplySalePlc=ds_aplySalePlc ";		 //적용판매처
		
					sOutDs = "";
		
					sArg = "sktst.pol.ASP#saveSuplSvcCmms";
					cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
				} else {
						//새로운 부가상품수수료 정책을 반영하시겠습니까?
						if(confirm(cf_getMessage(MSG_00136, "새로운 부가상품수수료 정책을 반영")) == 1){
							
							sSvcID = "svcAdd";
				
							sInDs  = " ds_suplSvcCmms=ds_suplSvcCmms ";      //부가상품수수료 기본정보
							sInDs += " ds_orgInfo=ds_orgInfo ";              //조직정보
							sInDs += " ds_slNet=ds_slNet ";                  //영업망
							sInDs += " ds_dsNet=ds_dsNet ";                  //유통망
							sInDs += " ds_aplyModel=ds_aplyModel ";		     //적용모델
							sInDs += " ds_saleTyp=ds_saleTyp ";              //판매유형
							sInDs += " ds_payInfo=ds_payInfo ";		         //지급정보
							sInDs += " ds_aplySalePlc=ds_aplySalePlc ";		 //적용판매처
				
							sOutDs = "";
				
							 sArg = "sktst.pol.ASP#addSuplSvcCmms";
							 cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
						}
				}
		}

	}




	
}

/*******************************************************************************
* 함수명 : f_pre_save
* 기능명 : 저장버튼 전 체크함수 
*******************************************************************************/
function cf_compareMonth(sm,em)
{	
    var cnt = 0;
    var s = iif(length(sm) == 6, sm,mid(sm,0,6));
    var e = iif(length(sm) == 6, em,mid(em,0,6));
    while(s<e) {
        cnt++;
        s = addMonth(s+"01",1);
    }
    return cnt;

}

/*******************************************************************************
* 함수명 : f_pre_save
* 기능명 : 저장버튼 전 체크함수 
*******************************************************************************/
function f_pre_save()
{	
	//if(SAVE_FLAG = "N"){
	//	alert("변경사항이 없습니다.");
	//	return;
	//}

/**    
0:  당월
1:  1개월
2:  2개월
3:  3개월
6:  6개월
7:  M+1월말
8:  M+2월말
9:  M+1월 10일
10: M+1월 15일
11: M+1월 20일
	if (div_search.rdo_bakAply.Value == "N") {
	if (div_search.rdo_bakAply.Value == "N") {
	    div_search.cal_accSchdMth.Enable = false;
	    div_search.btn_accCalendar.Enable = false;
		ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",ds_condition.GetColumn(0,"POL_YM"));
	} else {
	    div_search.cal_accSchdMth.Enable = true;
	    div_search.btn_accCalendar.Enable = true;
		ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",substr(AddMonth(ds_condition.GetColumn(0,"POL_YM")+"01"),0,6));
	}
**/
	//tab_suplSvcCmms.tab_payInfo.grd_payInfo.ToolTipText = ds_payInfo.GetColumn(nRow,"SUPL_SVC_NM") + " : " + ds_payInfo.GetColumn(nRow,"POL_NM");	
    //alert(ToNumber(ds_condition.GetColumn(0,"POL_YM"))-ToNumber(ds_suplSvcCmms.GetColumn(0,"ACC_SCHD_MTH")));
    //var sMonth = cf_compareMonth(ds_condition.GetColumn(0,"POL_YM"),ds_suplSvcCmms.GetColumn(0,"ACC_SCHD_MTH"));


	if(length(div_search.edt_hour.Text) < 1 || div_search.edt_hour.Text > 24){
	    //적용기간 시작시간을 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "적용기간 시작시간"));
		div_search.edt_hour.SetFocus();
		return;
	}
	
	if(length(div_search.edt_min.Text) < 1 || div_search.edt_min.Text > 59){
	    //적용기간 시작분을 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "적용기간 시작분"));
		div_search.edt_min.SetFocus();
		return;
	}
	
    if(uf_isNull(div_search.edt_polNm.Text) == true) {
	    //정책명칭을 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "정책명칭"));
		div_search.edt_polNm.SetFocus();
		return;
    }


    var iCnt=0;
	for( var nRow=0; nRow<ds_orgInfo.rowcount; nRow++ ){
		if(ds_orgInfo.GetColumn(nRow,"SELECT4") == 1){
		    iCnt++;
		}
	}
    if (iCnt == 0) {
	    //대리점을 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "대리점을"));
		tab_suplSvcCmms.TabIndex = 0;
		tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.SetFocus();
		return;
    }

    if (ds_aplyModel.rowcount == 0) {
	    //적용모델을 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "적용모델"));
		return false;
    }

    
    var iCnt=0;
	for( var nRow=0; nRow<ds_slNet.rowcount; nRow++ ){
		if(ds_slNet.GetColumn(nRow,"SELECTED") == 1){
		    iCnt++;
		}
	}
    if (iCnt == 0) {
	    //영업망을 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "영업망을"));
		tab_suplSvcCmms.TabIndex = 2;
		tab_suplSvcCmms.tab_saleInfo.grd_slNet.SetFocus();
		return;
    }

    iCnt=0;
	for( var nRow=0; nRow<ds_dsNet.rowcount; nRow++ ){
		if(ds_dsNet.GetColumn(nRow,"SELECTED") == 1){
		    iCnt++;
		}
	}
    if (iCnt == 0) {
	    //유통망을 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "유통망을"));
		tab_suplSvcCmms.TabIndex = 2;
		tab_suplSvcCmms.tab_saleInfo.grd_dsNet.SetFocus();
		return;
    }

    iCnt=0;
	for( var nRow=0; nRow<ds_saleTyp.rowcount; nRow++ ){
		if(ds_saleTyp.GetColumn(nRow,"SELECT3") == "1"){
		    iCnt++;
		}
	}
    if (iCnt == 0) {
	    //판매유형을 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "판매유형을"));
		tab_suplSvcCmms.TabIndex = 2;
		tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.SetFocus();
		return;
    }
    

    if(ds_payInfo.rowcount <= 0) {
		//부가상품은 필수 사항입니다.
		alert(cf_getMessage(MSG_00135, "부가상품"));
		tab_suplSvcCmms.TabIndex = 3;
		return;
    }
    

	for( var nRow=0; nRow<ds_payInfo.rowcount; nRow++ ){
		if(uf_isNull(ds_payInfo.GetColumn(nRow,"SUPL_SVC_CD")) == true){
			//부가상품장려금은 필수 사항입니다.
			alert(cf_getMessage(MSG_00135, "부가상품장려금"));
			tab_suplSvcCmms.TabIndex = 3;
			f_set_gridFocus(grd_payInfo, nRow, 2);
			return false;
		}
	}



    iCnt=0;
	for( var nRow=0; nRow<ds_aplySalePlc.rowcount; nRow++ ){
		    iCnt++;
	}
    if (iCnt == 0) {
	    //적용 판매처를 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "적용 판매처를"));
		tab_suplSvcCmms.TabIndex = 0;
		tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.SetFocus();
		return;
    }


    if(uf_isNull(tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_oprMthdcd.Value) == true) {
	    //지급조건을 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "연산조건을"));
		tab_suplSvcCmms.TabIndex = 3;
		tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_oprMthdcd.SetFocus();
		return;
    }

    if(uf_isNull(tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Value) == true) {
	    //지급조건을 선택하여주십시요.
		alert(cf_getMessage(MSG_00047, "지급조건을"));
		tab_suplSvcCmms.TabIndex = 3;
		tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.SetFocus();
		return;
    }

    if(uf_isNull(tab_suplSvcCmms.tab_payInfo.div_payCon.edi_joinRt.Text) == true) {
	    //수수료를 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "유치율"));
		tab_suplSvcCmms.TabIndex = 3;
		tab_suplSvcCmms.tab_payInfo.div_payCon.edi_joinRt.Text.SetFocus();
		return;
    }

    if(uf_isNull(tab_suplSvcCmms.tab_payInfo.div_payCon.edt_cmms.Text) == true) {
	    //수수료를 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "수수료"));
		tab_suplSvcCmms.TabIndex = 3;
		tab_suplSvcCmms.tab_payInfo.div_payCon.edt_cmms.Text.SetFocus();
		return;
    }

    if(    tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Value == "00" 
        && uf_isNull(tab_suplSvcCmms.tab_payInfo.div_payCon.Edit0.Text) == true) {
	    //수수료를 입력하여주십시요.
		alert(cf_getMessage(MSG_00083, "차감 수수료"));
		tab_suplSvcCmms.TabIndex = 3;
		tab_suplSvcCmms.tab_payInfo.div_payCon.Edit0.Text.SetFocus();
		return;
    }

    

    return true;


}


/*******************************************************************************
* 함수명 : f_set_gridFocus
* 기능명 : 그리드 포커스 이동
*******************************************************************************/
function f_set_gridFocus(gridObj, nRow, nCellIdx) 
{	
	var dataSetObj = object(gridObj.bindDataset);
	dataSetObj.row = nRow;
	gridObj.SetCellPos(nCellIdx);
	gridObj.SetFocus();
}


/*******************************************************************************
* 함수명 : df_delete
* 기능명 : 삭제
*******************************************************************************/
function df_delete(sButtonID)
{
	// 마감여부 체크 입력한 일자가 마감 되었을 경우 '1'(true) 리턴.
	cf_CheckCloseMnth('04',ds_condition.getColumn(0,"POL_YM"),'적용기간'); 
	//마감이 됬다면... 저장못함.
	if(FV_BOOLEAN_CLOSE) return;
	
	if(confirm(cf_getMessage(MSG_00136, "부가상품수수료를 삭제")) == 1){ //부가상품수수료를 삭제 하시겠습니까?	
		var sSvcID = "svcDelete";
		var sInDs = "nc_input_fieldDs=ds_suplSvcCmms";
		var sOutDs = "";
		var sArg = "sktst.pol.ASP#deleteSuplSvcCmms";
		
		cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	}
}



/*******************************************************************************
* 함수명 : div_search_cmb_spolSuplMgmt_OnChanged
* 기능명 : 부가서비스장려금 선택
*******************************************************************************/
function div_search_cmb_spolSuplMgmt_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{

		for( var idx =0 ; idx<=ds_spolSuplMgmt.RowCount(); idx++ ){
		    if( strCode == ds_spolSuplMgmt.GetColumn(idx,"SPOL_ID") ) {

				ds_condition.SetColumn(0,"SPOL_ID",ds_spolSuplMgmt.GetColumn(idx,"SPOL_ID"));
				ds_condition.SetColumn(0,"POL_YM",ds_spolSuplMgmt.GetColumn(idx,"POL_YM"));
				ds_condition.SetColumn(0,"POL_TS",ds_spolSuplMgmt.GetColumn(idx,"POL_TS"));
				ds_condition.SetColumn(0,"APLY_STA_DTM",ds_spolSuplMgmt.GetColumn(idx,"APLY_STA_DTM"));
				ds_condition.SetColumn(0,"LAST_YN",ds_spolSuplMgmt.GetColumn(idx,"LAST_YN"));

				//alert(ds_spolSuplMgmt.GetColumn(idx,"SPOL_ID")+"--"+ds_spolSuplMgmt.GetColumn(idx,"POL_YM")+"---"+ds_spolSuplMgmt.GetColumn(idx,"POL_TS"));
				var sSvcID = "svcSuplAply";
				var sInDs = "nc_input_fieldDs=ds_condition";
				var sOutDs  = " ds_suplSvcCmms=ds_suplSvcCmms ";   //부가서비스장려금 기본정보
					sOutDs += " ds_orgInfo=ds_orgInfo ";             //조직정보
					sOutDs += " ds_slNet=ds_slNet ";                 //영업망
					sOutDs += " ds_dsNet=ds_dsNet ";                 //유통망
					sOutDs += " ds_saleTyp=ds_saleTyp ";             //판매유형
					sOutDs += " ds_mfact=ds_mfact ";                 //제조사
					sOutDs += " ds_objtModel=ds_objtModel ";         //대상모델
					sOutDs += " ds_aplyModel=ds_aplyModel ";		 //적용모델
					sOutDs += " ds_suplSvc=ds_suplSvc ";		     //지급정보 부가서비스
					sOutDs += " ds_payInfo=ds_payInfo ";		     //지급정보
					sOutDs += " ds_objtSalePlc=ds_objtSalePlc ";     //대상판매점
				var sArg = "sktst.pol.ASP#getSuplSvcCmmsDetail";
				
				cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
				break;		    
		    }
		}
	
}






/*******************************************************************************
* 함수명 : tab_suplSvcCmms_tab_orgInfo_Grid0_OnHeadClick
* 기능명 : 부가상품수수료 대상 판매처 전체선택
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_Grid0_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0 )
	{
		f_gridcheckOneAll(obj,ds_objtSalePlc);  //전부 체크
	}
	
}

/*******************************************************************************
* 함수명 : tab_suplSvcCmms_tab_orgInfo_Grid2_OnHeadClick
* 기능명 : 부가상품수수료 적용 판매처 전체선택
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_Grid2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell==0 )
	{
		f_gridcheckOneAll(obj,ds_aplySalePlc);  //전부 체크
	}
	
}




/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_orgInfo_btn_toAplySalePlc_OnClick
* 기능명 : 대상판매처에서 적용판매처로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_orgInfo_btn_toAplySalePlc_OnClick(obj)
{
	if(ds_objtSalePlc.currow == -1 ){
	    //선택된 대상모델 없습니다.
		alert(cf_getMessage(MSG_00134, "대상모델"));
		return;
	}
	
	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = false;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = false;

	var sHead = tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.GetCellProp("head",0,"text");
	var nTotCnt = ds_objtSalePlc.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;

	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_objtSalePlc.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_objtSalePlc.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_objtSalePlc.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_aplySalePlc.AddRow();
			ds_aplySalePlc.CopyRow(ds_aplySalePlc.lastrow,ds_objtSalePlc,nRow);
			ds_aplySalePlc.SetColumn(ds_aplySalePlc.lastrow, "SELECTED", "0");
			ds_objtSalePlc.DeleteRow(nRow);
	   }
	}

	//ds_aplySalePlc.Sort("PROD_NM");
	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = true;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = true;
	
}






/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_orgInfo_btn_toObjtSalePlc_OnClick
* 기능명 : 적용판매처에서 대상판매처로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_orgInfo_btn_toObjtSalePlc_OnClick(obj)
{
	if(ds_aplySalePlc.currow == -1 ){
	    //선택된 적용모델 없습니다.
		alert(cf_getMessage(MSG_00134, "적용모델"));
		return;
	}

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = false;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = false;
	
	var sHead = tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.GetCellProp("head",0,"text");
	var nTotCnt = ds_aplySalePlc.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
	
	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_aplySalePlc.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_aplySalePlc.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_aplySalePlc.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_objtSalePlc.AddRow();
			ds_objtSalePlc.CopyRow(ds_objtSalePlc.lastrow,ds_aplySalePlc,nRow);
			ds_objtSalePlc.SetColumn(ds_objtSalePlc.lastrow, "SELECTED", "0");
			ds_aplySalePlc.DeleteRow(nRow);
	   }
	}

	//ds_objtModel.Sort("PROD_NM");
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = true;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = true;
	
}


/*-----------------------------------------------------------------------------------
* 함수명 : f_moveAplyToObjtSalePlc
* 기능명 : 조직정보 체크해제시 적용판매처에서 대상판매처로 이동
*----------------------------------------------------------------------------------*/
function f_moveAplyToObjtSalePlc()
{
    var sORG_ID_4 = "";
	for( var idx =0 ; idx<=ds_orgInfo.RowCount(); idx++ ){
		if(ds_orgInfo.GetColumn(idx,"SELECT4") == "0"){
			sORG_ID_4 = sORG_ID_4 + ds_orgInfo.GetColumn(idx,"ORG_ID_4") + ","; 
		}
	}

	sORG_ID_4 = SubStr(sORG_ID_4,0,Length(sORG_ID_4)-1);
	
	var arrOrgId = sORG_ID_4.split(",", "webstyle");

	for( var idx =0 ; idx<=ds_aplySalePlc.RowCount(); idx++ ){
		for(var i=0; i<=arrOrgId.length; i++)
		{
			if(ds_aplySalePlc.GetColumn(idx,"ORG_ID") == arrOrgId[i]){
				ds_aplySalePlc.SetColumn(idx,"SELECTED","1"); 
			}
		}
	}
	
	if(ds_aplySalePlc.currow == -1 ){
		return;
	}

	tab_suplSvcCmms_tab_orgInfo_btn_toObjtSalePlc_OnClick();
}


//############################################################################################
//적용기간 날짜 입력 오류 체크
//############################################################################################
/*******************************************************************************
* 함수명 : div_search_cal_aply_sta_dtm_OnChanged
* 기능명 :  적용기간 시작일 OnChanged 발생시
*******************************************************************************/
function div_search_cal_aplyStaDtm_OnChanged(obj,strOldText,strNewText)
{
	if(uf_isNull(div_search.cal_aplyStaDtm.Value) == false){ 
	
	    if(substr(ds_condition.GetColumn(0,"POL_YM"),0,6) > substr(div_search.cal_aplyStaDtm.Value,0,6)) {
					ds_condition.SetColumn(0,"APLY_STA_DTM",substr(strOldText,0,8));
					obj.SetFocus();
		
					MOD_YMD     = "";
					MOD_YMD_END = "";

					//적용기간은 적용시작일자와 종료일자 기간 사이에 입력하십시오.
					alert(cf_getMessage(MSG_00131, "적용기간;적용시작일자;종료일자"));
					return false;
	    }

		var lastDay = uf_MonthLastDay(ds_condition.GetColumn(0,"POL_YM")+"01");
        /**
        if(ds_condition.GetColumn(0,"POL_YM") == "1") {
			PRE_APLY_STA_DTM     = ds_condition.GetColumn(0,"POL_YM")+"010000";
			PRE_APLY_END_DTM = ds_condition.GetColumn(0,"POL_YM")+lastDay+"2359";
        }
        **/
		MOD_YMD     = div_search.cal_aplyStaDtm.Value+div_search.edt_hour.Text+div_search.edt_min.Text;
		MOD_YMD_END = div_search.cal_aplyEndDtm.Value+div_search.edt_endHour.Text+div_search.edt_endMin.Text;

		if(uf_isNull(PRE_APLY_STA_DTM) == false){ 
			if(ds_condition.GetColumn(0,"POL_TS") == "1") {
				if(MOD_YMD < ds_condition.GetColumn(0,"POL_YM")+"010000" || MOD_YMD > ds_condition.GetColumn(0,"POL_YM")+lastDay+"2359"){
					ds_condition.SetColumn(0,"APLY_STA_DTM",substr(strOldText,0,8));
					obj.SetFocus();

					MOD_YMD     = "";
					MOD_YMD_END = "";
					//PRE_APLY_STA_DTM = "";
					//PRE_APLY_END_DTM = "";
					
					//적용기간은 적용시작일자와 종료일자 기간 사이에 입력하십시오.
					alert(cf_getMessage(MSG_00131, "적용기간;적용시작일자;종료일자"));
					return false;
				}
			} else {
			    //alert(ds_gnrlPrMny.GetColumn(0,"APLY_STA_DTM"));
				if(MOD_YMD <= ds_suplSvcCmms.GetColumn(0,"APLY_STA_DTM") || MOD_YMD >= ds_suplSvcCmms.GetColumn(0,"APLY_END_DTM")){
					ds_condition.SetColumn(0,"APLY_STA_DTM",substr(strOldText,0,8));
					obj.SetFocus();

					MOD_YMD     = "";
					MOD_YMD_END = "";
					//PRE_APLY_STA_DTM = "";
					//PRE_APLY_END_DTM = "";

					//적용기간은 적용시작일자와 종료일자 기간 사이에 입력하십시오.
					alert(cf_getMessage(MSG_00131, "적용기간;적용시작일자;종료일자"));
					return false;
				}
			}
            
		}
		if(MOD_YMD > MOD_YMD_END){
			ds_condition.SetColumn(0,"APLY_STA_DTM",substr(strOldText,0,8));
			obj.SetFocus();

			MOD_YMD     = "";
			MOD_YMD_END = "";
			//PRE_APLY_STA_DTM = "";
			//PRE_APLY_END_DTM = "";
			
			//적용기간은 적용시작일자와 종료일자 기간 사이에 입력하십시오.
			alert("종료일자와 시작일자가 잘못 입력 되었습니다.");
			return false;
		}
			var sArg  = " SPOL_ID="+ quote(ds_condition.getColumn(0,"SPOL_ID"));
				sArg += " POL_YM=" + quote(ds_condition.getColumn(0,"POL_YM"));
				sArg += " POL_TS=" + quote(ds_condition.getColumn(0,"POL_TS"));
				sArg += " APLY_STA_DTM=" + quote(MOD_YMD);
				sArg += " APLY_END_DTM=" + quote(MOD_YMD_END);
				sArg += " LAST_YN=" + quote("Y");
			gf_OpenWindow( "100000142", sArg); 

	
	}
	
}

/*******************************************************************************
* 함수명 : div_search_edt_hour_OnChanged
* 기능명 :  적용기간 시간 변경시 
*******************************************************************************/
function div_search_edt_hour_OnChanged(obj,strText)
{
	if(uf_isNull(strText) == false){
		
		if(length(strText) !=2) {
			
			strText = Lpad(strText,"0",2);
			ds_condition.SetColumn(0,"HOUR",strText);
		}
		
		if(strText > 23){
			ds_condition.SetColumn(0,"HOUR","00");
			obj.SetFocus();
			//23시 초과할수 없습니다.
			alert(cf_getMessage(MSG_00034, "23시를"));
			return false;
		}
		
		var MOD_YMD = div_search.cal_aplyStaDtm.Value+div_search.edt_hour.Text+div_search.edt_min.Text;
	
		if(uf_isNull(PRE_APLY_STA_DTM) == false){ 
			if(MOD_YMD <= PRE_APLY_STA_DTM || MOD_YMD >= PRE_APLY_END_DTM){
				ds_condition.SetColumn(0,"HOUR","00");
				obj.SetFocus();
				//적용기간은 적용시작일자와 종료일자 기간 사이에 입력하십시오.
				alert(cf_getMessage(MSG_00131, "적용기간;적용시작일자;종료일자"));
				return false;
				
			}
		}
	}
	
}

/*******************************************************************************
* 함수명 : div_search_edt_min_OnChanged
* 기능명 :  적용기간 분 변경시 
*******************************************************************************/
function div_search_edt_min_OnChanged(obj,strText)
{
	if(uf_isNull(strText) == false){
	
		if(length(strText) !=2) {
			
			strText = Lpad(strText,"0",2);
			ds_condition.SetColumn(0,"MIN",strText);
		}
		
		if(strText > 59){
			ds_condition.SetColumn(0,"MIN","00");
			obj.SetFocus();
			//59분을 초과할수 없습니다.
			alert(cf_getMessage(MSG_00034, "59분을"));
			return false;
		}
		
		var MOD_YMD = div_search.cal_aplyStaDtm.Value+div_search.edt_hour.Text+div_search.edt_min.Text;
	
		if(uf_isNull(PRE_APLY_STA_DTM) == false){ 
			if(MOD_YMD <= PRE_APLY_STA_DTM || MOD_YMD >= PRE_APLY_END_DTM){
				ds_condition.SetColumn(0,"MIN","00");
				obj.SetFocus();
				//적용기간은 적용시작일자와 종료일자 기간 사이에 입력하십시오.
				alert(cf_getMessage(MSG_00131, "적용기간;적용시작일자;종료일자"));
				return false;
				
			}
		}
	}
	
}



/*******************************************************************************
* 함수명 : div_search_edt_endHour_OnChanged
* 기능명 :  적용종료기간 시간 변경시 
*******************************************************************************/
function div_search_edt_endHour_OnChanged(obj,strText)
{
	if(uf_isNull(strText) == false){
		
		if(length(strText) !=2) {
			
			strText = Lpad(strText,"0",2);
			ds_condition.SetColumn(0,"END_HOUR",strText);
		}
		
		if(strText > 23){
			ds_condition.SetColumn(0,"END_HOUR","00");
			obj.SetFocus();
			//23시 초과할수 없습니다.
			alert(cf_getMessage(MSG_00034, "23시를"));
			return false;
		}
		
	}
	
}

/*******************************************************************************
* 함수명 : div_search_edt_endMin_OnChanged
* 기능명 :  적용기간 분 변경시 
*******************************************************************************/
function div_search_edt_endMin_OnChanged(obj,strText)
{
	if(uf_isNull(strText) == false){
	
		if(length(strText) !=2) {
			strText = Lpad(strText,"0",2);
			ds_condition.SetColumn(0,"END_MIN",strText);
		}

		if(strText > 59){
			ds_condition.SetColumn(0,"END_MIN","00");
			obj.SetFocus();
			//59분을 초과할수 없습니다.
			alert(cf_getMessage(MSG_00034, "59분을"));
			return false;
		}
		
	}
	
}

/*******************************************************************************
* 함수명 : div_search_cal_aplyEndDtm_OnChanged
* 기능명 :  적용기간 시작일 OnChanged 발생시
*******************************************************************************/
function div_search_cal_aplyEndDtm_OnChanged(obj,strOldText,strNewText)
{
	if(uf_isNull(strOldText) == false){ 

		var MOD_YMD = div_search.cal_aplyEndDtm.Value+div_search.edt_endHour.Text+div_search.edt_endMin.Text;
		var STA_YMD = div_search.cal_aplyStaDtm.Value+div_search.edt_Hour.Text+div_search.edt_Min.Text;

		//if(uf_isNull(PRE_APLY_STA_DTM) == false){ 
			if(MOD_YMD <= STA_YMD){
				ds_condition.SetColumn(0,"APLY_END_DTM",substr(strOldText,0,8));
				obj.SetFocus();
				//적용종료기간은 적용시작일자 이상으로 입력하십시오.
				alert(cf_getMessage(MSG_00132, "적용종료기간;적용시작일자"));
				return false;
				
			}
		//}
	}
	
}


/*******************************************************************************
 * @description    :  월달력 사용 - 이벤트
*******************************************************************************/
function btn_monthCalendar_OnClick(obj)
{
    if(obj.Id == "btn_accCalendar") {
		cf_callMonthCalendar(div_search.cal_accSchdMth);
    } else {
		cf_callMonthCalendar(div_search.cal_polYm);
    }
}

/*******************************************************************************
* 함수명 : btn_import_OnClick
* 기능명 :  엑셀 export
*******************************************************************************/
function btn_export_OnClick(obj)
{
	cf_exportExcel(tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc);
}

/*******************************************************************************
* 함수명 : btn_import_OnClick2
* 기능명 :  엑셀 export
*******************************************************************************/
function btn_export_OnClick2(obj)
{
	cf_exportExcel(tab_suplSvcCmms.tab_prodInfo.grd_aplyModel);
}

function tab_suplSvcCmms_tab_orgInfo_div_process_rdo_salePlcAplyCl_OnClick(obj)
{

	var sFilterDs   = "";


	var iCnt=0;
	for( var nRow=0; nRow<ds_orgInfo.rowcount; nRow++ ){
		if(ds_orgInfo.GetColumn(nRow,"SELECT4") == "1"){

			sFilterDs += " ORG_ID='" + ds_orgInfo.GetColumn(nRow,"ORG_ID_4") + "' ||";			
			iCnt++;
		
		}
	}
	if (iCnt == 0) {
			sFilterDs += " ORG_ID='000000' ||";			
	}

	sFilterDs = "(" + SubStr(sFilterDs,0,Length(sFilterDs)-2) + ") &&";

    
    if ( obj.Value == "01") {

        var strSalePlcAplyCl = tab_suplSvcCmms.tab_orgInfo.div_process.rdo_salePlcAplyCl.value;

		ds_objtSalePlc.Filter(sFilterDs + " SALE_PLC_APLY_CL='" + strSalePlcAplyCl + "'");
    
    
    } else {
		ds_objtSalePlc.Filter(SubStr(sFilterDs,0,Length(sFilterDs)-2));
    }

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = false;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = false;
	
	var sHead = tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.GetCellProp("head",0,"text");
	var nTotCnt = ds_aplySalePlc.GetCount();
	if( nTotCnt > 0 ) {

		if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
		for(var nRow=nTotCnt; nRow>=0; nRow--){
				ds_objtSalePlc.AddRow();
				ds_objtSalePlc.CopyRow(ds_objtSalePlc.lastrow,ds_aplySalePlc,nRow);
				ds_objtSalePlc.SetColumn(ds_objtSalePlc.lastrow, "SELECTED", "0");
				ds_aplySalePlc.DeleteRow(nRow);
		}
	
	}
	

	//ds_objtModel.Sort("PROD_NM");
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = true;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = true;
    
	
}

function tab_suplSvcCmms_tab_orgInfo_grd_objtSalePlc_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.ToolTipText = tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.GetCellValue(nRow, 1);
	
}

function tab_suplSvcCmms_tab_orgInfo_grd_aplySalePlc_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.ToolTipText = tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.GetCellValue(nRow, 1);	
	
}

/*******************************************************************************
* 함수명 : tab_suplSvcCmms_tab_payInfo_div_payCon_rdo_PayCondCd_OnClick
* 기능명 :  지급정보 탭에서 지급조건 레디오버튼 클릭시
*******************************************************************************/
function tab_suplSvcCmms_tab_payInfo_div_payCon_rdo_PayCondCd_OnClick(obj)
{
	//alert(tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Value);
	if (tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Value == "00") {
	    tab_suplSvcCmms.tab_payInfo.div_payCon.StaticP.Visible = true;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.StaticM.Visible = true;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Static1.Visible = true;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Edit0.Visible = true;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Image2.Visible = true;
	} else if (tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Value == "01") {
	    tab_suplSvcCmms.tab_payInfo.div_payCon.StaticP.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.StaticM.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Static1.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Edit0.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Image2.Visible = false;
		ds_suplSvcCmms.SetColumn(0, "CMMS_M", "0");
	} else if (tab_suplSvcCmms.tab_payInfo.div_payCon.rdo_PayCondCd.Value == "02") {
	    tab_suplSvcCmms.tab_payInfo.div_payCon.StaticP.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.StaticM.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Static1.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Edit0.Visible = false;
	    tab_suplSvcCmms.tab_payInfo.div_payCon.Image2.Visible = false; 
		ds_suplSvcCmms.SetColumn(0, "CMMS_M", "0");
	}
}








function tab_suplSvcCmms_tab_orgInfo_div_process_rdo_salePlcAplyCl_OnClick(obj)
{
	f_setObjtSalePlcFilter();
    ds_aplySalePlc.Unfilter();

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = false;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = false;
	
	var sHead = tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.GetCellProp("head",0,"text");
	var nTotCnt = ds_aplySalePlc.GetCount();
	if( nTotCnt > 0 ) {

		if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
		for(var nRow=nTotCnt; nRow>=0; nRow--){
				ds_objtSalePlc.AddRow();
				ds_objtSalePlc.CopyRow(ds_objtSalePlc.lastrow,ds_aplySalePlc,nRow);
				ds_objtSalePlc.SetColumn(ds_objtSalePlc.lastrow, "SELECTED", "0");
				ds_aplySalePlc.DeleteRow(nRow);
		}
	
	}
	

	//ds_objtModel.Sort("PROD_NM");
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = true;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = true;
	
}

/*******************************************************************************
 * @description    : 판매처 구분 변경시- 이벤트
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_div_process_cmb_dealCoCl_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	
	var sCheckTarget1 = "A2,A3,B1,B2";
		
		
	if(sCheckTarget1.indexOf(strCode) >= 0)
	{
		//div_process.cmb_sale.Enable = true;		
		tab_suplSvcCmms.tab_orgInfo.div_process.cmb_saleGrp.Enable = true;
	}
	else
	{
		//div_process.cmb_sale.index = 0;
		//div_process.cmb_sale.Enable = false;
		
		tab_suplSvcCmms.tab_orgInfo.div_process.cmb_saleGrp.index = 0;
		tab_suplSvcCmms.tab_orgInfo.div_process.cmb_saleGrp.Enable = false;		
	}
	f_setObjtSalePlcFilter();

}

/*******************************************************************************
* 함수명 : tab_suplSvcCmms_tab_orgInfo_grd_objtSalePlc_OnHeadClick
* 기능명 : 부가상품수수료 대상 판매처 전체선택
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_grd_objtSalePlc_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(object(obj.bindDataset).getRowCount() > 0)
	{
		var sType = obj.GetCellProp("head", nCell, "display");
		if(sType == "checkbox")	
		{
			if( nCell==0 )
			{
				f_gridcheckOneAll(obj,ds_objtSalePlc);  //전부 체크
			}
		}
		else
		{
			cf_markGridSort(obj, nCell, nX, nY, nPivotIndex);
		}
	}

	
}

 /*******************************************************************************
 * @description    : 풍선도움말 OnMouseOver event
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_grd_objtSalePlc_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.ToolTipText = tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.GetCellValue(nRow, 1);	
	
}

/*******************************************************************************
* 함수명 : tab_suplSvcCmms_tab_orgInfo_grd_aplySalePlc_OnHeadClick
* 기능명 : 부가상품수수료 적용 판매처 전체선택
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_grd_aplySalePlc_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(object(obj.bindDataset).getRowCount() > 0)
	{
		var sType = obj.GetCellProp("head", nCell, "display");
		if(sType == "checkbox")	
		{
			if( nCell==0 )
			{
				f_gridcheckOneAll(obj,ds_aplySalePlc);  //전부 체크
			}
		}
		else
		{
			cf_markGridSort(obj, nCell, nX, nY, nPivotIndex);
		}
	}
}

 /*******************************************************************************
 * @description    : 풍선도움말 OnMouseOver event
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_grd_aplySalePlc_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.ToolTipText = tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.GetCellValue(nRow, 1);	
	
}



/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_orgInfo_btn_toAplySalePlc_OnClick
* 기능명 : 대상판매처에서 적용판매처로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_orgInfo_btn_toAplySalePlc_OnClick(obj)
{
	if(ds_objtSalePlc.currow == -1 ){
	    //선택된 대상판매처 없습니다.
		alert(cf_getMessage(MSG_00134, "대상판매처"));
		return;
	}
	
	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = false;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = false;

	var sHead = tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.GetCellProp("head",0,"text");
	var nTotCnt = ds_objtSalePlc.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;

	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_objtSalePlc.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_objtSalePlc.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_objtSalePlc.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_aplySalePlc.AddRow();
			ds_aplySalePlc.CopyRow(ds_aplySalePlc.lastrow,ds_objtSalePlc,nRow);
			ds_aplySalePlc.SetColumn(ds_aplySalePlc.lastrow, "SELECTED", "0");
			ds_objtSalePlc.DeleteRow(nRow);
	   }
	}

	//ds_aplySalePlc.Sort("PROD_NM");
	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = true;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = true;
	
}

/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_orgInfo_btn_toObjtSalePlc_OnClick
* 기능명 : 적용판매처에서 대상판매처로 이동함
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_orgInfo_btn_toObjtSalePlc_OnClick(obj)
{
	if(ds_aplySalePlc.currow == -1 ){
	    //선택된 적용판매처 없습니다.
		alert(cf_getMessage(MSG_00134, "적용판매처"));
		return;
	}

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = false;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = false;
	
	var sHead = tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.GetCellProp("head",0,"text");
	var nTotCnt = ds_aplySalePlc.GetCount();
	if( nTotCnt > 0 ) nTotCnt = nTotCnt -1;
	
	for(var nRow=nTotCnt; nRow>=0; nRow--){
	   var bCheck = false;
	   if( sHead == "1" ){
			bCheck = ds_aplySalePlc.GetColumn(nRow,"SELECTED");
	   }else{
			bCheck = ds_aplySalePlc.GetColumn(nRow,"SELECTED");
			if( bCheck == false || bCheck == null || length(bCheck) == 0){
				bCheck = ds_aplySalePlc.GetSelect(nRow);
			}
	   }
	   
	   if( bCheck == true){
			ds_objtSalePlc.AddRow();
			ds_objtSalePlc.CopyRow(ds_objtSalePlc.lastrow,ds_aplySalePlc,nRow);
			ds_objtSalePlc.SetColumn(ds_objtSalePlc.lastrow, "SELECTED", "0");
			ds_aplySalePlc.DeleteRow(nRow);
	   }
	}

	//ds_objtModel.Sort("PROD_NM");
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.SetCellProp("head",0,"text","0");

	tab_suplSvcCmms.tab_orgInfo.grd_objtSalePlc.Redraw = true;
	tab_suplSvcCmms.tab_orgInfo.grd_aplySalePlc.Redraw  = true;
	
}



/*******************************************************************************
 * @description    : 영업그룹 변경시- 이벤트
*******************************************************************************/
function tab_suplSvcCmms_tab_orgInfo_div_process_cmb_saleGrp_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	f_setObjtSalePlcFilter();	
}

/*******************************************************************************
 * @description    : 대상판매서 필터
*******************************************************************************/
function f_setObjtSalePlcFilter()
{
    //if(iCnt>0) {
		var strDealCoCl = tab_suplSvcCmms.tab_orgInfo.div_process.cmb_dealCoCl.value;
		var strSaleGrp  = tab_suplSvcCmms.tab_orgInfo.div_process.cmb_saleGrp.value;
        var strSalePlcAplyCl = tab_suplSvcCmms.tab_orgInfo.div_process.rdo_salePlcAplyCl.value;
		var sFilterDs   = "";
	
	
		var iCnt=0;
		for( var nRow=0; nRow<ds_orgInfo.rowcount; nRow++ ){
			if(ds_orgInfo.GetColumn(nRow,"SELECT4") == "1"){

				sFilterDs += " ORG_ID='" + ds_orgInfo.GetColumn(nRow,"ORG_ID_4") + "' ||";			
				iCnt++;
			
			}
		}
		if (iCnt == 0) {
				sFilterDs += " ORG_ID='000000' ||";			
		}
	
		//ds_objtSalePlc.Filter(SubStr(sFilterDs,0,Length(sFilterDs)-2));
		sFilterDs = "(" + SubStr(sFilterDs,0,Length(sFilterDs)-2) + ") &&";

		//ds_objtModel.Unfilter();
		if(uf_isNull(strDealCoCl) == false){
			sFilterDs += " DEAL_CO_CL1='" + strDealCoCl + "' &&";
		}
		if (uf_isNull(strSaleGrp) == false) {
			sFilterDs += " SALE_GRP='" + strSaleGrp + "' &&";
		}

		if ( strSalePlcAplyCl == "01") {	
			sFilterDs += " SALE_PLC_APLY_CL='" + strSalePlcAplyCl + "' &&";		
		}
		//trace(ds_objtSalePlc.SaveXML());
		//alert(iCnt+"==="+SubStr(sFilterDs,0,Length(sFilterDs)-2));
			//sFilterDs += " 1=1";
			//alert(SubStr(sFilterDs,0,Length(sFilterDs)-2));
		ds_objtSalePlc.Filter(SubStr(sFilterDs,0,Length(sFilterDs)-2));
    //}
}

/*******************************************************************************
 * @description    : 적용판매처 필터
*******************************************************************************/
function f_setAplySalePlcFilter()
{
    //if(iCnt>0) {
        var strSalePlcAplyCl = tab_suplSvcCmms.tab_orgInfo.div_process.rdo_salePlcAplyCl.value;
		var sFilterDs   = "";
	
	
		if ( strSalePlcAplyCl == "01") {	
			sFilterDs += " SALE_PLC_APLY_CL='" + strSalePlcAplyCl + "' &&";		
		}
		//trace(ds_objtSalePlc.SaveXML());
		//alert(iCnt+"==="+SubStr(sFilterDs,0,Length(sFilterDs)-2));
			//sFilterDs += " 1=1";
			//alert(SubStr(sFilterDs,0,Length(sFilterDs)-2));
		ds_aplySalePlc.Filter(SubStr(sFilterDs,0,Length(sFilterDs)-2));
    //}
}


/*-----------------------------------------------------------------------------------
* 함수명 : tab_suplSvcCmms_tab_payInfo_div_process_cmb_suplSvcCd_OnChanged
* 기능명 : 대상부가상품 조회(부가상품구분 select박스 선택시)
*----------------------------------------------------------------------------------*/
function tab_suplSvcCmms_tab_payInfo_div_process_cmb_suplSvcCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
        var strSuplSvcCd = tab_suplSvcCmms.tab_payInfo.div_process.cmb_suplSvcCd.value;
		if(uf_isNull(strSuplSvcCd) == true) {
			ds_suplSvc.UnFilter();
		} else {
			ds_suplSvc.Filter(" SUPL_SVC_CL='" + strSuplSvcCd + "'");
		}
	
}



function tab_suplSvcCmms_tab_payInfo_grd_suplSvc_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	
	tab_suplSvcCmms.tab_payInfo.grd_suplSvc.ToolTipText = ds_suplSvc.GetColumn(nRow,"SUPL_SVC_NM") + " : " + ds_suplSvc.GetColumn(nRow,"POL_NM");	
	//tab_suplSvcCmms.tab_payInfo.grd_suplSvc.ToolTipText = tab_suplSvcCmms.tab_payInfo.grd_suplSvc.GetCellValue(nRow, 2);	
}

/*******************************************************************************
 * @description    :  지급정보 탭 클릭시
*******************************************************************************/
function tab_suplSvcCmms_OnChanged(obj,nOldIndex,nNewindex)
{
	if(nNewindex == 1) {
		if (ds_objtModel.rowcount == 0 && ds_aplyModel.rowcount == 0) {
			//운영모델단가표가 등록되어 있지 않습니다.
			alert(cf_getMessage(MSG_00013, substr(ds_condition.GetColumn(0,"POL_YM"),0,4)+"년" +substr(ds_condition.GetColumn(0,"POL_YM"),4,6) +"월 운영모델단가표가"));
			return false;
		}
	} else if(nNewindex == 3) {

			var iCnt=0;
			for( var nRow=0; nRow<ds_orgInfo.rowcount; nRow++ ){
				if(ds_orgInfo.GetColumn(nRow,"SELECT4") == 1){
					iCnt++;
				}
			}
			if (iCnt == 0) {
				//대리점을 선택하여주십시요.
				alert(cf_getMessage(MSG_00047, "대리점을"));
				tab_suplSvcCmms.TabIndex = 0;
				tab_suplSvcCmms.tab_orgInfo.grd_orgInfo.SetFocus();
				return;
			}
		
			if (ds_aplyModel.rowcount == 0) {
				//적용모델을 입력하여주십시요.
				alert(cf_getMessage(MSG_00083, "적용모델"));
				tab_suplSvcCmms.TabIndex = 1;
				return false;
			}
		
			
			var iCnt=0;
			for( var nRow=0; nRow<ds_slNet.rowcount; nRow++ ){
				if(ds_slNet.GetColumn(nRow,"SELECTED") == 1){
					iCnt++;
				}
			}
			if (iCnt == 0) {
				//영업망을 선택하여주십시요.
				alert(cf_getMessage(MSG_00047, "영업망을"));
				tab_suplSvcCmms.TabIndex = 2;
				tab_suplSvcCmms.tab_saleInfo.grd_slNet.SetFocus();
				return;
			}
		
			iCnt=0;
			for( var nRow=0; nRow<ds_dsNet.rowcount; nRow++ ){
				if(ds_dsNet.GetColumn(nRow,"SELECTED") == 1){
					iCnt++;
				}
			}
			if (iCnt == 0) {
				//유통망을 선택하여주십시요.
				alert(cf_getMessage(MSG_00047, "유통망을"));
				tab_suplSvcCmms.TabIndex = 2;
				tab_suplSvcCmms.tab_saleInfo.grd_dsNet.SetFocus();
				return;
			}
		
			iCnt=0;
			for( var nRow=0; nRow<ds_saleTyp.rowcount; nRow++ ){
				if(ds_saleTyp.GetColumn(nRow,"SELECT3") == "1"){
					iCnt++;
				}
			}
			if (iCnt == 0) {
				//판매유형을 선택하여주십시요.
				alert(cf_getMessage(MSG_00047, "판매유형을"));
				tab_suplSvcCmms.TabIndex = 2;
				tab_suplSvcCmms.tab_saleInfo.grd_saleTyp.SetFocus();
				return;
			}

			var APLY_STA_DTM = "";
			var APLY_END_DTM = "";
			
			APLY_STA_DTM = div_search.cal_aplyStaDtm.Value+Right("0"+div_search.edt_hour.Text,2)+Right("0"+div_search.edt_min.Text,2);
			APLY_END_DTM = div_search.cal_aplyEndDtm.Value+Right("0"+div_search.edt_endHour.Text,2)+Right("0"+div_search.edt_endMin.Text,2);
			ds_suplSvcCmms.SetColumn(0,"APLY_STA_DTM",APLY_STA_DTM);
			ds_suplSvcCmms.SetColumn(0,"APLY_END_DTM",APLY_END_DTM);
			ds_suplSvcCmms.SetColumn(0,"POL_YM",div_search.cal_polYm.Value);
			//alert(ds_condition.GetColumn(0,"SPOL_ID"));
			//alert(ds_condition.GetColumn(0,"POL_TS"));
			ds_suplSvcCmms.SetColumn(0,"SPOL_ID",ds_condition.GetColumn(0,"SPOL_ID"));
			ds_suplSvcCmms.SetColumn(0,"POL_TS",ds_condition.GetColumn(0,"POL_TS"));


			var sSvcID = "svcGetSuplSvc";
			var sInDs = " ds_suplSvcCmms=ds_suplSvcCmms ";      //부가상품수수료 기본정보
				sInDs += " ds_orgInfo=ds_orgInfo ";              //조직정보
				sInDs += " ds_slNet=ds_slNet ";                  //영업망
				sInDs += " ds_dsNet=ds_dsNet ";                  //유통망
				sInDs += " ds_aplyModel=ds_aplyModel ";		     //적용모델
				sInDs += " ds_saleTyp=ds_saleTyp ";              //판매유형
				sInDs += " ds_payInfo=ds_payInfo ";              //지급정보 
			var sOutDs  = " ds_suplSvc=ds_suplSvc ";		     //지급정보 부가서비스
			var sArg = "sktst.pol.ASP#getSuplSvc";
			
			cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
			
			
	
	}
	
}

function tab_suplSvcCmms_tab_payInfo_grd_payInfo_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	tab_suplSvcCmms.tab_payInfo.grd_payInfo.ToolTipText = ds_payInfo.GetColumn(nRow,"SUPL_SVC_NM") + " : " + ds_payInfo.GetColumn(nRow,"POL_NM");	
	
}

function df_searchSet(obj)
{
		MOD_YMD     = div_search.cal_aplyStaDtm.Value+div_search.edt_hour.Text+div_search.edt_min.Text;
		MOD_YMD_END = div_search.cal_aplyEndDtm.Value+div_search.edt_endHour.Text+div_search.edt_endMin.Text;

		var sArg  = " SPOL_ID="+ quote(ds_condition.getColumn(0,"SPOL_ID"));
			sArg += " POL_YM=" + quote(ds_condition.getColumn(0,"POL_YM"));
			sArg += " POL_TS=" + quote(ds_condition.getColumn(0,"POL_TS"));
			sArg += " APLY_STA_DTM=" + quote(MOD_YMD);
			sArg += " APLY_END_DTM=" + quote(MOD_YMD_END);
			sArg += " LAST_YN=" + quote(ds_condition.getColumn(0,"LAST_YN"));
		gf_OpenWindow( "100000142", sArg); 
	
}



/*******************************************************************************
 * @description    :  선지급, 후지급 클릭시
*******************************************************************************/
function div_search_rdo_bakAply_OnClick(obj)
{
	if (div_search.rdo_bakAply.Value == "N") {
	    div_search.cal_accSchdMth.Enable = false;
	    div_search.btn_accCalendar.Enable = false;
		ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",ds_condition.GetColumn(0,"POL_YM"));
	} else {
	    div_search.cal_accSchdMth.Enable = true;
	    div_search.btn_accCalendar.Enable = true;
		ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",substr(AddMonth(ds_condition.GetColumn(0,"POL_YM")+"01"),0,6));
	}

	
}




function ds_suplSvcCmms_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    if (div_search.rdo_bakAply.Value == "Y") {
		if ( strColumnID == "ACC_SCHD_MTH" ) {
			if(substr(ds_condition.GetColumn(0,"POL_YM"),0,6) >= substr(varNewValue,0,6)) {
						ds_suplSvcCmms.SetColumn(0,"ACC_SCHD_MTH",substr(varOldValue,0,6));
						div_search.cal_accSchdMth.SetFocus();
			
						
						alert("적용년월보다 이후로 선택하십시요.");
						return false;
			}
		}
    }
	
}

]]></Script>
</Window>