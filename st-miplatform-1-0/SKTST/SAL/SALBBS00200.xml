<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="664" Id="SALBBS00200" Left="8" OnLoadCompleted="form_OnLoadCompleted" PidAttrib="7" Title="B2B&#32;상품&#32;판매등록" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_colorList">
				<Contents>
					<colinfo id="COLOR_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="COLOR_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mdl">
				<Contents>
					<colinfo id="PROD_CD" size="255" type="STRING"/>
					<colinfo id="PROD_NM" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_salePlc"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_input">
				<Contents>
					<colinfo id="gnrl_sale_chg_seq" size="256" summ="default" type="STRING"/>
					<colinfo id="prod_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="mfact_id" size="256" summ="default" type="STRING"/>
					<colinfo id="prod_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="prod_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="color_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="mktg_dt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="mov_chk" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_chg_hst_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="hld_plc" size="256" summ="default" type="STRING"/>
					<colinfo id="hld_plc_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_unit_prc" size="256" summ="default" type="STRING"/>
					<colinfo id="max" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="ser_num" size="256" summ="default" type="STRING"/>
					<colinfo id="old_ser_num" size="256" summ="default" type="STRING"/>
					<colinfo id="upd_cnt" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prodCl">
				<Contents>
					<colinfo id="COMM_CD_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_uplst">
				<Contents>
					<colinfo id="EXIT_CASH_PRCHS_PRC" size="15" type="DECIMAL"/>
					<colinfo id="EXIT_CRDT_PRCHS_PRC" size="15" type="DECIMAL"/>
					<colinfo id="EXIT_STRD_SALE_PRC" size="15" type="DECIMAL"/>
					<colinfo id="FIX_CASH_PRCHS_PRC" size="15" type="DECIMAL"/>
					<colinfo id="FIX_CRDT_PRCHS_PRC" size="15" type="DECIMAL"/>
					<colinfo id="FIX_STRD_SALE_PRC" size="15" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mfact">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_stlPlc">
				<Contents>
					<colinfo id="STL_PLC" size="255" summ="default" type="STRING"/>
					<colinfo id="STL_PLC_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="ukey_agency_cd" size="255" summ="default" type="STRING"/>
					<colinfo id="ukey_sub_cd" size="255" summ="default" type="STRING"/>
					<colinfo id="ukey_channel_cd" size="255" summ="default" type="STRING"/>
					<colinfo id="deal_end_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_stop_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_stop_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="out_stop_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="pos_agency" size="256" summ="default" type="STRING"/>
					<colinfo id="pos_agency_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="dis_hld_plc" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cardCorp">
				<Contents>
					<colinfo id="COMM_CD_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oldList">
				<Contents>
					<colinfo id="GNRL_SALE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="GNRL_SALE_CHG_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_CHG_HST_CL" size="255" summ="default" type="STRING"/>
					<colinfo id="PROD_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="COLOR_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="COLOR_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="SER_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="PROD_CL" size="255" summ="default" type="STRING"/>
					<colinfo id="MFACT_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="MFACT_ID_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_QTY" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_UNIT_PRC" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_UKEY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_SUB_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_CHANNEL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="MAX" size="255" summ="default" type="STRING"/>
					<colinfo id="DIS_UPDCNT" size="255" summ="default" type="STRING"/>
					<colinfo id="PROC_FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleMgmtNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_output"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chgrgId">
				<Contents>
					<colinfo id="user_id" size="256" summ="default" type="STRING"/>
					<colinfo id="user_nm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleChgHstCl">
				<Contents>
					<colinfo id="COMM_CD_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_TmpList">
				<Contents>
					<colinfo id="GNRL_SALE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="GNRL_SALE_CHG_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_CHG_HST_CL" size="255" summ="default" type="STRING"/>
					<colinfo id="PROD_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="COLOR_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="COLOR_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="SER_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="PROD_CL" size="255" summ="default" type="STRING"/>
					<colinfo id="MFACT_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="MFACT_ID_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_QTY" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_UNIT_PRC" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_UKEY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_SUB_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="HLD_PLC_CHANNEL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="MAX" size="255" summ="default" type="STRING"/>
					<colinfo id="DIS_UPDCNT" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prodColorList">
				<Contents>
					<colinfo id="COLOR_CD" size="255" type="STRING"/>
					<colinfo id="COLOR_CD_NM" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master">
				<Contents>
					<colinfo id="SALE_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_CHGRG_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_CHG_HST_CL" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_CHG_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_CHG_CHGRG_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC" size="255" summ="default" type="STRING"/>
					<colinfo id="STL_PLC" size="255" summ="default" type="STRING"/>
					<colinfo id="GNRL_SALE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="GNRL_SALE_CHG_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_PLC_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="STL_PLC_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="AGENCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="AGENCY_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="MAX" size="255" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="SETTL_COND" size="256" summ="default" type="STRING"/>
					<colinfo id="DIS_HLD_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_TYP_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_payment" OnColumnChanged="ds_payment_OnColumnChanged">
				<Contents>
					<colinfo id="GNRL_SALE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="GNRL_SALE_CHG_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="CASH_PAY_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_CASH_PAY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_CASH_PAY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDTCRD_CORP1" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_CRDTCRD_CORP1" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDTCRD_PAY_AMT1" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_CRDTCRD_PAY_AMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_CRDTCRD_PAY_AMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDTCRD_PAY_AMT2" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_CRDTCRD_PAY_AMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_CRDTCRD_PAY_AMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDTCRD_CORP2" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_CRDTCRD_CORP2" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDTCRD_PAY_FIX_YN1" size="255" summ="default" type="STRING"/>
					<colinfo id="CRDTCRD_PAY_FIX_YN2" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_DIS_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="DIS_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="CHG_DIS_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_MAR_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="MAR_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="CHG_MAR_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_CMMS_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="CMMS_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="CHG_CMMS_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_VAT_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="CHG_VAT_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="BF_SALE_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="CHG_SALE_AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="SALE_PRC_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PRC_PLC_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inOut200"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_color">
				<Contents>
					<colinfo id="COMM_CD_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnRowPosChanged="ds_list_OnRowPosChanged"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleAmt">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_delList"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_updateYn">
				<Contents>
					<colinfo id="TRMS_YN" size="256" summ="default" type="STRING"/>
					<record>
						<TRMS_YN></TRMS_YN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report2">
				<Contents>
					<colinfo id="SALE_PRC_PLC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UKEY_AGENCY_CD" size="256" summ="default" type="STRING"/>
					<record>
						<SALE_PRC_PLC_NM></SALE_PRC_PLC_NM>
						<UKEY_AGENCY_CD></UKEY_AGENCY_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report3">
				<Contents>
					<colinfo id="MFACT_ID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check">
				<Contents>
					<colinfo id="ser_num" size="256" summ="default" type="STRING"/>
					<colinfo id="prod_cd" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_return">
				<Contents>
					<colinfo id="err_str" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_cancel" ImageID="btn_d_2" Left="952" LeftMargin="5" OnClick="btn_close_OnClick" Style="sty_btn_d" TabOrder="7" Text="닫기" Top="633" Width="60"></Button>
		<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="10" LeftMargin="15" Style="sty_img_tit" TabOrder="1" TabStop="FALSE" Text="판매정보" Top="-127" Width="192"></Image>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_delete" ImageID="btn_d_4" Left="864" LeftMargin="5" OnClick="btn_delete_OnClick" Style="sty_btn_d" TabOrder="6" Text="판매취소" Top="633" Visible="FALSE" Width="86"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_save" ImageID="btn_c_2" Left="801" LeftMargin="5" OnClick="btn_saveMulti_OnClick" Style="sty_btn_c" TabOrder="5" Text="저장" Top="633" Visible="FALSE" Width="60"></Button>
		<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="10" LeftMargin="15" Style="sty_img_tit" TabOrder="4" TabStop="FALSE" Text="수납정보-매출" Top="439" Width="192"></Image>
		<Div Border="Raised" Height="164" Id="div_inputCard" Left="10" Style="sty_div_input" TabOrder="3" Text="Div0" Top="464" Width="1000">
			<Contents>
				<Static Align="Right" Height="20" Id="Static3" Left="-16" Style="sty_lb_Basic" TabOrder="1" Text="현금" Top="7" VAlign="Middle" Width="60"></Static>
				<Static Align="Right" Height="20" Id="Static4" Left="196" Style="sty_lb_Basic" TabOrder="1" Text="신용카드" Top="7" VAlign="Middle" Width="68"></Static>
				<Combo BindDataset="ds_payment" Border="Flat" CodeColumn="COMM_CD_VAL" Column="CRDTCRD_CORP1" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_crdtcrdCorp1" InnerDataset="ds_cardCorp" Left="268" OnChanged="div_inputCard_cmb_crdtCorp1_OnChanged" Style="sty_ipt_form" TabOrder="2" Top="7" Width="92"></Combo>
				<Shape Bottom="35" Height="1" Id="Shape0" Left="-18" LineColor="user9" Right="1006" TabOrder="5" Top="34" Width="1024"></Shape>
				<Static Align="Right" Height="20" Id="Static13" Left="-16" Style="sty_lb_Basic" TabOrder="4" Text="비고" Top="42" VAlign="Middle" Width="60"></Static>
				<TextArea BindDataset="ds_master" Border="Flat" Column="RMKS" Height="85" Id="txt_rmks" ImeMode="none" Left="18" Style="sty_ipt_form" TabOrder="6" Top="65" VScroll="TRUE" Width="548"></TextArea>
				<Static Height="20" Id="Static15" Left="157" TabOrder="6" Text="원" Top="7" VAlign="Middle" Width="16"></Static>
				<Static Align="Right" Height="20" Id="Static0" Left="468" Style="sty_lb_Basic" TabOrder="7" Text="신용카드2" Top="7" VAlign="Middle" Visible="FALSE" Width="16"></Static>
				<Combo BindDataset="ds_payment" Border="Flat" CodeColumn="COMM_CD_VAL" Column="CRDTCRD_CORP2" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_crdtcrdCorp2" InnerDataset="ds_cardCorp" Left="484" OnChanged="div_inputCard_cmb_crdtCorp2_OnChanged" Style="sty_ipt_form" TabOrder="4" Top="7" Visible="FALSE" Width="16"></Combo>
				<Static Height="20" Id="Static1" Left="432" TabOrder="9" Text="원" Top="7" VAlign="Middle" Width="16"></Static>
				<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CRDTCRD_PAY_AMT2" DisableColor="#373c4a" Height="22" Id="msk_crdtCrdPayAmt2" Left="496" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="5" Top="8" Value="0" Visible="FALSE" Width="12"></MaskEdit>
				<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CRDTCRD_PAY_AMT1" DisableColor="#373c4a" Height="19" Id="msk_crdtCrdPayAmt1" Left="360" LeftMargin="2" Mask="0" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="8" Value="0" Width="69"></MaskEdit>
				<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CASH_PAY_AMT" DisableColor="#373c4a" Height="19" Id="msk_cashPayAmt" Left="48" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="1" Top="8" Value="0" Width="108"></MaskEdit>
				<Static Align="Right" Height="20" Id="Static5" Left="508" Style="sty_lb_Basic" TabOrder="15" Text="매출처" Top="7" VAlign="Middle" Width="62"></Static>
				<Edit BindDataset="ds_payment" Border="Flat" Column="SALE_PRC_PLC_NM" Height="21" Id="edt_salePrcPlcNm" Left="572" LeftMargin="2" OnKeyDown="div_input_edt_salePrcPlcNm_OnKeyDown" OnKillFocus="div_input_edt_salePrcPlcNm_OnCharChanged" RightMargin="2" Style="sty_ipt_form" TabOrder="16" Top="7" Width="199"></Edit>
				<Button Height="21" Id="btn_salePlc" ImageID="btn_i_detail" Left="771" OnClick="div_input_btn_salePrcPlc_OnClick" TabOrder="17" Text="Button0" Top="7" Width="19"></Button>
				<Edit BindDataset="ds_payment" Border="Flat" Column="UKEY_AGENCY_CD" Enable="FALSE" Height="20" Id="edt_salePrcPlcUkeyCd" Left="903" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="15" TabStop="FALSE" Top="31" Visible="FALSE" Width="10"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PRC_PLC_SUB_CD" Enable="FALSE" Height="20" Id="edt_salePrcPlcSubCd" Left="916" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="18" TabStop="FALSE" Top="31" Visible="FALSE" Width="10"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PRC_PLC_CHANNEL_CD" Enable="FALSE" Height="20" Id="edt_salePrcPlcChannelCd" Left="928" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="19" TabStop="FALSE" Top="31" Visible="FALSE" Width="10"></Edit>
				<Edit BindDataset="ds_payment" Border="Flat" Column="SALE_PRC_PLC" Height="20" Id="edt_salePrcPlc" Left="940" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="14" TabStop="FALSE" Top="31" Visible="FALSE" Width="48"></Edit>
				<Grid AutoFit="TRUE" BindDataset="ds_file" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="150" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="22" Height="85" Id="grd_file" InputPanel="FALSE" Left="572" LineColor="user33" MinWidth="100" OnCellClick="div_inputCard_grd_file_OnCellClick" Right="964" RowHeight="21" Style="sty_Grid" TabOrder="22" TabStop="true" Top="65" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="392">
					<contents>
						<format id="Default">
							<columns>
								<col width="55"/>
								<col width="347"/>
								<col width="71"/>
							</columns>
							<head>
								<cell bkcolor="user34" col="0" color="user35" display="text" text="번호"/>
								<cell bkcolor="user34" col="1" color="user35" display="text" text="파일명"/>
								<cell bkcolor="user34" col="2" color="user35" display="text" text="크기"/>
							</head>
							<body>
								<cell align="center" col="0" display="text" expr="row+1"/>
								<cell col="1" colid="FILE_NM" cursor="expr:decode(FILE_PASS,null,&apos;arrow&apos;,&apos;hand&apos;)" display="text"/>
								<cell align="center" col="2" colid="FILE_SIZE" display="text"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_allDown" ImageID="btn_a_6" Left="854" LeftMargin="5" OnClick="btn_allDown_OnClick" Style="sty_btn_b" TabOrder="23" Text="전체다운로드" Top="42" Width="134"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_selectAttatchFiles" ImageID="btn_i_detail" Left="970" OnClick="div_inputCard_btn_selectAttatchFiles_OnClick" TabOrder="24" ToolTipText="첨부파일선택" Top="64" Width="20"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_delRow" ImageID="btn_i_subtract_w" Left="970" OnClick="div_inputCard_btn_delRow_OnClick" TabOrder="25" Text="Button1" ToolTipText="추가된&#32;행삭제" Top="88" Width="20"></Button>
				<Static Align="Right" Height="20" Id="Static7" Left="410" Style="sty_lb_Basic" TabOrder="21" Text="첨부파일" Top="42" VAlign="Middle" Width="212"></Static>
				<Checkbox BindDataset="ds_master" Column="SALE_TYP_CD" Height="20" Id="chk_saleTypCd" Left="852" LeftMargin="5" OnClick="div_conInfo5_chk_agnDdctYn_OnClick" Style="sty_opt_search" TabOrder="26" Text="Ecophone4u&#32;판매" Top="7" Width="131"></Checkbox>
			</Contents>
		</Div>
		<Div Border="Raised" Height="64" Id="div_input" Left="10" Style="sty_div_input" TabOrder="2" Text="Div0" Top="10" Width="1000">
			<Contents>
				<Static Align="Right" Height="20" Id="Static3" Left="31" Style="sty_lb_Basic" TabOrder="1" Text="판매일자" Top="7" VAlign="Middle" Width="60"></Static>
				<Image Height="20" Id="Image7" ImageID="bul_mand" Left="25" TabOrder="1" TabStop="FALSE" Top="7" Transparent="TRUE" Width="20"></Image>
				<Static Align="Right" Height="20" Id="Static0" Left="30" Style="sty_lb_Basic" TabOrder="3" Text="변경일자" Top="30" VAlign="Middle" Width="60"></Static>
				<Image Height="20" Id="Image0" ImageID="bul_mand" Left="25" TabOrder="2" TabStop="FALSE" Top="30" Transparent="TRUE" Width="20"></Image>
				<Calendar Border="Flat" ButtonImageID="btn_i_calendar" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_saleChgDtm" Left="95" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" OnCharChanged="div_input_cal_saleChgDtm_OnCharChanged" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="6" TodayColor="user26" Top="30" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="93"></Calendar>
				<Edit Align="CENTER" Border="Flat" Font="굴림,-1" Height="20" Id="edt_saleChgDtmHH" Left="189" MaxLength="2" Number="TRUE" OnCharChanged="div_input_edt_saleChgDtmHH_OnCharChanged" OnKillFocus="div_input_edt_saleChgDtmHH_OnKillFocus" Style="sty_ipt_search" TabOrder="7" Top="30" Width="30"></Edit>
				<Edit Align="CENTER" Border="Flat" Font="굴림,-1" Height="20" Id="edt_saleChgDtmMM" Left="220" MaxLength="2" Number="TRUE" OnCharChanged="div_input_edt_saleChgDtmMM_OnCharChanged" OnKillFocus="div_input_edt_saleChgDtmMM_OnKillFocus" Style="sty_ipt_search" TabOrder="8" Top="30" Width="30"></Edit>
				<Edit Align="CENTER" Border="Flat" Font="굴림,-1" Height="20" Id="edt_saleDtmMM" Left="220" MaxLength="2" Number="TRUE" OnCharChanged="div_input_edt_saleDtmMM_OnCharChanged" OnKillFocus="div_input_edt_saleDtmMM_OnKillFocus" Style="sty_ipt_search" TabOrder="5" Top="7" Width="30"></Edit>
				<Edit Align="CENTER" Border="Flat" Font="굴림,-1" Height="20" Id="edt_saleDtmHH" Left="189" MaxLength="2" Number="TRUE" OnCharChanged="div_input_edt_saleDtmHH_OnCharChanged" OnKillFocus="div_input_edt_saleDtmHH_OnKillFocus" Style="sty_ipt_search" TabOrder="4" Top="7" Width="30"></Edit>
				<Calendar Border="Flat" ButtonImageID="btn_i_calendar" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_saleDtm" Left="95" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" OnCharChanged="div_input_cal_saleDtm_OnCharChanged" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="3" TodayColor="user26" Top="7" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="93"></Calendar>
				<Image Height="20" Id="Image1" ImageID="bul_mand" Left="313" TabOrder="11" TabStop="FALSE" Top="31" Transparent="TRUE" Width="20"></Image>
				<Combo BindDataset="ds_master" Border="Flat" CodeColumn="user_id" Column="SALE_CHGRG_ID" DataColumn="user_nm" Editable="TRUE" Height="20" Id="cmb_saleChgrgId" InnerDataset="ds_chgrgId" Left="396" Search="FILTERED" Style="sty_ipt_form" TabOrder="13" Top="28" Width="176"></Combo>
				<Static Align="Right" Height="20" Id="Static1" Left="325" Style="sty_lb_Basic" TabOrder="13" Text="판매담당자" Top="31" VAlign="Middle" Width="68"></Static>
				<Static Align="Right" Height="20" Id="Static2" Left="606" Style="sty_lb_Basic" TabOrder="14" Text="판매처" Top="7" VAlign="Middle" Width="76"></Static>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PLC_NM" Height="20" Id="edt_salePlcNm" Left="684" LeftMargin="2" OnCharChanged="div_input_edt_salePlcNm_OnCharChanged" OnKeyDown="div_input_edt_salePlcNm_OnKeyDown" OnKillFocus="div_input_edt_salePlcNm_OnKillFocus" RightMargin="2" Style="sty_ipt_form" TabOrder="15" Top="7" Width="104"></Edit>
				<Button Height="21" Id="btn_salePlc" ImageID="btn_i_detail" Left="787" OnClick="div_input_btn_salePlc_OnClick" TabOrder="16" Text="Button0" Top="7" Width="19"></Button>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PLC_UKEY_CD" Enable="FALSE" Height="20" Id="edt_salePlcUkeyCd" Left="807" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="14" TabStop="FALSE" Top="7" Visible="FALSE" Width="56"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="STL_PLC_SUB_CD" Enable="FALSE" Height="20" Id="edt_salePlcSubCd" Left="864" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="17" TabStop="FALSE" Top="7" Visible="FALSE" Width="56"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PLC_CHANNEL_CD" Enable="FALSE" Height="20" Id="edt_salePlcChannelCd" Left="921" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="18" TabStop="FALSE" Top="7" Visible="FALSE" Width="56"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PLC" Height="20" Id="edt_salePlc" Left="975" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="12" TabStop="FALSE" Top="7" Visible="FALSE" Width="11"></Edit>
				<Static Align="Right" Height="20" Id="Static5" Left="334" Style="sty_lb_Basic" TabOrder="21" Text="팀" Top="6" VAlign="Middle" Width="60"></Static>
				<Edit BindDataset="ds_master" Border="Flat" Column="AGENCY_CD_NM" Height="20" Id="edt_agencyCdNm" Left="397" MaxLength="10" OnCharChanged="div_input_edt_agencyCdNm_OnCharChanged" OnKeyDown="div_input_edt_agencyCdNm_OnKeyDown" Style="sty_ipt_form" TabOrder="9" Top="6" UpperOnly="TRUE" Width="86"></Edit>
				<Button BindDataset="ds_DlvFee" Cursor="HAND" Height="20" Id="btn_agency" ImageID="btn_i_detail_b" Left="482" OnClick="div_input_btn_agency_OnClick" TabOrder="10" Text="Button0" Top="6" Width="20"></Button>
				<Edit BindDataset="ds_master" Border="Flat" Column="AG_UKEY_AGENCY_CD" Enable="FALSE" Height="20" Id="edt_agencyUkeyCd" Left="501" MaxLength="10" Style="sty_ipt_form" TabOrder="19" TabStop="FALSE" Top="6" UpperOnly="TRUE" Visible="FALSE" Width="68"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="AGENCY_CD" Height="20" Id="edt_agencyCd" Left="571" MaxLength="10" Style="sty_ipt_form" TabOrder="20" TabStop="FALSE" Top="6" UpperOnly="TRUE" Visible="FALSE" Width="8"></Edit>
				<Image Height="20" Id="Image2" ImageID="bul_mand" Left="629" TabOrder="20" TabStop="FALSE" Top="7" Transparent="TRUE" Width="20"></Image>
				<Image Height="20" Id="Image3" ImageID="bul_mand" Left="368" TabOrder="21" TabStop="FALSE" Top="7" Transparent="TRUE" Width="20"></Image>
				<Edit BindDataset="ds_master" Border="Flat" Column="STL_PLC_NM" Enable="FALSE" Height="20" Id="edt_stlPlcNm" Left="684" LeftMargin="2" OnKeyDown="div_search_edt_payPlcNm_OnKeyDown" RightMargin="2" Style="sty_ipt_form" TabOrder="30" TabStop="FALSE" Top="30" Visible="FALSE" Width="11"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="SALE_PLC_UKEY_CD" Enable="FALSE" Height="20" Id="edt_stlPlcUkeyCd" Left="694" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="29" TabStop="FALSE" Top="30" Visible="FALSE" Width="11"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="STL_PLC_SUB_CD" Enable="FALSE" Height="20" Id="edt_stlPlcSubCd" Left="704" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="31" TabStop="FALSE" Top="30" Visible="FALSE" Width="11"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="STL_PLC_CHANNEL_CD" Enable="FALSE" Height="20" Id="edt_stlPlcChannelCd" Left="714" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="32" TabStop="FALSE" Top="30" Visible="FALSE" Width="11"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="STL_PLC" Height="20" Id="edt_stlPlc" Left="724" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="28" TabStop="FALSE" Top="30" Visible="FALSE" Width="11"></Edit>
				<Edit BindDataset="ds_master" Border="Flat" Column="DIS_HLD_PLC" Height="20" Id="edt_disHldPlc" Left="734" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="34" TabStop="FALSE" Top="30" Visible="FALSE" Width="11"></Edit>
				<Static Align="Right" Height="20" Id="Static4" Left="606" Style="sty_lb_Basic" TabOrder="33" Text="정산처" Top="30" VAlign="Middle" Visible="FALSE" Width="76"></Static>
			</Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_list" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="432" ColSizing="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="320" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user33" MinWidth="100" OnChar="grd_list_OnChar" OnEnterDown="grd_list_OnEnterDown" OnExpandUp="grd_list_OnExpandUp" OnHeadClick="cf_markGridSort" Right="1008" RowHeight="21" Style="sty_Grid" TabOrder="8" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="1000">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="63"/>
						<col width="58"/>
						<col width="89"/>
						<col width="89"/>
						<col width="73"/>
						<col width="79"/>
						<col width="63"/>
						<col width="94"/>
						<col width="81"/>
						<col width="64"/>
						<col width="73"/>
						<col width="64"/>
						<col width="64"/>
						<col width="64"/>
						<col width="0"/>
						<col width="0"/>
						<col width="110"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" text="번호"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" text="구분"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" text="상품구분"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" text="상품일련번호"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" text="일련번호"/>
						<cell bkcolor="user34" col="5" color="user35" display="text" text="제조사"/>
						<cell bkcolor="user34" col="6" color="user35" display="text" text="모델"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" text="색상"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" text="보유처"/>
						<cell bkcolor="user34" col="9" color="user35" display="text" text="상담관리번호"/>
						<cell bkcolor="user34" col="10" color="user35" display="text" text="판매수량"/>
						<cell bkcolor="user34" col="11" color="user35" display="text" text="고정가여부"/>
						<cell bkcolor="user34" col="12" color="user35" display="text" text="*&#32;판매원가"/>
						<cell bkcolor="user34" col="13" color="user35" display="text" text="*&#32;판매수수료"/>
						<cell bkcolor="user34" col="14" color="user35" display="text" text="*&#32;판매마진"/>
						<cell bkcolor="user34" col="15" color="user35" display="text" text="*&#32;판매단가"/>
						<cell bkcolor="user34" col="16" color="user35" display="text" text="*&#32;부가세"/>
						<cell bkcolor="user34" col="17" color="user35" display="text" text="판매가(VAT포함)"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row+1"/>
						<cell align="center" col="1" colid="sale_chg_hst_cl" combocol="COMM_CD_VAL" combodataset="ds_saleChgHstCl" combotext="COMM_CD_VAL_NM" display="combo"/>
						<cell col="2" colid="PROD_CL" combocol="COMM_CD_VAL" combodataset="ds_prodCl" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:iif((sale_chg_hst_cl&#32;==&#32;&apos;01&apos;),&#32;&apos;combo&apos;,&#32;&apos;none&apos;)"/>
						<cell col="3" colid="SER_NUM" display="text" edit='expr:iif(sale_chg_hst_cl&#32;==&#32;&apos;01&apos;&#32;&amp;&amp;&#32;(prod_cl&#32;==&#32;&apos;1&apos;&#32;||&#32;prod_cl&#32;==&#32;&apos;2&apos;&#32;||&#32;prod_cl&#32;==&#32;&apos;&apos;),&#32;&quot;normal&quot;,&#32;&quot;none&quot;)'/>
						<cell col="4" colid="OLD_SER_NUM" display="text"/>
						<cell col="5" colid="MFACT_id" combocol="code" combodataset="ds_mfact" combotext="value" display="combo" expandimage="btn_i_detail_b"/>
						<cell align="center" col="6" colid="PROD_NM" display="text" expandimage="btn_i_detail_b"/>
						<cell align="center" col="7" colid="COLOR_CD" combocol="COMM_CD_VAL" combodataset="ds_color" combofilter="expr:f_getColorFilter()" combotext="COMM_CD_VAL_NM" display="combo"/>
						<cell align="center" col="8" colid="HLD_PLC_NM" display="text"/>
						<cell col="9" colid="CON_MGMT_NO" display="text"/>
						<cell align="right" col="10" colid="SALE_QTY" display="number" limit="8"/>
						<cell align="center" col="11" colid="SPLST_YN" display="text"/>
						<cell align="right" col="12" colid="SALE_PRC" display="number" limit="8"/>
						<cell align="right" col="13" colid="SALE_CMMS" display="number" limit="8"/>
						<cell align="right" col="14" colid="SALE_MAR" display="number" limit="8"/>
						<cell align="right" col="15" colid="SALE_UNIT_PRC" display="number" limit="8"/>
						<cell align="right" col="16" colid="SALE_VAT_PRC" display="number" limit="8"/>
						<cell align="right" col="17" colid="SALE_AMT" display="number"/>
					</body>
					<summary>
						<cell bkcolor="user37" col="0" color="user38" display="text"/>
						<cell bkcolor="user37" col="1" color="user38" display="text"/>
						<cell bkcolor="user37" col="2" color="user38" display="text"/>
						<cell bkcolor="user37" col="3" color="user38" display="text"/>
						<cell bkcolor="user37" col="4" color="user38" display="text"/>
						<cell bkcolor="user37" col="5" color="user38" display="text"/>
						<cell bkcolor="user37" col="6" color="user38" display="text"/>
						<cell align="right" bkcolor="user37" col="7" color="user38" display="text" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="8" color="user38" display="text" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="9" color="user38" display="text" font="돋움,10,Bold" text="합계"/>
						<cell align="right" bkcolor="user37" col="10" color="user38" display="number" expr='SUM(&quot;SALE_QTY&quot;)'/>
						<cell align="right" bkcolor="user37" col="11" color="user38" display="text" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="12" color="user38" display="number" expr='SUM(&quot;SALE_PRC&quot;)'/>
						<cell align="right" bkcolor="user37" col="13" color="user38" display="number" expr='SUM(&quot;SALE_CMMS&quot;)'/>
						<cell align="right" bkcolor="user37" col="14" color="user38" display="number" expr='SUM(&quot;SALE_MAR&quot;)'/>
						<cell align="right" bkcolor="user37" col="15" color="user38" display="number" expr='SUM(&quot;SALE_UNIT_PRC&quot;)'/>
						<cell align="right" bkcolor="user37" col="16" color="user38" display="number" expr='SUM(&quot;SALE_VAT_PRC&quot;)'/>
						<cell align="right" bkcolor="user37" col="17" color="user38" display="number" expr='SUM(&quot;SALE_AMT&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Div Height="21" Id="div_fuc" Left="816" TabOrder="9" Text="Div2" Top="84" Width="192">
			<Contents>
				<Button Cursor="HAND" Height="21" Id="btn_excel" ImageID="btn_i_exceldown_w" Left="69" OnClick="div_fuc_btn_excel_OnClick" TabOrder="1" Text="Button1" ToolTipText="Excel&#32;Download" Top="1" Width="19"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_subtract" ImageID="btn_i_subtract_w" Left="36" OnClick="div_fuc_btn_subtract_OnClick" TabOrder="2" Text="Button1" ToolTipText="추가된&#32;행삭제" Width="19"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_add" ImageID="btn_i_add_w" Left="17" OnClick="div_fuc_btn_add_OnClick" TabOrder="3" Text="Button1" ToolTipText="행추가" Visible="FALSE" Width="19"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_excelUp" ImageID="btn_i_excelup_w" Left="88" OnClick="div_fuc_btn_excelUp_OnClick" TabOrder="4" Text="Button1" ToolTipText="Excel&#32;Upload" Top="1" Width="19"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_inProd" ImageID="btn_b_6" Left="122" OnClick="div_fuc_btn_inProd_OnClick" Style="sty_btn_b" TabOrder="5" Text="재고선택" Top="1" Width="70"></Button>
			</Contents>
		</Div>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="DIS_AMT" DisableColor="#373c4a" Height="19" Id="msk_DisAmt" Left="456" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="10" Top="437" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CMMS_AMT" DisableColor="#373c4a" Height="19" Id="msk_CmmsAmt" Left="568" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="11" Top="437" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="MAR_AMT" DisableColor="#373c4a" Height="19" Id="msk_MarAmt" Left="680" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="12" Top="437" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="VAT_AMT" DisableColor="#373c4a" Height="19" Id="msk_VatAmt" Left="792" LeftMargin="2" Mask="0" RightMargin="2" Style="sty_ipt_form" TabOrder="13" Top="437" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="SALE_AMT" DisableColor="#373c4a" Height="19" Id="msk_SaleAmt" Left="904" LeftMargin="2" Mask="0" RightMargin="2" Style="sty_ipt_form" TabOrder="14" Top="437" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CHG_DIS_AMT" DisableColor="#373c4a" Height="19" Id="msk_ChgDisAmt" Left="456" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="15" Top="453" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CHG_CMMS_AMT" DisableColor="#373c4a" Height="19" Id="msk_ChgCmmsAmt" Left="568" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="11" Top="453" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CHG_MAR_AMT" DisableColor="#373c4a" Height="19" Id="msk_ChgMarAmt" Left="680" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="12" Top="453" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CHG_VAT_AMT" DisableColor="#373c4a" Height="19" Id="msk_ChgVatAmt" Left="792" LeftMargin="2" Mask="0" RightMargin="2" Style="sty_ipt_form" TabOrder="13" Top="453" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<MaskEdit BindDataset="ds_payment" Border="Flat" Column="CHG_SALE_AMT" DisableColor="#373c4a" Height="19" Id="msk_ChgSaleAmt" Left="904" LeftMargin="2" Mask="0" RightMargin="2" Style="sty_ipt_form" TabOrder="14" Top="453" Value="0" Visible="FALSE" Width="108"></MaskEdit>
		<Report Bottom="698" Height="27" Id="Report0" Left="15" Right="629" Top="671" Visible="FALSE" Width="614"></Report>
		<Report Bottom="731" Height="27" Id="Report1" Left="16" Right="630" Top="704" Visible="FALSE" Width="614"></Report>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="25" Id="btn_barPrn" ImageID="btn_e_6" Left="688" LeftMargin="17" OnClick="f_print" Style="sty_btn_e" TabOrder="22" Text="인수증&#32;출력" Top="633" Width="109"></Button>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID : SALBBS00200
* 업무명      : B2B-상품판매등록
* 프로그램명  : 상품판매등록
--------------------------------------------------------------------------------
* 작성자      : 전희경
* 작성일      : 20011.10.10
--------------------------------------------------------------------------------
* 1. 변경이력
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

//==============================================================================
// 공통 스크립트 로딩
//==============================================================================
#include "lib::lib_commF.js"
#include "lib::lib_commMsg.js"
#include "lib::lib_commPopup.js"
#include "lib::lib_global.js"
#include "lib::lib_util.js"
#include "lib::lib_SAL.js"


//==============================================================================
// 폼 변수 정의
//==============================================================================
var FV_STR_NAME; // 사용자 이름
//var job = "MDO";

var FV_JOB;		// NEW
//var FV_STATUS;	// NEW, SUBSTRACT, SEARCH
var FV_GNRL_SALE_NO;			// 일반판매관리번호
var FV_GNRL_SALE_CHG_SEQ;		// 일반판매변경번호
var FV_SALE_CHGRG_ID;			// 판매담당자

var FV_BAR_TYPE_CURR_ROW_INDEX = 0;
var	FV_PROD_STA_LEN;
var	FV_PROD_LEN_NUM;
var	FV_COLOR_STA_LEN;
var	FV_COLOR_LEN_NUM;
var	FV_SER_NUM_STA_LEN;
var FV_SER_NUM_LEN_NUM;

var FV_PROD_CD;
var FV_COLOR_CD;
var FV_SER_NUM;
var FV_DIS_CONFIRM_YN = false;  // 재고출고가능 확인 여부 
var FV_UPL_CONFIRM_YN;
var FV_DELETE = false;			// 삭제 여부 
//var FV_SALE_TYP_CD = "01";		//판매유형(01:B2B,02:B2C(지점),03:B2C(On-Line)

// 글로벌 세션정보
var FV_USER_ID;	// 사용자ID
var FV_USER_NM;		// 사용자명

var	FV_ORG_ID;				// 소속 
var	FV_ORG_NM;				// 소속명
var	FV_ORG_CL;				// 소속구분
var	FV_AGENCY_ID;           // 소속 팀 ID
var	FV_AGENCY_NM;           // 소속 팀 명
var	FV_AGENCY_UKEY_ID;      // 소속 팀 UKEY ID	

var	FV_DUTY;					// 사용자 직책
var	FV_ORG_AREA_CL1;			// 근무지 구분	
var	FV_ORG_AREA_ID;				// 근무지 ID
var	FV_ORG_AREA_NM;				// 근무지명
var	FV_ORG_AREA_POS_AGENCY_CD;	// 근무지 
var	FV_ORG_AREA_UKEY_ID;     // 근무지ukeyid
var	FV_ORG_AREA_SUB_CD;      // 근무지subcd
var	FV_ORG_AREA_CHANNEL_CD;  // 근무지 channelcd	
var	FV_USER_GRP;			 // 유저그룹

var FV_TRMS_YN;
var FV_SAVE_DEL_DISABLE; 	// 저장/삭제 불가일 경우 01: 신용카드 확정일자

/*******************************************************************************
 * @description    : 최초 폼 로드시 발생 - 이벤트
*******************************************************************************/
function form_OnLoadCompleted(obj)
{
	cf_setAuth(pFrmNum);	// 권한 공통
	cf_setGrdChecknSortEvent(grd_list);	// 그리드 정렬
	
	f_init();
}


/*******************************************************************************
 * @description    : 공통 닫기 함수
*******************************************************************************/
function df_close()
{
	this.Close();
}

/*******************************************************************************
 * @description    : 콜백
 * @param sSvcID   : 서비스 아이디
*******************************************************************************/
function f_callBack(sSvcID)
{

	switch(sSvcID)
	{
	case "svcList":	// 조회
		if(ds_list.GetRowCount() >0)
		{

			div_fuc.btn_add.Enable = false;
			btn_barPrn.Enable = true;
			FV_JOB = "MOD";
			
			sf_enable("div_input.edt_agencyCdNm,div_input.btn_agency", false);	// 팀 
			sf_enable("div_input.edt_salePlcNm,div_input.btn_salePlc", false);	// 팀 
			sf_enable("div_input.cal_saleDtm,div_input.edt_saleDtmHH,div_input.edt_saleDtmMM", false);	//  판매일자
			sf_enable("div_input.cal_saleChgDtm,div_input.edt_saleChgDtmHH,div_input.edt_saleChgDtmMM", true);	// 변경일자
			sf_setDate("div_input.cal_saleChgDtm","div_input.edt_saleChgDtmHH","div_input.edt_saleChgDtmMM");
			
			var sMax         = ds_master.GetColumn(0, "GNRL_SALE_CHG_SEQ");
			var sSaleDtm     = ds_master.GetColumn(0, "SALE_DTM");
			var sSaleChgrgId = ds_master.GetColumn(0, "SALE_CHGRG_ID");
			var sGnrlSaleNo  = ds_master.GetColumn(0, "GNRL_SALE_NO");
			var sGnrlSaleChgSeq  = ds_master.GetColumn(0, "GNRL_SALE_CHG_SEQ");
			//var sSalePrcPlc  = ds_master.GetColumn(0,"SALE_PRC_PLC");
			//var sSalePrcPlcNm  = ds_master.GetColumn(0,"SALE_PRC_PLC_NM");
			
		
			// Card Info
			var sCrdtCorp1        = ds_payment.GetColumn(0,"CRDTCRD_CORP1");
			var sCrdtCorp2        = ds_payment.GetColumn(0,"CRDTCRD_CORP2");
			var sCrdtCrdPayFixYn1 = ds_payment.GetColumn(0,"CRDTCRD_PAY_FIX_YN1");
			var sCrdtCrdPayFixYn2 = ds_payment.GetColumn(0,"CRDTCRD_PAY_FIX_YN2");
			
			
			//ds_payment.SetColumn(0,"SALE_PRC_PLC",sSalePrcPlc);
			//ds_payment.SetColumn(0,"SALE_PRC_PLC_NM",sSalePrcPlcNm);

			// 카드사
			if(uf_isNull(sCrdtCorp1) == true)
			{
				div_inputCard.cmb_crdtcrdCorp1.Index = -1;
			}
			if(uf_isNull(sCrdtCorp2) == true)
			{
				div_inputCard.cmb_crdtcrdCorp2.Index = -1;
			}
			
			if(ToUpper(sCrdtCrdPayFixYn1) == "Y" || ToUpper(sCrdtCrdPayFixYn2) == "Y" )
			{	// 카드 확정시 수정 불가
				// MSG_00142 = "신용카드 정산 확정건으로 수정 불가능합니다.";
				alert(cf_getMessage(MSG_00142, "신용카드"));	
				grd_list.Editable = false;
				grd_list.Enable = false;
				uf_ObjComponentEnable(div_inputCard);
				//uf_ObjComponentEnable(div_fuc);
				FV_SAVE_DEL_DISABLE = "01";
				//btn_save.Enable = false;
				//btn_delete.Enable = false;
			}

			// 신용카드 선택하지 않았을 경우 인덱스가 변경되므로 노멀처리
			ds_payment.ApplyChange();	
			
			FV_GNRL_SALE_NO  	  = sGnrlSaleNo;
			FV_GNRL_SALE_CHG_SEQ  = sGnrlSaleChgSeq;
			FV_SALE_CHGRG_ID      = sSaleChgrgId; 
			
			div_input.cal_saleDtm.Value  = SubStr(sSaleDtm, 0,8);
			div_input.edt_saleDtmHH.Text = SubStr(sSaleDtm, 8,2);
			div_input.edt_saleDtmMM.Text = SubStr(sSaleDtm, 10,2);	
			
			f_getChgrgIdList();
			div_input.cmb_saleChgrgId.Value = sSaleChgrgId;		
			
			//판매가산출
			
			// 전미량 f_setSaleAmt(sSaleDtm); 

			grd_list_OnCellClick(grd_list,0);
			f_setButton();
			f_setAttachScreen();
		}
		else
		{	// 조회 건수가 없을 경우 
			FV_JOB = "NEW";
			FV_GNRL_SALE_NO = "";
			div_fuc.btn_add.Enable = true;
			
		}
		break;
	
	case "svcMdlList":	// 모델

		break;
	case "svcChrgrIdList":
		// TEST용 담당자지정
		if(ds_chgrgId.rowcount == 0) {
			ds_chgrgId.AddRow();
			ds_chgrgId.SetColumn(0, "USER_ID", FV_USER_ID);
			ds_chgrgId.SetColumn(0, "USER_NM", FV_USER_NM);
		}
		break;
	case "svcColorList":	// 상품색상리스트
		f_setFilterProdColor();
		//cmb_colorCd_OnChanged();
		break;
	
	case "svcAllColorList":
		ds_colorList.insertRow(0);			
		ds_colorList.SetColumn(0, "COLOR_CD" , "");
		ds_colorList.SetColumn(0, "COLOR_NM", "선택");
		break;

	case "svcStlPlc":	//  정산처
		if(ds_stlPlc.GetRowCount() > 0)
		{
			var sStlPlc     = ds_stlPlc.GetColumn(0,"STL_PLC");
			var sStlPlcNm   = ds_stlPlc.GetColumn(0,"STL_PLC_NM");	
			var sUkeyCd     = ds_stlPlc.GetColumn(0,"ukey_agency_cd");
			var sSubCd      = ds_stlPlc.GetColumn(0,"ukey_sub_cd");	
			var sChannelCd  = ds_stlPlc.GetColumn(0,"ukey_channel_cd");	
			var sDealEndYn  = ds_stlPlc.GetColumn(0,"deal_end_yn");		// 거래종료여부
			var sSaleStopYn = ds_stlPlc.GetColumn(0,"sale_stop_yn");	// 판매정지여부     
			var sDisHldPlc  = ds_stlPlc.GetColumn(0,"dis_hld_plc");	
	
			if (sDealEndYn == 'N' && sSaleStopYn == 'N')
			{	// 판매가능한 상태
				btn_save.Enable = true;		
			}
			else
			{	// 판매 불가 상태
			}

			div_input.edt_disHldPlc.Text        = sDisHldPlc;
			div_input.edt_stlPlc.Text           = sStlPlc;
			div_input.edt_stlPlcNm.Text         = sStlPlcNm;
			div_input.edt_stlPlcUkeyCd.Text     = sUkeyCd;
			div_input.edt_stlPlcSubCd.Text      = sSubCd;
			div_input.edt_stlPlcChannelCd.Text  = sChannelCd;
		}
		break;

	case "svcSave":	// 저장
		http.Sync = true;
		
		var sErrCode = ds_saleMgmtNo.GetColumn(0, "errcode");
		if(sErrCode == "F")
		{
			alert(ds_saleMgmtNo.GetColumn(0, "errmsg"));
			return;
		}
		FV_JOB = "MOD";
		ds_mdl.DeleteAll();
		ds_colorList.DeleteAll();
		
		//f_list();	// 재조회
		if(IsValid(Parent.div_search.edt_agencyCd) == true) {
			if(Parent.div_search.edt_agencyCd.Text !=
				div_input.edt_agencyCd.Text) {
				
				Parent.div_search.edt_agencyCdNm.Text = div_input.edt_agencyCdNm.Text;
				http.Sync = true;
				Parent.div_search_btn_agency_OnClick();
				http.Sync = false;
			}
		}
		Parent.btn_searchList_OnClick();
		ds_list.ApplyChange();
		Close();
		
		http.Sync = false;
		
		break;
		
	case "svcDelete":	// 삭제
		if(IsValid(Parent.div_search.edt_agencyCd) == true) {
			if(Parent.div_search.edt_agencyCd.Text !=
				div_input.edt_agencyCd.Text) {
				
				Parent.div_search.edt_agencyCdNm.Text = div_input.edt_agencyCdNm.Text;
				http.Sync = true;
				Parent.div_search_btn_agency_OnClick();
				http.Sync = false;
			}
		}
		Parent.btn_searchList_OnClick();
		
		ds_list.ApplyChange();
		Close();
		break;
	case "getSalesAmt":
		
		break;
	
	
	case "getDisProdList":
		var nRow = ds_list.currow;

        if (ds_output.rowcount > 0)
        {
			
			if(ds_output.rowcount > 1)
			{
				//단말기 일련번호에 해당하는 모델이 2개 이상이면 popup창에서 선택할수 있게 한다.
				sf_salDupProdPop(nRow, "ds_list","ds_output", "f_validProd(" +nRow+ ")");
				return;
			}
             
			if(ds_output.rowcount == 1)
			{
				if ( Left(ds_output.GetColumn(0,"errcode"),1) == "F" )
				{
					
					alert(ds_output.GetColumn(0,"errmsg"));
					div_input.msk_saleUnitPrc = 0;
					ds_list.SetColumn(nRow, "DIS_COMFIRM_YN" , "0");
					
					FV_DIS_CONFIRM_YN = false;
					return;
				}
			
				// 전체 색상(그리드 클릭시 필터링 적용되어 있어 무관할듯)
				ds_colorList.UnFilter();
				
				// 이벤트 제거 : 모델구분,제조사,모델,색상 변경시 항목 클리어가 되기때문에 일단 미적용
				ds_list.onColumnChanged = "";
				
				
				ds_list.SetColumn(nRow, "MFACT_ID"    , ds_output.GetColumn(0,"MFACT_ID"));
				ds_list.SetColumn(nRow, "MFACT_ID_NM" , ds_output.GetColumn(0,"MFACT_ID_NM"));
				ds_list.SetColumn(nRow, "PROD_CL"     , ds_output.GetColumn(0,"PROD_CL"));
				ds_list.SetColumn(nRow, "PROD_CD"     , ds_output.GetColumn(0,"PROD_CD"));
				ds_list.SetColumn(nRow, "PROD_NM"     , ds_output.GetColumn(0,"PROD_NM"));
				ds_list.SetColumn(nRow, "COLOR_CD"    , ds_output.GetColumn(0,"COLOR_CD"));
				ds_list.SetColumn(nRow, "COLOR_CD_NM" , ds_output.GetColumn(0,"COLOR_CD_NM"));
				
				ds_list.SetColumn(nRow, "dis_updcnt" , ds_output.GetColumn(0,"dis_upd_cnt"));
				
				
				// 이벤트 살리기
				ds_list.onColumnChanged = "ds_list_OnColumnChanged";
				
				FV_DIS_CONFIRM_YN = true;

				f_calculateSaleAMT(nRow);
				
				ds_list.SetColumn(nRow, "DIS_COMFIRM_YN" , "1");
			}
             
		}
        else
        {
            alert("일련번호에 해당하는 상품 정보가 없습니다.");
            grd_list.SetFocus();
    		FV_DIS_CONFIRM_YN = false;
    		ds_list.SetColumn(nRow, "DIS_COMFIRM_YN" , "0");
        }			
		break;

	case "svcChrgrIdList":
		cf_setInitDataForCmb(div_input.cmb_saleChgrgId, "선택");
		break;
	
	case "svcCardCorpList":
		ds_cardCorp.InsertRow(0);
		ds_cardCorp.SetColumn(0, "deal_co_cd", "");
		ds_CardCorp.SetColumn(0, "deal_co_nm", "선택");
		div_inputCard.cmb_crdtcrdCorp1.Index = 0;
		div_inputCard.cmb_crdtcrdCorp2.Index = 0;
		break;
	
	case "svnUpdateYn":

		if((FV_TRMS_YN == 'N' )&&(ds_updateYn.GetColumn(0,"TRMS_YN") == 'Y')) {
			alert('타 시스템에 의해 데이터가 변경되었습니다. 재조회 후 저장하세요');
			btn_save.Enable = false;
			btn_delete.Enable = false;
			return;
		}
		
		if(Confirm( "저장하시겠습니까?" ) == false) return;

		ds_master.SetColumn(0, "FLAG", FV_JOB);
	//	ds_master.SetColumn(0, "SALE_TYP_CD", FV_SALE_TYP_CD);
		if (div_inputCard.chk_saleTypCd.Value == "0") {
			ds_master.SetColumn(0, "SALE_TYP_CD", "01");
		} else {
			ds_master.SetColumn(0, "SALE_TYP_CD", "03");
		}
		ds_master.SetColumn(0, "DIS_HLD_PLC", ds_master.GetColumn(0, "SALE_PLC"));
		ds_master.SetColumn(0, "SETTL_COND", "C");		//* 단말기결제조건(A-할부, C-현금(일시불))
	
		if(FV_JOB == "NEW")
		{	// 신규모드
			ds_master.SetColumn(0, "SALE_DTM"    , f_getDate("NEW"));
			ds_master.SetColumn(0, "SALE_CHG_DTM", f_getDate("NEW"));
		}
		else
		{	// 수정모드 
			var sMax = ds_master.GetColumn(0, "GNRL_SALE_CHG_SEQ");
			
			var sSaleChgChgrgId = div_input.cmb_saleChgrgId.Value;
			
			ds_master.SetColumn(0, "SALE_CHGRG_ID", FV_SALE_CHGRG_ID);
			ds_master.SetColumn(0, "SALE_CHG_CHGRG_ID", sSaleChgChgrgId);
	
			ds_master.SetColumn(0, "SALE_DTM"    , f_getDate("NEW"));
			ds_master.SetColumn(0, "SALE_CHG_DTM", f_getDate("MOD"));		
		}
	
		// 마스터 테이블 정보 셋팅
		
		// 일반판매정보
		ds_master.SetColumn(0, "GNRL_SALE_NO", uf_null2space(FV_GNRL_SALE_NO));
		ds_master.SetColumn(0, "GNRL_SALE_CHG_SEQ", uf_null2space(FV_GNRL_SALE_CHG_SEQ));

		// 트랜잭션 설정
		var sSvcID = "svcSave";
		var sInDs  = "itemList=ds_list master=ds_master payment=ds_payment delItemList=ds_delList nc_fileDs=ds_file:U";
		var sOutDs = "ds_saleMgmtNo=List";
		var sArg   = "sktst.sal.BBS#saveSaleList";
		
		// 공통 트랜잭션 호출
		cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
		
	case "initUpdateYn" :
		FV_TRMS_YN = 'N';
	
		if(ds_list.GetRowCount() > 0){
			if(ds_updateYn.GetColumn(0,"TRMS_YN") == 'Y') {
				FV_TRMS_YN = 'Y';
				div_fuc.btn_subtract.Visible = false;
				div_inputCard.btn_salePlc.Enable = false;
				div_inputCard.edt_salePrcPlcNm.Enable = false;
				div_inputCard.msk_cashPayAmt.Enable = false;
				btn_delete.Enable = true;
			}else{
				div_fuc.btn_subtract.Visible = true;
				div_inputCard.btn_salePlc.Enable = true;
				div_inputCard.edt_salePrcPlcNm.Enable = true;
				div_inputCard.msk_cashPayAmt.Enable = true;
				btn_delete.Enable = true;
			}
		}else{
			div_fuc.btn_subtract.Visible = true;
			div_inputCard.btn_salePlc.Enable = true;
			div_inputCard.edt_salePrcPlcNm.Enable = true;
			div_inputCard.msk_cashPayAmt.Enable = true;
			btn_delete.Enable = false;
			
		}
		
		ds_master.SetColumn(0, "TRMS_YN", FV_TRMS_YN);
	
	default:
		break;

	}
}
/*******************************************************************************
 공통 스크립트 영역 끝
*******************************************************************************/


//#############################################################################
// 서비스
//#############################################################################

/*******************************************************************************
 * @description    : 재고 가용여부 트랜젝션
*******************************************************************************/
function f_getDisTransaction(sSvcID, sArg)
{

	var nRow     = ds_list.currow;
	var nLength  = f_getLengthSerNum();	// 일련번호 길이 
	var sSaleDtm = div_input.cal_saleDtm.Value;
	var sSalePlc = div_input.edt_salePlc.Text;
	
	var sProdCl  = ds_list.GetColumn(nRow, "PROD_CL");
	var sSerNum  = ds_list.GetColumn(nRow, "SER_NUM");
	var sProdCd  = ds_list.GetColumn(nRow, "PROD_CD");
	var sColorCd = ds_list.GetColumn(nRow, "COLOR_CD");
	var sSaleQty = ds_list.GetColumn(nRow, "SALE_QTY");
	var sDisHldPlc = ds_master.GetColumn(0, "DIS_HLD_PLC");

//	sSerNum = Lpad(sSerNum, "0", nLength);
 
	// 입력상품 중복 체크
	if (f_searchSaleDtlTypChk() == false) return;
	
	cf_setParam(ds_input, "sale_dtm"  , sSaleDtm);  //판매일시
	cf_setParam(ds_input, "ser_num"   , sSerNum);   //일련번호

	cf_setParam(ds_input, "sale_plc"  , sDisHldPlc); 	//보유처
	cf_setParam(ds_input, "prod_cl"   , sProdCl);   //상품구분
	cf_setParam(ds_input, "prod_cd"   , sProdCd);	//상품코드
	cf_setParam(ds_input, "color_cd"  , sColorCd);	//상품색상코드
	cf_setParam(ds_input, "sale_qty"  , sSaleQty);	//상품판매수량

	var sInDs  = "nc_input_fieldDs=ds_input";
	var sOutDs = "ds_output=DisProdList";

	http.Sync = true;
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
	http.Sync = false;
	return FV_DIS_CONFIRM_YN;
}

/*******************************************************************************
 * @description    : 재고 정보 취득
*******************************************************************************/
function f_getDisPordList()
{
	if(uf_isNull(div_input.edt_salePlc.Text) == true)
	{
		alert(cf_getMessage(MSG_00083, "판매처"));
		div_input.edt_salePlcNm.SetFocus();
		return false;
	}

	var sSvcID = "getDisProdList";
	var sArg   = "sktst.sal.SCO#getDisProdList";	
	
	return f_getDisTransaction(sSvcID,sArg);
}


/*******************************************************************************
 * @description    :  색상정보 취득
*******************************************************************************/
function f_getColorList()
{
	ds_input.Clear();	

	// 트랜잭션 설정
	var sSvcID = "svcAllColorList";
	var sInDs  = "nc_input_fieldDs=ds_input";
	var sOutDs = "ds_colorList=List";
	var sArg   = "sktst.sal.SCO#getColorList"; 
	
	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
}

/*******************************************************************************
 * @description    : 제조사 리스트 조회
*******************************************************************************/
function f_getMfact()
{
    // 입력 파라메터 셋팅
    ds_input.Clear();
    ds_mfact.ClearData();
    cf_setParam(ds_input, "deal_co_cl", "20"); 
    
	// 트랜잭션 설정
	var sSvcID = "ds_mfact";
	var sInDs  = "nc_input_fieldDs=ds_input";
	var sOutDs = "ds_mfact=DealCoList";
	var sArg   = "sktst.dis.DCO#getDealCoList";
	
	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
}

/*******************************************************************************
 * @description    :  상품 모델 취득
*******************************************************************************/
function f_prodColorList(nRow)
{
	var sMdlCd   = ds_list.GetColumn(nRow, "PROD_CD");
		
	sf_prodColorList( "ds_input", "ds_prodColorList", sMdlCd);
}


/*******************************************************************************
 * @description    :  운용단가표 취득
*******************************************************************************/
function f_uplst()
{
//	if(FV_STATUS == "CHANGE_POS") return;
	
	var nRow      = ds_list.currow;
	var sMdlCd    = ds_list.GetColumn(nRow, "PROD_CD");
	var sSaleDtm    = div_input.cal_saleDtm.Value
	                + div_input.edt_saleDtmHH.Text
	                + div_input.edt_saleDtmMM.Text;	

//trace("f_uplst( " + sMdlCd + "/" + sSaleDtm +" )");	

	http.Sync = true;
	sf_getUplst( "ds_input", "ds_uplst", sMdlCd, sSaleDtm);
	http.Sync = false;
	
	return FV_UPL_CONFIRM_YN;
}


/*******************************************************************************
 * @description    :  데이터 리스트 취득
*******************************************************************************/
function f_list()
{
//	FV_STATUS = "SEARCH";
	ds_input.Clear();
		
	cf_setParam(ds_input, "GNRL_SALE_NO", FV_GNRL_SALE_NO);	// 판매관리번호

	// 트랜잭션 설정
	var sSvcID = "svcList";
	var sInDs  = "nc_input_fieldDs=ds_input";
	var sOutDs = "ds_list=ds_itemList ds_master=ds_master ds_payment=ds_payment ds_report1=ds_report1";
	var sArg   = "sktst.sal.BBS#getSaleDtlList";
	
	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
}


/*******************************************************************************
 * @description    :  정산처 취득
*******************************************************************************/
function f_getStlPlc()
{
	var sPlc     = div_input.edt_salePlc.Text;
	var sSaleDtm = f_getDate("NEW");

	if( uf_isNull(sPlc) == true) 
	{
		return;
	}

	if( uf_isNull(sSaleDtm) == true) return;
	
	ds_input.Clear();	

	sf_getStlPlc( "ds_input", "ds_stlPlc", sPlc, sSaleDtm );
	
}


//#############################################################################
// 함수 
//#############################################################################


/*******************************************************************************
 * @description    :  최초 로딩시
*******************************************************************************/
function f_init() 
{
	div_input.cal_saleDtm.OnChanged = "";
	div_input.cal_saleChgDtm.OnChanged = "";

	http.Sync = true;
	ds_master.AddRow();
	ds_payment.AddRow();
	
	// 디폴트: 오늘날짜 설정
	f_setDefaultDate();	
	f_setCombo();

	f_setAuth();
	
	if(IsExistVar("gnrlSaleNo", true) == true)
	{
		FV_GNRL_SALE_NO = gnrlSaleNo;
	}
	
	if(uf_isNull(FV_GNRL_SALE_NO) == true)
	{
		FV_JOB = "NEW";
		f_initPayment();
		sf_enable("div_input.cal_saleChgDtm,div_input.edt_saleChgDtmHH,div_input.edt_saleChgDtmMM",false);
		
		btn_delete.Enable = false;
	}
	else
	{
		sf_enable("div_input.cal_saleDtm,div_input.edt_saleDtmHH,div_input.edt_saleDtmMM",false);
		//div_fuc.btn_subtract.Visible = false;
		div_fuc.btn_inProd.Visible = false;
		div_fuc.btn_excelUp.Visible = false;
		
		f_list();	// 검색
	}
	// 수정모드일경우 변경일자 오늘날짜 설정
	f_setDefaultDate();	
	
	if(IsExistVar("gnrl_sale_no", true) == true)
	{
		FV_GNRL_SALE_NO                     = gnrl_sale_no;
		FV_GNRL_SALE_CHG_SEQ                = gnrl_sale_chg_seq;
		
		div_input.cal_saleDtm.Value         = gnrl_sale_dt;
		div_input.edt_saleDtmHH.Text        = gnrl_sale_hh;
		div_input.edt_saleDtmMM.Text        = gnrl_sale_mm;
		div_input.edt_salePlcNm.Text        = gnrl_sale_nm;
		div_input.edt_salePlc.Text        = gnrl_sale_plc;
		div_input.edt_salePlcUkeyCd.Text    = gnrl_sale_ukey_cd;
		div_input.edt_salePlcSubCd.Text     = gnrl_sale_sub_cd;
		div_input.edt_salePlcChannelCd.Text = gnrl_sale_channel;	
		
		f_getChgrgIdList();
		div_input.cmb_saleChgrgId.Value    = gnrl_sale_chgrg_id;	
		if(uf_getAuthCode() == 2)
		{
			div_input.cmb_saleChgrgId.Enable = false;
		}

		f_getStlPlc();
		
		div_input.edt_agencyCd.Text     = ds_stlPlc.GetColumn(0,"pos_agency");
		div_input.edt_agencyCdNm.Text   = ds_stlPlc.GetColumn(0,"pos_agency_nm");
		div_input.edt_agencyUkeyCd.Text = ds_stlPlc.GetColumn(0,"ukey_agency_cd");

		sf_enable("div_input.edt_agencyCdNm,div_input.btn_agency", false);	// 팀 
		sf_enable("div_input.edt_salePlcNm,div_input.btn_salePlc", false);	// 팀 
		sf_enable("div_input.cal_saleDtm,div_input.edt_saleDtmHH,div_input.edt_saleDtmMM", false);	//  판매일자
		sf_enable("div_input.cal_saleChgDtm,div_input.edt_saleChgDtmHH,div_input.edt_saleChgDtmMM", false);	// 변경일자

	}

	http.Sync = false;
	
	div_input.cal_saleDtm.OnCharChanged  = "div_input_cal_saleDtm_OnCharChanged";
	div_input.cal_saleChgDtm.OnCharChanged  = "div_input_cal_saleChgDtm_OnCharChanged";
	
}

/*******************************************************************************
 * @description    : 글로벌 섹션 정보
*******************************************************************************/
function f_getSession()
{
	FV_USER_ID        = gds_session.GetColumn(0, "loginid");	// 사용자ID
	FV_USER_NM        = gds_session.GetColumn(0, "usernm");		// 사용자명

	FV_ORG_ID         = gds_session.GetColumn(0, "orgid");				// 소속 
	FV_ORG_NM         = gds_session.GetColumn(0, "orgnm");				// 소속명
	FV_ORG_CL         = gds_session.GetColumn(0, "orgcl");				// 소속구분
	FV_AGENCY_ID      = gds_session.GetColumn(0, "posAgencyId");        // 소속 팀 ID
	FV_AGENCY_NM      = gds_session.GetColumn(0, "posAgencyNm");        // 소속 팀 명
	FV_AGENCY_UKEY_ID = gds_session.GetColumn(0, "posAgencyUkeyId");    // 소속 팀 UKEY ID	
	
	FV_ORG_AREA_ID            = gds_session.GetColumn(0, "orgareaid");			// 근무지 ID
	FV_ORG_AREA_NM            = gds_session.GetColumn(0, "orgareanm");			// 근무지명
	FV_ORG_AREA_POS_AGENCY_CD = gds_session.GetColumn(0, "orgareaposagencycd");	// 근무지 
	FV_ORG_AREA_UKEY_ID       = gds_session.GetColumn(0, "orgareaukeyid");      // 근무지ukeyid
	FV_ORG_AREA_SUB_CD        = gds_session.GetColumn(0, "orgareaukeysubcd");   // 근무지subcd
	FV_ORG_AREA_CHANNEL_CD    = gds_session.GetColumn(0, "orgareaukeychannelcd");  // 근무지 channelcd	
	FV_USER_GRP               = gds_session.GetColumn(0, "usergrp");			// 유저그룹
	FV_ORG_AREA_CL1           = gds_session.GetColumn(0, "orgareacl1");			// 근무지 구분
	FV_DUTY                   = gds_session.GetColumn(0, "duty");	   		    // 직책
	
}




/*******************************************************************************
 * @description    : 권한 설정
*******************************************************************************/
function f_setAuth()
{
	f_getSession();
	
	// 팀  화면권한 설정
	//uf_enableAgencyByAuth("div_input", "edt_agencyCdNm,edt_agencyCd,btn_agency", "edt_agencyUkeyCd");
	//uf_enableDealByAuth("div_input", "edt_salePlcNm,edt_salePlc,btn_salePlc", "edt_salePlcUkeyCd,edt_salePlcSubCd,edt_salePlcChannelCd");

	f_getStlPlc();	// 소매일경우 정산처
	//alert('f_setAuth');
	//f_getChgrgIdList();		
	//uf_enableChgrgByAuth(div_input.cmb_saleChgrgId);	
}



/*******************************************************************************
 * @description    :  콤보박스 셋팅
*******************************************************************************/
function f_setCombo()
{

	cf_setCommonCodeDsEnv();
	cf_setCommonCode("ds_prodCl"       , "ZBAS_C_00010", "선택");	// 상품구분
	cf_setCommonCode("ds_saleChgHstCl" , "ZSAL_C_00110");	// 판매 변경이력 구분
	cf_setCommonCode("ds_cardCorp", "ZBAS_C_00050", "선택");   // 신용카드사
	cf_setCommonCode("ds_color",  "ZBAS_C_00040");		// 색상선택
	cf_checkCommonCode(); 
	
	f_getMfact();		// 제조사정보
	//f_getCardCorp();		
	
	//cf_setInitDataForCmb(div_input.cmb_saleChgrgId, "선택");
}

/*******************************************************************************
 * @description    :  Card사 취득
*******************************************************************************/
function f_getCardCorp()
{
	var sSaleDtm = div_input.cal_saleDtm.Value;
	sf_getCardCorpList("ds_input", "ds_cardCorp", sSaleDtm );
}

/*******************************************************************************
 * @description    :  판매담당자 취득
*******************************************************************************/
function f_getChgrgIdList()
{
	
	var sSalePlc = div_input.edt_salePlc.Text;

	http.Sync = true;
	// 공통 트랜잭션 호출
	sf_getChgrgIdList("ds_input", "ds_chgrgId", sSalePlc);	// 근무지
	http.Sync = false;
}


/*******************************************************************************
 * @description    :  판매금액 계산
*******************************************************************************/
function f_calculateSaleAMT(nRow)
{
	var sSaleQty    = ds_list.GetColumn(nRow, "SALE_QTY");
	var sSaleUntPrc = ds_list.GetColumn(nRow, "SALE_UNIT_PRC");
	var sSaleVatPrc = ds_list.GetColumn(nRow, "SALE_VAT_PRC");
	var nSaleAmt = 0;
	var nSaleVatPrc = 0;
	
	var nSaleQty    = Iif(uf_isNull(sSaleQty) == true, 0, ParseInt(sSaleQty));
	var nSaleUntPrc = Iif(uf_isNull(sSaleUntPrc) == true, 0, ParseInt(sSaleUntPrc));
	var nSaleVatPrc = Iif(uf_isNull(sSaleVatPrc) == true, 0, ParseInt(sSaleVatPrc));
	
	nSaleAmt = nSaleQty*nSaleUntPrc;
	nSaleVatPrc = nSaleAmt*0.1;

	ds_list.SetColumn(nRow, "SALE_VAT_PRC", nSaleVatPrc);
	ds_list.SetColumn(nRow, "SALE_AMT", (nSaleAmt+nSaleVatPrc));
}


/*******************************************************************************
 * @description    :  총 판매금액
*******************************************************************************/
function f_getSaleTotal()
{
	var sSaleTotalAmt   = grd_list.GetCellText("Summ", 0, 17);
	var nSaleTotalAmt   = toNumber(replace(sSaleTotalAmt,",", ""));
	
	var sSaleDisAmt   = grd_list.GetCellText("Summ", 0, 12);
	var nSaleDisAmt   = toNumber(replace(sSaleDisAmt,",", ""));
	
	var sSaleCmmsAmt   	= grd_list.GetCellText("Summ", 0, 13);
	var nSaleCmmsAmt   	= toNumber(replace(sSaleCmmsAmt,",", ""));
	
	var sSaleMarmt   	= grd_list.GetCellText("Summ", 0, 14);
	var nSaleMarmt   	= toNumber(replace(sSaleMarmt,",", ""));
		
	var sSaleVatAmt   	= grd_list.GetCellText("Summ", 0, 16);
	var nSaleVatAmt   	= toNumber(replace(sSaleVatAmt,",", ""));

	ds_payment.SetColumn(0, "DIS_AMT", nSaleDisAmt);
	ds_payment.SetColumn(0, "CMMS_AMT", nSaleCmmsAmt);
	ds_payment.SetColumn(0, "MAR_AMT", nSaleMarmt);
	ds_payment.SetColumn(0, "VAT_AMT", nSaleVatAmt);
	ds_payment.SetColumn(0, "SALE_AMT", nSaleTotalAmt);
	
	return nSaleTotalAmt;
}


/*******************************************************************************
 * @description    :  저장시 수납정보 유효성 검사
*******************************************************************************/
function f_validPayment()
{
	var sCashPayAmt     = div_inputCard.msk_cashPayAmt.Value;
	var sCrdtCrdPayAmt1 = div_inputCard.msk_crdtCrdPayAmt1.Value;
	var sCrdtCrdPayAmt2 = div_inputCard.msk_crdtCrdPayAmt2.Value;
	
	var nCashPayAmt     = Iif(sCashPayAmt == "", 0 , ParseInt(sCashPayAmt));
	var nCrdtCrdPayAmt1 = Iif(sCrdtCrdPayAmt1 == "", 0, ParseInt(sCrdtCrdPayAmt1));
	var nCrdtCrdPayAmt2 = Iif(sCrdtCrdPayAmt2 == "", 0, ParseInt(sCrdtCrdPayAmt2));
	var nSaleTotalAmt   = f_getSaleTotal();
	
	// 신용카드 입력하고 금액 입력 안했을 경우
	if(uf_isNull(div_inputCard.cmb_crdtcrdCorp1.Value) == false
		&& uf_isNull(sCrdtCrdPayAmt1) == false && sCrdtCrdPayAmt1  == "0")
	{
			alert(cf_getMessage(MSG_00083, "신용카드1 금액"));
			div_inputCard.msk_crdtCrdPayAmt1.SetFocus();
			return false;	
	}
	
	// 신용카드 입력 안하고 금액 입력 했을 경우
	if(uf_isNull(div_inputCard.cmb_crdtcrdCorp1.Value) == true
		&& uf_isNull(sCrdtCrdPayAmt1) == false && sCrdtCrdPayAmt1  != "0")
	{
			alert(cf_getMessage(MSG_00083, "신용카드사1"));
			div_inputCard.cmb_crdtcrdCorp1.SetFocus();
			return false;			

	}	
	
	// 신용카드 입력하고 금액 입력 안했을 경우
	if(uf_isNull(div_inputCard.cmb_crdtcrdCorp2.Value) == false
		&& uf_isNull(sCrdtCrdPayAmt2) == false && sCrdtCrdPayAmt2  == "0")
	{
			alert(cf_getMessage(MSG_00083, "신용카드2 금액"));
			div_inputCard.msk_crdtCrdPayAmt2.SetFocus();
			return false;	
	}
	
	// 신용카드 입력 안하고 금액 입력 했을 경우
	if(uf_isNull(div_inputCard.cmb_crdtcrdCorp2.Value) == true
		&& uf_isNull(sCrdtCrdPayAmt2) == false && sCrdtCrdPayAmt2  != "0")
	{
			alert(cf_getMessage(MSG_00083, "신용카드사2"));
			div_inputCard.cmb_crdtcrdCorp2.SetFocus();
			return false;			

	}		
// alert("nSaleTotalAmt="+nSaleTotalAmt+" nCashPayAmt="+nCashPayAmt
		// +" nCrdtCrdPayAmt1="+nCrdtCrdPayAmt1
		// +" nCrdtCrdPayAmt2="+nCrdtCrdPayAmt2);
	if(nSaleTotalAmt != (nCashPayAmt + nCrdtCrdPayAmt1 + nCrdtCrdPayAmt2))
	{
		alert("판매가 총합계와 수납금액이 일치하지 않습니다.");
		return false;
	}
	return true;
}

/*******************************************************************************
 * @description    :  저장 가능 여부 
*******************************************************************************/
function f_validSavePosbility()
{
	//판매일마감 'Y'인 경우 수정불가
	if(ds_master.GetColumn(0, "dt_cls_yn") == "Y") {
		alert("일마감완료된 건으로 수정불가!!");
		return false;
	}
	
	if( uf_isNull(FV_SAVE_DEL_DISABLE) == false)
	{
		if(FV_SAVE_DEL_DISABLE == "01")
		{
			alert(cf_getMessage(MSG_00142, "신용카드"));
			return false;
		}
	}
	return true;
}

/*******************************************************************************
 * @description    :  마스터 정보 유효성 검사
*******************************************************************************/
function f_validDate()
{
//trace("f_validDate()");
	// 마스터 정보 유효성 검사
	var sSaleDtm    = substr(f_getDate("NEW"),0,12);
	var sSaleChgDtm = substr(f_getDate("MOD"),0,12);
	
	
	// 판매일자 체크 
	if(uf_isNull(sSaleDtm) == true)
	{
		alert(cf_getMessage(MSG_00083, "판매일자"));
		div_input.cal_saleDtm.SetFocus();
		return false;	
	}

	if(uf_CheckDate( sSaleDtm ,"YYYYMMDDHH24MI")== false)
	{	// MSG_00061: 입력 오류입니다. 입력 정보를 확인 하십시오 
		alert(cf_getMessage(MSG_00061, "판매일자"));
		return false;
	}
	
	var sNowDate = substr(getDate(), 0, 12);
	var bRetDate = sf_compare(sSaleDtm, sNowDate);

	if( bRetDate == -1)
	{	// MSG_00094 : 이전 날짜만 입력이 가능합니다.
		alert(cf_getMessage(MSG_00094, "판매일자;현재날짜"));
		div_input.cal_saleDtm.SetFocus();
		return false;
	}
	
	// 판매변경일자 체크 
	if(FV_JOB == "MOD")
	{
		// 판매일자 체크 
		if(uf_isNull(sSaleChgDtm) == true)
		{
			alert(cf_getMessage(MSG_00083, "판매변경일자"));
			div_input.cal_saleChgDtm.SetFocus();
			return false;	
		}
	
		if(uf_CheckDate( sSaleChgDtm ,"YYYYMMDDHH24MI")== false)
		{	// MSG_00061: 입력 오류입니다. 입력 정보를 확인 하십시오 
			alert(cf_getMessage(MSG_00061, "판매변경일자"));
			div_input.cal_saleChgDtm.SetFocus();
			return false;
		}
		
		bRetDate = sf_compare(sSaleChgDtm, sNowDate);
		if( bRetDate == -1)
		{	// MSG_00094 : 이전 날짜만 입력이 가능합니다.
			alert(cf_getMessage(MSG_00094, "판매변경일자;현재날짜"));
			div_input.cal_saleDtm.SetFocus();
			return false;
		}
		
		bRetDate = sf_compare(sSaleDtm, sSaleChgDtm);
		if( bRetDate == -1 )
		{	// MSG_00095 : 이후 날짜만 입력이 가능합니다..
			alert(cf_getMessage(MSG_00095, "판매변경일자;판매날짜"));
			div_input.cal_saleDtm.SetFocus();
			return false;
		}
		
	}
	

	
	return true;
}

/*******************************************************************************
 * @description    :  판매 저장시 상품재고 유효성 검사
*******************************************************************************/
function f_validProdDis()
{
	http.Sync = true;
	
	var ret_gb = false;
	
	ds_check.Copy(ds_list);
	
	sf_validProdDisAll("ds_check", "ds_return");
	
	if(ds_return.rowcount > 0){
	
		rmks = ds_return.GetColumn(0,"err_str");
		Dialog("SAL::SALSCO02600.xml", "rmks=" + quote(rmks), 440, 408);

	}else{
	
		ret_gb = true;
	
	}
	
	http.Sync = false;
	
	return ret_gb;
	
}

/*******************************************************************************
 * @description    :  판매 추가시 유효성 검사
*******************************************************************************/
function f_validProd(nRow)
{
	//  데이터 셋 값 변경 이벤트에서 이미 체크를 했을 경우 
	// 변경사항이 없을 경우 
	var sRowType = ds_list.GetRowType(nRow);
	if(sRowType == "normal") return;

	// 마스터 정보 유효성 검사 
	if(f_validDate() == false) return false;
	
	// 그리드 정보 유효성 검사 
	var sProdCl     = ds_list.GetColumn(nRow,"PROD_CL");
	var sSerNum     = ds_list.GetColumn(nRow,"SER_NUM");
	var sSaleQty    = ds_list.GetColumn(nRow,"SALE_QTY");
	var sSeq        = ds_list.GetColumn(nRow,"GNRL_SALE_CHG_SEQ");
	var sMax        = ds_list.GetColumn(nRow,"GNRL_SALE_CHG_SEQ");
	var sSaleQty    = ds_list.GetColumn(nRow,"SALE_QTY");
	var sSaleUnitPrc= ds_list.GetColumn(nRow,"SALE_UNIT_PRC");

	
	var sFields    = "PROD_CL,MFACT_ID,PROD_CD,COLOR_CD";
	var sFieldNms  = "상품구분,제조사,모델,색상";
	var sPosIndex  = "2,5,6,7";

	var arrFields    = Split(sFields  , ",");
	var arrFieldNm   = Split(sFieldNms, ",");	
	var arrPosIndex  = Split(sPosIndex, ",");	
	var nFields      = arrFields.length();
	
	for(var i=0; i<nFields; i++)
	{
		var sValue = ds_list.GetColumn(nRow, arrFields[i]);

		if(uf_isNull(sValue) == true)
		{	// MSG_00083 : 반드시 입력해야 합니다.
			alert(cf_getMessage(MSG_00083, arrFieldNm[i]));
			grd_list_OnCellClick(grd_list,nRow);
			grd_list.SetFocus();
			grd_list.SetCellPos(arrPosIndex[i]);
			return false;
		}
	}
	
	// 일련번호 유효성 체크
	if(f_searchSaleDtlTypChk() == false) return false;

	// 중복등록 상품 체크
	if(f_chkDupDisItem(nRow) == true) return false;

	// 재고상품조회
	//if(f_validModedProd(nRow) == false) return false;
	
	return true;
}


/*******************************************************************************
 * @description    :  판매 추가시 유효성 검사
*******************************************************************************/
function f_chkDupDisItem(nRow)
{
	var nRows    = ds_list.GetRowCount();
	var sProdCl  = ds_list.GetColumn(nRow, "PROD_CL");
	var sSerNum  = ds_list.GetColumn(nRow, "SER_NUM");
	var sMdlCd   = ds_list.GetColumn(nRow, "PROD_CD");
	var sColorCd = ds_list.GetColumn(nRow, "COLOR_CD");
	

	for(var i=0; i < nRows; i++)
	{
		var sSeq     = ds_list.GetColumn(i, "GNRL_SALE_CHG_SEQ");
		var sMax     = ds_list.GetColumn(i, "GNRL_SALE_CHG_SEQ");	
		// 비교대상항목은 제외
		if(nRow == i)    continue;
		if(sMax != sSeq) continue;
		
		var sDsSerNum  = ds_list.GetColumn(i, "SER_NUM");
		var sDsMdlCd   = ds_list.GetColumn(i, "PROD_CD");
		var sDsColorCd = ds_list.GetColumn(i, "COLOR_CD");
		
		if(sProdCl == "1" || sProdCl == "2")
		{	// 단말기
			if( sSerNum == sDsSerNum 
				&& sMdlCd == sDsMdlCd
				&& sColorCd == sDsColorCd)
			{
				alert(cf_getMessage(MSG_00984, "상품"));
				grd_list.SetFocus();
				grd_list.SetCellPos(2);					
				return true;
			}
		}
		
	}

	return false;
}

/*******************************************************************************
 * @description    :  판매팀/처 변경시 리스트 데이터 초기화 여부 확인
*******************************************************************************/
function f_PlcChged() 
{
	var result = true;
	
	if(ds_list.rowcount > 0 && ds_list.GetUpdate() > 0) {
		result = Confirm(MSG_00163);
	}
	
	return result;
}

/*******************************************************************************
 * @description    :  필수항목 체크
*******************************************************************************/
function f_checkDefault()
{   
    if((Length(div_input.cal_saleDtm.Value) < 1)
		|| (Length(div_input.edt_saleDtmHH.text) < 2)
		|| (Length(div_input.edt_saleDtmMM.text) < 2))
	{
		alert(cf_getMessage(MSG_00083, "판매일시"));
		div_input.cal_saleDtm.SetFocus();
		return false;
	}
	if(FV_JOB == "MOD")
	{
		if((Length(div_input.cal_saleChgDtm.Value) < 1)
			|| (Length(div_input.edt_saleChgDtmHH.text) < 2)
			|| (Length(div_input.edt_saleChgDtmMM.text) < 2))
		{
			alert(cf_getMessage(MSG_00083, "변경일시"));
			div_input.cal_saleChgDtm.SetFocus();
			return false;
		}
	}

    if(Length(div_input.edt_agencyCD.Value) < 1)
    {
        alert(cf_getMessage(MSG_00083, "팀"));
        div_input.edt_agencyCdNm.SetFocus();
        return false;
    }
    
    if(Length(div_input.edt_salePlc.Value) < 1)
    {
        alert(cf_getMessage(MSG_00083, "판매처"));
        div_input.edt_salePlcNm.SetFocus();
        return false;
    }

    if(Length(div_input.cmb_saleChgrgId.value) < 1)
    {
        alert(cf_getMessage(MSG_00083, "판매담당자"));
        div_input.cmb_saleChgrgId.SetFocus();
        return false;
    }
   
    return true;
}

function f_setDsGroup()
{
	//판매가 산출
	//f_setSaleAmt(f_getDate("NEW"));
	
	ds_list.row = 0;
    grd_list.SetFocus();
        
    FV_BOOL_OPEN = false;
}


/*******************************************************************************
 * @description    : 판매유형 조회전 validation check
*******************************************************************************/
function f_searchSaleDtlTypChk()
{
	var nRow        = ds_list.currow;
	var sProdCl     = ds_list.GetColumn(nRow,"PROD_CL");
	var sSerNum     = ds_list.GetColumn(nRow,"SER_NUM");

	if(sProdCl == "1" || sProdCl == "2")
	{	// 상품구분에 따라 
		if(uf_isNull(sSerNum) == true)
		{
			alert(cf_getMessage(MSG_00083, "일련번호"));
			grd_list.SetFocus();
			grd_list.SetCellPos(3);	
			return false;				
		}

		var nLength = Length(sSerNum);

	}
	return true;
}



/*******************************************************************************
 * @description    :  수납정보 초기화
*******************************************************************************/
function f_initPayment()
{
	div_inputCard.msk_cashPayAmt.Value       = "0";
	div_inputCard.msk_crdtCrdPayAmt1.Value   = "0";
	div_inputCard.msk_crdtCrdPayAmt2.Value   = "0";
	ds_payment.ApplyChange();
}


/*******************************************************************************
 * @description    :  디폴트 날짜 셋팅
*******************************************************************************/
function f_setDefaultDate()
{
//trace("f_setDefaultDate");
	if(uf_isNull(FV_JOB) == true || FV_JOB == "NEW")
	{	// 신규일 경우 
		sf_setDate("div_input.cal_saleDtm", "div_input.edt_SaleDtmHH", "div_input.edt_SaleDtmMM");
	}
	else
	{	// 수정일 경우 
		sf_setDate("div_input.cal_saleChgDtm", "div_input.edt_SaleChgDtmHH", "div_input.edt_SaleChgDtmMM");
	}
}


/*******************************************************************************
 * @description    :  디폴트 날짜 셋팅
*******************************************************************************/
function f_getDate(sGubun)
{
	var sRetValue = "";
	
	if(sGubun == "NEW")
	{
		sRetValue    = div_input.cal_saleDtm.Value
	                 + div_input.edt_saleDtmHH.Text
	                 + div_input.edt_saleDtmMM.Text + "00";
	}
	else
	{
	     sRetValue = div_input.cal_saleChgDtm.Value
				    + div_input.edt_saleChgDtmHH.Text
				    + div_input.edt_saleChgDtmMM.Text;

		if(uf_isNull(sRetValue) == false)
		{
			sRetValue += "00";
		}
    }
    return sRetValue;
}

/*******************************************************************************
 * @description    :  일련번호 번호 길이
*******************************************************************************/
function f_getLengthSerNum()
{
	var nRet;
	var sProdCl = ds_list.GetColumn(ds_list.currow, "PROD_CL");
	
	if( uf_IsNull(sProdCl) == true) return 0;
	
	if(sProdCl == "1")
	{	// 단말기
		nRet = 7;
	}
	
	return nRet;
}

/*******************************************************************************
 * @description    : 색상 설정
*******************************************************************************/
function f_getColorFilter()
{	
	http.Sync = true;
	
	f_prodColorList(ds_list.currow);
	
	var sCondition = "";
	
	for(var i = 0 ; i < ds_prodColorList.rowcount ; i++)
	{
		
		sCondition = sCondition + "color_cd=='"+ds_prodColorList.GetColumn(i,"color_cd")+"'||";
	}
	
	if(ds_prodColorList.rowcount == 1)
	{
		ds_list.SetColumn(ds_list.currow,"color_cd",ds_prodColorList.GetColumn(0,"color_cd"));
	}
		
	var sFilter = sCondition + "color_cd==''";	
	
	http.Sync = false;
	return sFilter;
}


/*******************************************************************************
 * @description    :  색상리스트에 조회한 상품색상으로 필터한다.
*******************************************************************************/
function f_setFilterProdColor()
{
	var sColorCds = "color_cd=='' || ";
	var iRowCnt   = ds_prodColorList.GetRowCount();

	for(var i = 0 ; i < iRowCnt ; i++ )
	{
		
		if(i>0)
		{
			sColorCds = sColorCds + "||";
		}
		
		sColorCds = sColorCds+ "color_cd==" + quote(ds_prodColorList.GetColumn(i,"color_cd"));
	}
	
	if(iRowCnt == 0)
	{
		ds_colorList.Filter("color_cd=='XXX'");
	}
	else
	{
		ds_colorList.Filter(sColorCds);
	}
//trace( "f_setFilterProdColor : " + sColorCds);
}

/*******************************************************************************
 * @description    : 판매가 계산 - OnChar 이벤트에서 사용
                     (데이터 값은 적용전이기 때문에 strPostText의 값 이용)
*******************************************************************************/
function f_setSaleAmt(sSalesDt)
{
	for(var i=0; i<ds_list.rowcount; i++)
	{
		var sProdCd = ds_list.GetColumn(i, "prod_cd");
		var sDealCoCd = ds_master.GetColumn(0, "sale_plc");
		var sSerNum = ds_list.GetColumn(i, "ser_num");
		
		var nSaleUnitPrc = 0;
		
		http.Sync = true;
		
		sf_getSalesAmt("ds_input", "ds_saleAmt", "01", sDealCoCd, sProdCd, sSerNum, sSalesDt);
		
		http.Sync = false;
		
		if(ds_saleAmt.rowcount > 0) {
			ds_list.SetColumn(i, "sale_prc", ds_saleAmt.GetColumn(0, "SALE_PRC"));
			ds_list.SetColumn(i, "sale_mar", ds_saleAmt.GetColumn(0, "MAR"));
			ds_list.SetColumn(i, "sale_cmms", ds_saleAmt.GetColumn(0, "SALE_CMMS"));
			ds_list.SetColumn(i, "splst_yn", ds_saleAmt.GetColumn(0, "SPLST_YN"));
		}
		
		nSaleUnitPrc = parseInt(ds_list.GetColumn(i, "sale_prc"))
						+parseInt(ds_list.GetColumn(i, "sale_mar"))
						+parseInt(ds_list.GetColumn(i, "sale_cmms"));
		
	
		ds_list.SetColumn(i, "sale_unit_prc", nSaleUnitPrc);
		
		f_calculateSaleAMT(i);
	}
	
	f_getSaleTotal();
}

/*******************************************************************************
 * @description    :  판매 담당자 초기화
*******************************************************************************/
function f_initSaleChgrgId()
{
	ds_chgrgId.DeleteAll();
	cf_setInitDataForCmb(div_input.cmb_saleChgrgId, "선택");
}



/*******************************************************************************
 * @description    :  List 에 변경된 데이터가 있는지 
*******************************************************************************/
function f_isChangeList()
{
	var nRows = ds_list.GetRowCount();
	
	if(ds_list.GetDelRowCount() > 0)
	{
		return true;
	}
	for(var i=0; i<nRows;i++)
	{
		if(sf_checkRowChangeField("ds_master", i) != "")
		{
			return true;
		}	
		
	}
	
	for(var i=0; i<nRows;i++)
	{
		if(sf_checkRowChangeField("ds_file", i) != "")
		{
			return true;
		}	
		
	}
	
	return false;
}


/*******************************************************************************
 * @description    :  상품 변경으로 인해 재확인
*******************************************************************************/
function f_validModedProd(nRow)
{
	var sChangedField = sf_checkRowChangeField("ds_list", nRow);
	var sDisComfirmYn = ds_list.GetColumn(nRow, "dis_comfirm_yn");
	var sProdCl       = ds_list.GetColumn(nRow, "prod_cl");
	var sRowType      = ds_list.GetRowType(nRow);

	// 이미 재고/운용모델단가 확인이 된 건이일 경우
	if(sDisComfirmYn  == "1") return true;	
	
	// 단말기 
	if( (sChangedField.indexOf("PROD_CD") != -1)
	|| (sChangedField.indexOf("SER_NUM") != -1) 
	|| (sRowType == "insert")
	)
	{
		if(f_getDisPordList() == false) return false;
	}				
	
	return true;
}

//#############################################################################
// 이벤트 
//#############################################################################


/*******************************************************************************
 * @description    : 엑셀 출력 - 이벤트
*******************************************************************************/
function div_fuc_btn_excel_OnClick(obj)
{
	// cf_excel(oGrd, nMode)
	// oGrd - 엑셀화할 그리드 객체 , nMode - 엑셀 저장 모드 1 or null : 엑셀로드 , 2 : 파일 저장
	cf_exportExcel(grd_list);
}


/*******************************************************************************
 * @description    : 멀티(추가, 수정, 삭제) 작업 - 이벤트
*******************************************************************************/
function btn_saveMulti_OnClick(obj)
{
	if(!f_checkDefault())
    {
        return;
    }
    	
	if((ds_list.RowCount() == 0) 
		|| (f_isChangeList() == false && ds_payment.GetUpdate() == false && ds_file.GetUpdate() == false))
	{
		alert(cf_getMessage(MSG_00071,""));
		
		return;
	}

	if( f_validSavePosbility() == false) return;
	
	var nRow = ds_list.currow;
	
	var sSaleChgrgId = div_input.cmb_saleChgrgId.Value;
	
	if(f_validPayment() == false) return;
	
	// 저장시점의 상품재고 체크
	if(FV_JOB == "NEW")
	{
		if(f_validProdDis() == false)  return;
	}

	// 트랜잭션 설정
	var sSvcID = "svnUpdateYn";
	var sInDs  = "nc_input_fieldDs=ds_master";
	var sOutDs = "ds_updateYn=ds_updateYn";
	var sArg   = "sktst.sal.BBS#getUpdateYn";
	
	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	
}


/*******************************************************************************
 * @description    :  삭제 버튼 클릭 이벤트
*******************************************************************************/
function btn_delete_OnClick(obj)
{
	var bFinded = false;
	var nRows = ds_list.GetRowCount();
	var nDelRows = ds_delList.GetRowCount();

	if( f_validSavePosbility() == false) return;

	for(var i=0; i < nRows; i++)
	{
		var sMax  = ds_list.getColumn(i, "GNRL_SALE_CHG_SEQ");
		if(uf_isNull(sMax) == false)
		{
			bFinded = true;
			break;
		}
	}
	
	if(nRows > 0){
		if(bFinded != true)
		{	// 삭제 가능한 로우가 존재할 경우
			alert(cf_getMessage(MSG_00071,""));
			return;	
		}
	}
		
	if(Confirm("전체 판매건을 취소하시겠습니까?") == false) return;

	if(nDelRows > 0) {
		for(var i=0; i<nDelRows; i++) {
			ds_list.AddRow();
		
			ds_list.CopyRow(ds_list.lastrow, "ds_delList", i);
		}
	}
	
	ds_master.SetColumn(0, "FLAG", "DEL");
	
	if(FV_JOB == "NEW")
	{	// 신규모드
	}
	else
	{	// 수정모드 
		
		var sSaleChgChgrgId = div_input.cmb_saleChgrgId.Value;
		ds_master.SetColumn(0, "SALE_CHGRG_ID",     FV_SALE_CHGRG_ID);
		ds_master.SetColumn(0, "SALE_CHG_CHGRG_ID", sSaleChgChgrgId);
		ds_master.SetColumn(0, "SALE_CHG_DTM",      f_getDate("MOD"));
		
		//수납금액 '-'로 변경
		var nChgCashPayAmt = ToInteger(ds_payment.GetColumn(0, "CHG_CASH_PAY_AMT")) 
								+ ToInteger(ds_payment.GetColumn(0, "CASH_PAY_AMT"))*(-1);
		var nChgCrdtcrdPayAmt1 = ToInteger(ds_payment.GetColumn(0, "CHG_CRDTCRD_PAY_AMT1")) 
									+ ToInteger(ds_payment.GetColumn(0, "CRDTCRD_PAY_AMT1"))*(-1);
		var nChgCrdtcrdPayAmt2 = ToInteger(ds_payment.GetColumn(0, "CHG_CRDTCRD_PAY_AMT2")) 
									+ ToInteger(ds_payment.GetColumn(0, "CRDTCRD_PAY_AMT2"))*(-1);
		var nChgDisAmt = ToInteger(ds_payment.GetColumn(0, "CHG_DIS_AMT")) 
									+ ToInteger(ds_payment.GetColumn(0, "DIS_AMT"))*(-1);
		var nChgCmmsAmt = ToInteger(ds_payment.GetColumn(0, "CHG_CMMS_AMT")) 
									+ ToInteger(ds_payment.GetColumn(0, "CMMS_AMT"))*(-1);
		var nChgMarAmt = ToInteger(ds_payment.GetColumn(0, "CHG_MAR_AMT")) 
									+ ToInteger(ds_payment.GetColumn(0, "MAR_AMT"))*(-1);
		var nChgVatAmt = ToInteger(ds_payment.GetColumn(0, "CHG_VAT_AMT")) 
									+ ToInteger(ds_payment.GetColumn(0, "VAT_AMT"))*(-1);
		var nChgSaleAmt = ToInteger(ds_payment.GetColumn(0, "CHG_SALE_AMT")) 
									+ ToInteger(ds_payment.GetColumn(0, "SALE_AMT"))*(-1);
		
		ds_payment.SetColumn(0, "CHG_CASH_PAY_AMT", nChgCashPayAmt);
		ds_payment.SetColumn(0, "CHG_CRDTCRD_PAY_AMT1", nChgCrdtcrdPayAmt1);
		ds_payment.SetColumn(0, "CHG_CRDTCRD_PAY_AMT2", nChgCrdtcrdPayAmt2);
		ds_payment.SetColumn(0, "CHG_DIS_AMT", nChgDisAmt);
		ds_payment.SetColumn(0, "CHG_CMMS_AMT", nChgCmmsAmt);
		ds_payment.SetColumn(0, "CHG_MAR_AMT", nChgMarAmt);
		ds_payment.SetColumn(0, "CHG_VAT_AMT", nChgVatAmt);
		ds_payment.SetColumn(0, "CHG_SALE_AMT", nChgSaleAmt);
	}	
	
	var sSvcID = "svcDelete";
	var sInDs  = "itemList=ds_list master=ds_master payment=ds_payment nc_fileDs=ds_file:U";
	var sOutDs = "";
	var sArg   = "sktst.sal.BBS#saveSaleList";

	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
}

/*******************************************************************************
 * @description    :  닫기
*******************************************************************************/
function btn_close_OnClick(obj)
{
	Close();
}

/*******************************************************************************
 * @description    :  로우 추가 이벤트
*******************************************************************************/
function div_fuc_btn_add_OnClick(obj)
{
	if( f_validSavePosbility() == false) return;
	
	var nRow = 0;
	if(ds_list.GetRowCount() > 0)
	{	
		nRow = ds_list.currow;
		if(f_validProd(nRow) == false) return;
	}
	nRow = ds_list.AddRow();
	
	// 수납정보 초기화
	if(nRow == 0)
	{
		f_initPayment();
		div_inputCard.cmb_crdtcrdCorp1.index = 0;
		div_inputCard.cmb_crdtcrdCorp1.index = 0;		
	}
	
	ds_list.SetColumn(nRow, "SALE_CHG_HST_CL", "01");
	ds_list.SetColumn(nRow, "SALE_QTY",        "1");
	ds_list.SetColumn(nRow, "SALE_UNIT_PRC",   "0");
	ds_list.SetColumn(nRow, "PROD_CL",         "");	// 상품구분 선택 항목 선택
	
	// 수납정보
	sf_enable("div_inputCard.cmb_crdtcrdCorp1,div_inputCard.cmb_crdtcrdCorp2",true);
	
	if( uf_IsNull(FV_GNRL_SALE_NO) == false)
	{
		ds_list.SetColumn(nRow, "PROD_CL", "9");
		grd_list.SetCellProp("Body", 2, "edit", "none");
	}
	
	div_fuc.btn_subtract.Enable = true;
}


/*******************************************************************************
 * @description    :  추가된 로우 삭제
*******************************************************************************/
function div_fuc_btn_subtract_OnClick(obj)
{
	if( f_validSavePosbility() == false) return;
	
	var nRow = ds_list.currow;
	
	var nRows = ds_list.GetRowCount();
	
	if(ds_list.GetRowType(nRow) == "insert")
	{
		ds_list.DeleteRow(nRow);
	}
	else
	{	// 이미 등록된 건
		if(nRows == 0) return;
		
		if(confirm("선택된 판매건을 취소하시겠습니까?") == false) return;
		
		if(ds_delList.colcount == 0)
		{
		    ds_delList.AddColumn("gnrl_sale_no");
		    ds_delList.AddColumn("gnrl_sale_chg_seq");
		    ds_delList.AddColumn("sale_seq");
		    ds_delList.AddColumn("sale_dtm");
		    ds_delList.AddColumn("sale_chg_hst_cl");
		    ds_delList.AddColumn("prod_cl");
		    ds_delList.AddColumn("prod_cd");
		    ds_delList.AddColumn("prod_nm");
		    ds_delList.AddColumn("mfact_id");
		    ds_delList.AddColumn("mfact_id_nm");
		    ds_delList.AddColumn("color_cd");
		    ds_delList.AddColumn("color_cd_nm");
		    ds_delList.AddColumn("sale_unit_prc");
		    ds_delList.AddColumn("sale_prc");
		    ds_delList.AddColumn("sale_mar");
		    ds_delList.AddColumn("sale_cmms");
		    ds_delList.AddColumn("splst_yn");
		    ds_delList.AddColumn("sale_vat_prc");
		    ds_delList.AddColumn("old_ser_num");
		    ds_delList.AddColumn("ser_num");
		    ds_delList.AddColumn("sale_qty");
		    ds_delList.AddColumn("hld_plc");
		    ds_delList.AddColumn("hld_plc_nm");
		    ds_delList.AddColumn("max");
		    ds_delList.AddColumn("sale_amt");
		    ds_delList.AddColumn("out_mgmt_no");
		    ds_delList.AddColumn("con_mgmt_no");
		    
		}
		ds_delList.AddRow();
		
		ds_delList.CopyRow(ds_delList.lastrow, "ds_list", nRow);
				
		ds_list.DeleteRow(nRow);

		FV_DELETE = true;
	}
	
	f_getSaleTotal();
	
	nRows = ds_list.GetRowCount();
	if(nRows == 0)
	{
		//cf_init(div_inputCard);
		//uf_ObjComponentEnable(div_inputCard);
	}
	else
	{
		grd_list_OnCellClick(grd_list,nRow-1);
	}
}


/*******************************************************************************
 * @description    :  로우 변경시 유효성 검사
*******************************************************************************/
function ds_list_CanRowPosChange(obj,nOldRow,nRow)
{
	return f_validProd(nOldRow);
}



/*******************************************************************************
 * @description    :  삭제버튼 이벤트
*******************************************************************************/
function btn_deleteRow_OnClick(obj)
{
	df_delete();
}


/*******************************************************************************
 * @description    :  판매일자 변경 이벤트
*******************************************************************************/
function div_input_cal_saleDtm_OnCharChanged(obj,strPreText,strPostText)
{
	if(f_PlcChged()) {
		ds_list.Clear();
	}
	else {
		div_input.cal_saleDtm.Value = replace(strPreText,"-", "");
	}
}

/*******************************************************************************
 * @description    :  판매시간 변경 이벤트
*******************************************************************************/
function div_input_edt_saleDtmHH_OnCharChanged(obj,strPreText,strPostText)
{
	if(f_PlcChged()) {
		ds_list.Clear();
	}
	else {
		div_input.edt_saleDtmHH.text = strPreText;
	}
}

/*******************************************************************************
 * @description    :  판매분 변경 이벤트
*******************************************************************************/
function div_input_edt_saleDtmMM_OnCharChanged(obj,strPreText,strPostText)
{
	if(f_PlcChged()) {
		ds_list.Clear();
	}
	else {
		div_input.edt_saleDtmMM.text = strPreText;
	}
}

/*******************************************************************************
 * @description    :  변경일자 변경 이벤트
*******************************************************************************/
function div_input_cal_saleChgDtm_OnCharChanged(obj,strPreText,strPostText)
{
	//f_getCardCorp();
	
}

/*******************************************************************************
 * @description    :  변경시간 변경 이벤트
*******************************************************************************/
function div_input_edt_saleChgDtmHH_OnCharChanged(obj,strPreText,strPostText)
{
	
}

/*******************************************************************************
 * @description    :  변경분 변경 이벤트
*******************************************************************************/
function div_input_edt_saleChgDtmMM_OnCharChanged(obj,strPreText,strPostText)
{
	
}


/*******************************************************************************
 * @description    :  그리드 클릭시 판매관리번호 셋팅 이벤트
*******************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

}


/*******************************************************************************
 * @description    :  카드1 콤보 변경 이벤트
*******************************************************************************/
function div_inputCard_cmb_crdtCorp1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	div_inputCard.msk_crdtCrdPayAmt1.Value = "0";
}

/*******************************************************************************
 * @description    :  카드1 콤보 변경 이벤트
*******************************************************************************/
function div_inputCard_cmb_crdtCorp2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	div_inputCard.msk_crdtCrdPayAmt2.Value = "0"; 
}

/*******************************************************************************
 * @description    :  로우 위치 변경 이벤트
*******************************************************************************/
function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{
	grd_list_OnCellClick(obj,nRow);
}



/*******************************************************************************
 * @description    :  로우의 이미지 클릭 이벤트
*******************************************************************************/
function grd_list_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
//trace("grd_list_OnExpandUp - Cell : " + nCell);
	var sSaleDtm = div_input.cal_saleDtm.Value;
	var sProdCl = ds_list.GetColumn(nRow, "PROD_CL");
	
	if(uf_isNull(sSaleDtm) == true)
	{	// MSG_00043 : 반드시 입력해야 합니다.
		alert(cf_getMessage(MSG_00043, "판매일자")); 
		div_input.cal_saleDtm.SetFocus();
		return;
	}	
	
	if(uf_isNull(sProdCl) == true)
	{	// MSG_00043 : 반드시 입력해야 합니다.
		alert(cf_getMessage(MSG_00043, "상품구분")); 
		grd_list.SetFocus();
		grd_list.SetCellPos(5);	
		return;
	}
	
	switch(nCell)
	{
	case 4: // 제조사
		if(uf_isNull(sProdCl) == true || sProdCl == "1" || sProdCl == "2") return;
		
		var sArg  = "deal_co_cl1="+quote("20"); // 필수 물류창고, 직영점, 판매점
			sArg += " eff_dtm="+quote(sSaleDtm); // 옵션
	
		cf_callDealPop(sArg, ds_list, "mfact_id_nm,mfact_id", nRow);
		
		break;		
	case 5:	// 모델
		if(uf_isNull(sProdCl) == true || sProdCl == "1" || sProdCl == "2") return;
		var sMfactId = ds_list.GetColumn(nRow, "MFACT_ID");		

		sf_salProdPopDs("ds_list", nRow, sSaleDtm, sProdCl, sMfactId, "f_getColorFilter");
		break;
	default:
		break;
	}
}




/*******************************************************************************
 * @description    :  From 닫을 경우 
*******************************************************************************/
function form_OnUnloadCompleted(obj)
{
	if(ds_list.GetUpdate() == false && ds_payment.GetUpdate() == false) return;
	
	if(f_isChangeList() == true)
	{
		if(confirm("변경된 데이타가 미반영 상태입니다. 이대로 종료 하시겠습니까?") == true)
		{
			return true;
		}
		return false;
	}
}

/*******************************************************************************
 * @description    :  그리드 키 입력 이벤트
*******************************************************************************/
function grd_list_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{

}

/*******************************************************************************
 * @description    :  그리드 엔터키 입력 이벤트
*******************************************************************************/
function grd_list_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	var sSaleDtm = div_input.cal_saleDtm.Value;
	var sProdCl  = ds_list.GetColumn(nRow, "PROD_CL");
	
	switch(nCell)
	{
	case 3:	// 시리얼 번호 체크
		var nLength = Length(ds_list.GetColumn(nRow, "SER_NUM"));

		var sRowType = ds_list.GetRowType(nRow);
		if( sRowType == "insert")
		{	// 추가건일 경우

			var nLenSerNum = f_getLengthSerNum();

			ds_list.SetColumn(nRow, "SER_NUM", strVal);

			if(f_validDate() == false) return;
			if(f_searchSaleDtlTypChk() == false) return;
			f_getDisPordList();
			if(f_chkDupDisItem(nRow) == true) return;
		}
		else
		{	// 수정일경우 			
			f_validModedProd(nRow);
		}

		break;
		
	case 4: // 제조사
		if(uf_isNull(sProdCl) == true || sProdCl == "1" || sProdCl == "2") return;
		
		var sArg  = "deal_co_cl1="+quote("20"); // 필수 물류창고, 직영점, 판매점
			sArg += " eff_dtm="+quote(sSaleDtm); // 옵션
	
		cf_callDealPop(sArg, ds_list, "mfact_id_nm,mfact_id", nRow);
		
		break;		
		
	case 5:	// 모델
		if(uf_isNull(sProdCl) == true || sProdCl == "1" || sProdCl == "2") return;
		var sMfactId = ds_list.GetColumn(nRow, "MFACT_ID");		

		sf_salProdPopDs("ds_list", nRow, sSaleDtm, sProdCl, sMfactId, "f_getColorFilter");
		break;		
	}

	
}

/*******************************************************************************
 * @description    :  팀  키 이벤트
*******************************************************************************/
function div_input_edt_agencyCdNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13)
	{
		var sArg  = "org_id="+quote(FV_ORG_ID); 
			sArg += " org_cl="+quote(FV_ORG_CL); 
			sArg += " eff_dtm="+quote(f_getDate("NEW")); // 옵션
			sArg += " deal_status="+quote("4"); // 옵션 판매정지
			
		cf_callAgencyPop(sArg, div_input, "edt_agencyCdNm,edt_agencyCd,edt_agencyUkeyCd");

		if(uf_isNull(FV_STR_POP_RESULT) == true) return;
			
		f_getStlPlc();
		ds_chgrgId.clear();
		f_initSaleChgrgId();
	}	
}


/*******************************************************************************
 * @description    :  팀 문자값 변경 이벤트
*******************************************************************************/
function div_input_edt_agencyCdNm_OnCharChanged(obj,strPreText,strPostText)
{
	if(f_PlcChged()) {
		sf_clearControls("div_input.edt_agencyCd,div_input.edt_agencyUkeyCd");
		sf_clearControls("div_input.edt_salePlcNm,div_input.edt_salePlc,div_input.edt_salePlcUkeyCd,div_input.edt_salePlcSubCd,div_input.edt_salePlcChannelCd");
		sf_clearControls("div_input.edt_stlPlcNm,div_input.edt_stlPlc,div_input.edt_stlPlcUkeyCd,div_input.edt_stlPlcSubCd,div_input.edt_stlPlcChannelCd");	
		f_initSaleChgrgId();	
		ds_list.Clear();
	}
	else {
		div_input.edt_agencyCdNm.value = strPreText;
	}
}

/*******************************************************************************
 * @description    :  팀 키 이벤트
*******************************************************************************/
function div_input_btn_agency_OnClick(obj)
{
	sf_clearControls("div_input.edt_agencyCd,div_input.edt_agencyUkeyCd");
	sf_clearControls("div_input.edt_salePlcNm,div_input.edt_salePlc,div_input.edt_salePlcUkeyCd,div_input.edt_salePlcSubCd,div_input.edt_salePlcChannelCd");
	sf_clearControls("div_input.edt_stlPlcNm,div_input.edt_stlPlc,div_input.edt_stlPlcUkeyCd,div_input.edt_stlPlcSubCd,div_input.edt_stlPlcChannelCd");	
	
	f_initSaleChgrgId();
	ds_list.Clear();
	
	var sArg  = "org_id="+quote(FV_ORG_ID); 
		sArg += " org_cl="+quote(FV_ORG_CL); 
		sArg += " eff_dtm="+quote(f_getDate("NEW")); // 옵션
		sArg += " deal_status="+quote("4"); // 옵션 판매정지
		
	cf_callAgencyPop(sArg, div_input, "edt_agencyCdNm,edt_agencyCd,edt_agencyUkeyCd");	

	if(uf_isNull(FV_STR_POP_RESULT) == true) return;
	
	
	//f_getChgrgIdList();
}


/*******************************************************************************
 * @description    :  판매처 키 이벤트
*******************************************************************************/
function div_input_edt_salePlcNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	
	if(nChar == 13)
	{
		var sPosAgency = div_input.edt_agencyCd.Text;
		
		if(uf_isNull(sPosAgency) == true)
		{
			alert(cf_getMessage(MSG_00083, "팀"));
			div_input.edt_agencyCdNm.SetFocus();
			return;
		}
		
		//var sArg  = "deal_co_cl1="+quote(sf_getDealCoCl1());	// 소매 
		var sArg  = "deal_co_cl1="+quote("A1,A2,S1");
			sArg += " pos_agency="+quote(sPosAgency); // 옵션
			sArg += " eff_dtm="+quote(f_getDate("NEW")); // 옵션
			//sArg += " deal_status="+quote("4"); // 옵션 판매정지
			
		cf_callDealPop(sArg, div_input, "edt_salePlcNm,edt_salePlc,edt_salePlcUkeyCd,edt_salePlcSubCd,edt_salePlcChannelCd");	
		
		if(uf_isNull(FV_STR_POP_RESULT) == true) return;
		
		f_getChgrgIdList();
		f_getStlPlc();
	}	
}

/*******************************************************************************
 * @description    :  판매처 키 문자값 변경 이벤트
*******************************************************************************/
function div_input_edt_salePlcNm_OnCharChanged(obj,strPreText,strPostText)
{
	
	if(f_PlcChged()) {
		sf_clearControls("div_input.edt_salePlc,div_input.edt_salePlcUkeyCd,div_input.edt_salePlcSubCd,div_input.edt_salePlcChannelCd");
		sf_clearControls("div_input.edt_stlPlcNm,div_input.edt_stlPlc,div_input.edt_stlPlcUkeyCd,div_input.edt_stlPlcSubCd,div_input.edt_stlPlcChannelCd");	
		
		f_initSaleChgrgId();	
		ds_list.Clear();
	}
	else {
		div_input.edt_salePlcNm.value = strPreText;
	}
}


/*******************************************************************************
 * @description    :  판매처 버튼 이벤트
*******************************************************************************/
function div_input_btn_salePlc_OnClick(obj)
{
	sf_clearControls("div_input.edt_salePlc,div_input.edt_salePlcUkeyCd,div_input.edt_salePlcSubCd,div_input.edt_salePlcChannelCd");
	sf_clearControls("div_input.edt_stlPlcNm,div_input.edt_stlPlc,div_input.edt_stlPlcUkeyCd,div_input.edt_stlPlcSubCd,div_input.edt_stlPlcChannelCd");	
	
	ds_chgrgId.clear();
	ds_list.Clear();
	
	var sPosAgency = div_input.edt_agencyCd.Text;

	if(uf_isNull(sPosAgency) == true)
	{
		alert(cf_getMessage(MSG_00083, "팀"));
		div_input.edt_agencyCdNm.SetFocus();
		return;
	}
	
	var sArg  = "deal_co_cl1="+quote("A2,A3,A4,B1,B2,C1,Z1");	// 소매
		sArg += " pos_agency="+quote(sPosAgency); // 옵션
		sArg += " eff_dtm="+quote(f_getDate("NEW")); // 옵션
		//sArg += " deal_status="+quote("4"); // 옵션 판매정지
		
	cf_callDealPop(sArg, div_input, "edt_salePlcNm,edt_salePlc,edt_salePlcUkeyCd,edt_salePlcSubCd,edt_salePlcChannelCd");		
	
	if(uf_isNull(FV_STR_POP_RESULT) == true) return;
	
	f_getChgrgIdList();
	f_getStlPlc();
}

/*******************************************************************************
 * @description    :  판매처 포커스 킬포커스 이벤트
*******************************************************************************/
function div_input_edt_salePlcNm_OnKillFocus(obj)
{
	f_getChgrgIdList();
}


/*******************************************************************************
 * @description    :  팀 포커스 킬포커스 이벤트
*******************************************************************************/
function div_input_edt_agencyCdNm_OnKillFocus(obj)
{
	f_getChgrgIdList();
}

// 수납금액 변경이 발생한 경우 변동금액 계산
function ds_payment_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var strChgColumnID = "CHG_"+strColumnID;
	
	if((strColumnID == "CASH_PAY_AMT") 
		|| (strColumnID == "CRDTCRD_PAY_AMT1")
		|| (strColumnID == "CRDTCRD_PAY_AMT2")
		|| (strColumnID == "DIS_AMT")
		|| (strColumnID == "CMMS_AMT")
		|| (strColumnID == "MAR_AMT")
		|| (strColumnID == "VAT_AMT")
		|| (strColumnID == "SALE_AMT")){
//alert("strColumnID = "+strColumnID);				
		var nChgAmt = ToInteger(ds_payment.GetColumn(0, strChgColumnID))
					+ (ToInteger(varNewValue) - ToInteger(varOldValue));
//alert("nChgAmt = "+nChgAmt);
		ds_payment.SetColumn(0, strChgColumnID, nChgAmt);
	}
}

function div_fuc_btn_inProd_OnClick(obj)
{
	if(!f_checkDefault())
    {
        return;
    }
    
    ds_inOut200.Clear();
    cf_setParam(ds_inOut200, "out_plc_id", div_input.edt_salePlc.Text);
    cf_setParam(ds_inOut200, "out_plc_nm", div_input.edt_salePlcNm.Text);
    cf_setParam(ds_inOut200, "sale_typ_cd", '01');
    cf_setParam(ds_inOut200, "sale_dtm", Replace(div_input.cal_saleDtm.Text,'-',''));
    
    // 재고상품검색 팝업
	Dialog("DIS::DISATR00700.xml", "FV_STR_DS_200=ds_inOut200 FV_STR_DS_M200=ds_list FV_PARENT_NUM=100000933", 830, 600);
}

function div_fuc_btn_excelUp_OnClick(obj)
{
	if(!cf_checkObjValues(div_input)) return;	
	
	if(!f_checkDefault())
    {
        return;
    }		
    
	var sArg  = "sOutPlcId="+quote(div_input.edt_salePlc.value);
		sArg += " sSaleTypCd=01";
	    sArg += " sSaleDtm="+quote(Replace(div_input.cal_saleDtm.Text,'-',''));
	    sArg += " FV_STR_DS_M200=ds_list";
	    sArg += " FV_PARENT_NUM=100000933";
	
	dialog("DIS::DISATR00750.xml", sArg , 830, 535);
}

/*******************************************************************************
 * @description    :  시,분 입력자릿수가 한자리인 경우 두자리로 맞춤.
*******************************************************************************/
function lf_setLenHHMM(obj) {
	var sVal = obj.text;
	
	if((length(sVal) == 1) && (sVal != '0')) {
		sVal = '0'+sVal;
	}
	
	return sVal;
}

function div_input_edt_saleDtmHH_OnKillFocus(obj)
{
	obj.text = lf_setLenHHMM(obj);
}


function div_input_edt_saleDtmMM_OnKillFocus(obj)
{
	obj.text = lf_setLenHHMM(obj);
}

function div_input_edt_saleChgDtmHH_OnKillFocus(obj)
{
	obj.text = lf_setLenHHMM(obj);
}

function div_input_edt_saleChgDtmMM_OnKillFocus(obj)
{
	obj.text = lf_setLenHHMM(obj);
}


/*******************************************************************************
 * @description    :  매출처 버튼 이벤트
*******************************************************************************/
function div_input_btn_salePrcPlc_OnClick(obj)
{
	sf_clearControls("div_inputCard.edt_salePrcPlcUkeyCd,div_inputCard.edt_salePrcPlcSubCd,div_inputCard.edt_salePrcPlcChannelCd,div_inputCard.edt_salePrcPlc");
	
	var sArg  = "deal_co_cl1="+quote("A1,A2,S1");	// 소매
		sArg += " pos_agency="; // 옵션
		sArg += " eff_dtm="+quote(f_getDate("NEW")); // 옵션
		//sArg += " deal_status="+quote("4"); // 옵션 판매정지
	cf_callDealPop(sArg, div_inputCard, "edt_salePrcPlcNm,edt_salePrcPlc,edt_salePrcPlcUkeyCd,edt_salePrcPlcSubCd,edt_salePrcPlcChannelCd");		
	if(uf_isNull(FV_STR_POP_RESULT) == true) return;
}

/*******************************************************************************
 * @description    :  매출처 키 이벤트
*******************************************************************************/
function div_input_edt_salePrcPlcNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	
	if(nChar == 13)
	{
		var sArg  = "deal_co_cl1="+quote("A2,A3,A4,B1,B2,C1,Z1");	// 소매
		sArg += " pos_agency="; // 옵션
		sArg += " eff_dtm="+quote(f_getDate("NEW")); // 옵션
		//sArg += " deal_status="+quote("4"); // 옵션 판매정지
		
		cf_callDealPop(sArg, div_inputCard, "edt_salePrcPlcNm,edt_salePrcPlc,edt_salePrcPlcUkeyCd,edt_salePrcPlcSubCd,edt_salePrcPlcChannelCd");		
	
		if(uf_isNull(FV_STR_POP_RESULT) == true) return;
		
	}	
}

/*******************************************************************************
 * @description    :  매출처 키 문자값 변경 이벤트
*******************************************************************************/
function div_input_edt_salePrcPlcNm_OnCharChanged(obj,strPreText,strPostText)
{
	sf_clearControls("div_inputCard.edt_salePrcPlcUkeyCd,div_inputCard.edt_salePrcPlcSubCd,div_inputCard.edt_salePrcPlcChannelCd,div_inputCard.edt_salePrcPlc");
}


function f_setButton(){

	// 트랜잭션 설정
	var sSvcID = "initUpdateYn";
	var sInDs  = "nc_input_fieldDs=ds_master";
	var sOutDs = "ds_updateYn=ds_updateYn";
	var sArg   = "sktst.sal.BBS#getUpdateYn";
	
	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
}

/*******************************************************************************
 * @description    : 첨부 파일 선택- 이벤트
*******************************************************************************/
function div_inputCard_btn_selectAttatchFiles_OnClick(obj)
{
	var sDocId = ds_master.GetColumn(0, "DOC_ID");
	cf_setUploadFile(ds_file, sDocId);
}


/*******************************************************************************
 * @description    : 첨부 파일 삭제 - 이벤트
*******************************************************************************/
function div_inputCard_btn_delRow_OnClick(obj)
{
	var oGrdDs = object(div_inputCard.grd_file.BindDataset);
	if(oGrdDs.getRowCount() < 1)
	{
		alert(cf_getMessage(MSG_00039,""));
		return;
	}
	
	if(oGrdDs.getRowType(oGrdDs.currow) == "insert")
	{
		oGrdDs.DeleteRow(oGrdDs.currow);
	}
	else
	{
		if(confirm(cf_getMessage(MSG_00102,"")) == true)
		{
			oGrdDs.DeleteRow(oGrdDs.currow);
		}
	}
}


/*******************************************************************************
 * @description    : 첨부 파일 내려 받기- 이벤트
*******************************************************************************/

function div_inputCard_grd_file_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 1) return;
	
	var oGrdDs = object(obj.BindDataset);
	var sScreenId = oGrdDs.getColumn(nRow, "SCREEN_ID");
	var sDocId = oGrdDs.getColumn(nRow, "DOC_ID");
	var sFileName = oGrdDs.getColumn(nRow, "FILE_NM");
	var sFileType = oGrdDs.getColumn(nRow, "FILE_TYPE");
	cf_downLoad(sScreenId, sDocId, sFileName, sFileType);	
}

/*******************************************************************************
 * @description    : 전체 다운로드 - 이벤트
*******************************************************************************/
function btn_allDown_OnClick(obj)
{
	cf_allDownLoad(ds_file);
}

 /*******************************************************************************
 * @description    : 첨부 파일 정보 표시 
*******************************************************************************/
function f_setAttachScreen()
{
	var sDocId = ds_master.GetColumn(0, "DOC_ID");	
	ds_file.ClearData();
	
	if(trim(sDocId).length  > 0)
	{
		f_getAttatchList(sDocId);
	}
}

function f_getAttatchList(sDocId)
{
	// 조회를 위한 필수 인자 SCREEN_ID ,  DOC_ID
	var sScreenId = substr(pFrmUrl, pFrmUrl.indexOf("::")+2);
	
	ds_condition.ClearData();
	cf_setParam(ds_condition, "SCREEN_ID", sScreenId); 
	cf_setParam(ds_condition, "DOC_ID"   , sDocId); 

	// 트랜잭션 설정
	var sSvcID = "svcAttatchList";
	var sInDs = "nc_input_fieldDs=ds_condition";
	var sOutDs = "ds_file=nc_fileDs";
	var sArg = "sktst.sal.BBS#getAttatchList";

	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}


/*******************************************************************************
 * @description    : 인수증 출력
*******************************************************************************/
function f_print(){
	http.Sync = true;
	
	ds_report2.SetColumn(0,"SALE_PRC_PLC_NM",ds_payment.GetColumn(0,"SALE_PRC_PLC_NM"));
	ds_report2.SetColumn(0,"UKEY_AGENCY_CD",ds_payment.GetColumn(0,"UKEY_AGENCY_CD"));
	
	var dsArry = Array();
	//alert(ds_report1.SaveXML());
	dsArry[0] = ds_report1;
	dsArry[1] = ds_report2;
	
	//url_str.Text = gv_url + "MRD/BAS/BASBAR00100.mrd";

	sXML = f_dsToXml(dsArry);
	//trace(sXML);
	Report0.setRdata(sXML);
	Report0.AutoAdjust = false;
	Report0.ZoomRatio = 100;
	Report0.FileOpen(gv_url + "MRD/SAL/SALBBS00200.mrd", "");
	Report0.CMPrint ();
	Report0.Visible = false;
	var outRD = Confirm("출고 내역을 출력하시겠습니까?");
	if(outRD){
		f_print_out();
	}
	http.Sync = false;
}

/*******************************************************************************
 * @description    : 출고증 출력
*******************************************************************************/
function f_print_out(){
	
	http.Sync = true;
	
	var dsArry = Array();
	ds_report3.Copy(ds_list);
	
	dsArry[0] = ds_report3;
	dsArry[1] = ds_report2;
	
	//url_str.Text = gv_url + "MRD/BAS/BASBAR00100.mrd";

	sXML = f_dsToXml(dsArry);
	Report1.setRdata(sXML);
	Report1.AutoAdjust = false;
	Report1.ZoomRatio = 100;
	Report1.FileOpen(gv_url + "MRD/SAL/SALBBS00210.mrd", "");
	Report1.CMPrint ();
	Report1.Visible = false;

	http.Sync = false;
}
/*******************************************************************************
 * @description    : DS to XML
 * @param arrObj   : 데이터셋 배열
*******************************************************************************/
function f_dsToXml(arrObj){
	var strTemp = "";
	
	var dsobj = split(arrObj,",");
	var ds_cnt = length(dsobj);
				
	strTemp += '<?xml version="1.0" encoding="euc-kr"?>' + chr(10);
	strTemp += '<root>';
	
	for (i=0; i<toNumber(ds_cnt); i++){
	    var sTmp = replace(dsobj[i], "[", "");
	    sTmp = replace(sTmp, "]", "");
	    sTmp = replace(sTmp, "Dataset:", "");
		strTemp += object(sTmp).saveXML(object(sTmp).id, "A", false);
	}
	
	strTemp += chr(10) + '</root>';
	
	return strTemp;
}
]]></Script>
</Window>