<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="600" Id="form" Left="8" OnLoadCompleted="form_OnLoadCompleted" PidAttrib="7" Title="G/W&#32;사용자관리" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_inf_person_info" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="255" summ="default" type="STRING"/>
					<colinfo id="SENDDT" size="255" summ="default" type="STRING"/>
					<colinfo id="EMPNO" size="255" summ="default" type="STRING"/>
					<colinfo id="HNAME" size="255" summ="default" type="STRING"/>
					<colinfo id="ENAME" size="255" summ="default" type="STRING"/>
					<colinfo id="REGNO" size="255" summ="default" type="STRING"/>
					<colinfo id="INTELNO" size="255" summ="default" type="STRING"/>
					<colinfo id="MOVETELNO" size="255" summ="default" type="STRING"/>
					<colinfo id="EMAIL1" size="255" summ="default" type="STRING"/>
					<colinfo id="EMAIL2" size="255" summ="default" type="STRING"/>
					<colinfo id="SENDDT" size="255" summ="default" type="STRING"/>
					<colinfo id="APLY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="NOEMPLOYEE_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="U_KEY_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="PWD" size="255" summ="default" type="STRING"/>
					<colinfo id="USER_GRP" size="255" summ="default" type="STRING"/>
					<colinfo id="DUTY" size="255" summ="default" type="STRING"/>
					<colinfo id="ATTC_CAT" size="255" summ="default" type="STRING"/>
					<colinfo id="ORG_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="ORG_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="ORG_CL" size="255" summ="default" type="STRING"/>
					<colinfo id="POS_AGENCY" size="255" summ="default" type="STRING"/>
					<colinfo id="POS_AGENCY_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="ORG_AREA" size="255" summ="default" type="STRING"/>
					<colinfo id="ORG_AREA_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="T_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="INDEPT" size="255" summ="default" type="STRING"/>
					<colinfo id="BOOSER" size="255" summ="default" type="STRING"/>
					<colinfo id="SOSOK" size="255" summ="default" type="STRING"/>
					<colinfo id="JBGRP" size="255" summ="default" type="STRING"/>
					<colinfo id="JBRANK" size="255" summ="default" type="STRING"/>
					<colinfo id="JBCHARGE" size="255" summ="default" type="STRING"/>
					<colinfo id="PLACE" size="255" summ="default" type="STRING"/>
					<colinfo id="AFFAIRS1" size="255" summ="default" type="STRING"/>
					<colinfo id="WRKADDR" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents>
					<colinfo id="sta_send_dt" size="10" summ="default" type="STRING"/>
					<colinfo id="end_send_dt" size="10" summ="default" type="STRING"/>
					<colinfo id="aply_yn" size="1" summ="default" type="STRING"/>
					<colinfo id="t_flag" size="1" summ="default" type="STRING"/>
					<colinfo id="org_id" size="10" summ="default" type="STRING"/>
					<colinfo id="org_nm" size="100" summ="default" type="STRING"/>
					<colinfo id="indept" size="10" summ="default" type="STRING"/>
					<colinfo id="ps_org_id" size="10" summ="default" type="STRING"/>
					<record>
						<aply_yn></aply_yn>
						<end_send_dt></end_send_dt>
						<indept></indept>
						<org_id></org_id>
						<org_nm></org_nm>
						<ps_org_id></ps_org_id>
						<sta_send_dt></sta_send_dt>
						<t_flag></t_flag>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_aply_yn">
				<Contents>
					<colinfo id="CODE" size="1" summ="default" type="STRING"/>
					<colinfo id="NAME" size="10" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<NAME>전체</NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<NAME>반영</NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<NAME>미반영</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user_group">
				<Contents>
					<colinfo id="COMM_CD_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_duty">
				<Contents>
					<colinfo id="COMM_CD_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_attc_cat">
				<Contents>
					<colinfo id="COMM_CD_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="255" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_org">
				<Contents>
					<colinfo id="ORG_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_CL" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="U_KEY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EFF_ORG_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MBL_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_CD1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_CD2" size="256" summ="default" type="STRING"/>
					<colinfo id="OTH_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="column0" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_t_flag">
				<Contents>
					<colinfo id="CODE" size="1" summ="default" type="STRING"/>
					<colinfo id="NAME" size="10" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<NAME>전체</NAME>
					</record>
					<record>
						<CODE>I</CODE>
						<NAME>신규</NAME>
					</record>
					<record>
						<CODE>U</CODE>
						<NAME>변경</NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<NAME>삭제</NAME>
					</record>
					<record>
						<CODE>X</CODE>
						<NAME>제외</NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Border="Raised" Height="40" Id="div_search" Left="8" Style="sty_div_input" TabOrder="1" Text="질의내용" Top="10" Width="1008">
			<Contents>
				<Static Align="Right" Height="20" Id="Static0" Left="32" Style="sty_lb_Search" TabOrder="3" Text="전송일자" Top="8" VAlign="Middle" Width="56"></Static>
				<Calendar Border="Flat" ButtonImageID="btn_i_calendar" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_staSendDt" Left="92" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="1" TodayColor="user26" Top="7" UserData="발주일자의&#32;시작일" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="90"></Calendar>
				<Static Align="Center" Height="20" Id="Static1" Left="182" TabOrder="4" Text="~" Top="8" VAlign="Middle" Width="20"></Static>
				<Calendar Border="Flat" ButtonImageID="btn_i_calendar" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_endSendDt" Left="202" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="2" TodayColor="user26" Top="7" UserData="발주일자의&#32;종료일" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="90"></Calendar>
				<Image Height="21" Id="Image0" ImageID="bul_mand" Left="22" TabOrder="5" Top="8" Transparent="TRUE" Width="20"></Image>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="NAME" Height="20" Id="cmb_aply_yn" ImeMode="none" INDEX="2" InnerDataset="ds_aply_yn" Left="382" Style="sty_ipt_form" TabOrder="7" Top="6" Width="88"></Combo>
				<Static Align="Right" Height="20" Id="Static7" Left="306" Style="sty_lb_Search" TabOrder="6" Text="반영여부" Top="8" VAlign="Middle" Width="73"></Static>
				<Button Align="Left" ButtonStyle="TRUE" Height="21" Id="Button0" ImageID="btn_a_2" Left="934" LeftMargin="5" OnClick="df_search" Style="sty_btn_a" TabOrder="8" Text="조회" Top="6" Width="62"></Button>
				<Static Align="Right" Height="20" Id="Static2" Left="482" Style="sty_lb_Search" TabOrder="9" Text="구분" Top="8" VAlign="Middle" Width="45"></Static>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="NAME" Height="20" Id="cmb_t_flag" ImeMode="none" INDEX="0" InnerDataset="ds_t_flag" Left="530" Style="sty_ipt_form" TabOrder="10" Top="6" Width="84"></Combo>
				<Edit Border="Flat" Height="20" Id="edt_lvl" Left="881" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="15" Top="7" Visible="FALSE" Width="10"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" Column="org_nm" Enable="FALSE" Height="20" Id="edt_orgNm" Left="770" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="14" Top="7" Width="110"></Edit>
				<Button Cursor="HAND" Height="21" Id="btn_orgTree" ImageID="btn_i_detail" Left="750" OnClick="div_search_btn_orgTree_OnClick" TabOrder="12" Text="Button0" Top="7" Width="19"></Button>
				<Edit BindDataset="ds_condition" Border="Flat" Column="org_id" Height="20" Id="edt_orgId" Left="681" LeftMargin="2" OnCharChanged="div_search_edt_orgId_OnCharChanged" OnKeyDown="div_search_edt_orgId_OnKeyDown" RightMargin="2" Style="sty_ipt_form" TabOrder="11" Top="7" Width="70"></Edit>
				<Static Align="Right" Height="20" Id="Static3" Left="642" Style="sty_lb_Search" TabOrder="13" Text="조직" Top="8" VAlign="Middle" Width="35"></Static>
				<Image Height="21" Id="Image1" ImageID="bul_mand" Left="634" TabOrder="16" Top="6" Transparent="TRUE" Width="20"></Image>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_cancel" ImageID="btn_d_2" Left="760" LeftMargin="5" OnClick="btn_cancel_OnClick" Style="sty_btn_d" TabOrder="4" Text="취소" Top="325" Width="60"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_confirm" ImageID="btn_c_2" Left="695" LeftMargin="5" OnClick="btn_confirm_OnClick" Style="sty_btn_c" TabOrder="3" Text="확인" Top="325" Width="60"></Button>
		<Grid AutoEnter="TRUE" BindDataset="ds_inf_person_info" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="468" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="22" Height="408" Id="grd_inf_person_info" InputPanel="FALSE" Left="8" LineColor="user33" OnExpandUp="grd_list_OnExpandUp" OnHeadClick="grd_list_OnHeadClick" Right="1016" RowHeight="21" Style="sty_Grid" TabOrder="2" TabStop="true" Top="60" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="1008">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="69"/>
						<col width="55"/>
						<col width="52"/>
						<col width="144"/>
						<col width="53"/>
						<col width="95"/>
						<col width="140"/>
						<col width="132"/>
						<col width="63"/>
						<col width="44"/>
						<col width="56"/>
						<col width="36"/>
						<col width="88"/>
						<col width="88"/>
						<col width="181"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" text="처리일자"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" text="사번"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" text="이름"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" text="사용자그룹"/>
						<cell bkcolor="user34" col="5" color="user35" display="text" text="직책"/>
						<cell bkcolor="user34" col="6" color="user35" display="text" text="소속조직" wordwrap="exchar"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" text="소속대리점" wordwrap="exchar"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" text="근무지" wordwrap="exchar"/>
						<cell bkcolor="user34" col="9" color="user35" display="text" text="소속구분" wordwrap="exchar"/>
						<cell bkcolor="user34" col="10" color="user35" display="text" text="비직원" wordwrap="exchar"/>
						<cell bkcolor="user34" col="11" color="user35" display="text" text="반영여부" wordwrap="exchar"/>
						<cell bkcolor="user34" col="12" color="user35" display="text" text="구분" wordwrap="exchar"/>
						<cell bkcolor="user34" col="13" color="user35" display="text" text="이동전화"/>
						<cell bkcolor="user34" col="14" color="user35" display="text" text="전화번호"/>
						<cell bkcolor="user34" col="15" color="user35" display="text" text="e-mail"/>
					</head>
					<body>
						<cell align="center" col="0" colid="chk" display="checkbox" edit="expr:iif(aply_yn&#32;==&#32;&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;X&apos;&#32;,&apos;none&apos;,&apos;checkbox&apos;)"/>
						<cell align="center" col="1" colid="SENDDT" display="text" Mask="####-##-##"/>
						<cell align="center" col="2" colid="EMPNO" display="text"/>
						<cell align="center" col="3" colid="HNAME" display="text"/>
						<cell align="center" col="4" colid="USER_GRP" combocol="COMM_CD_VAL" combodataset="ds_user_group" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:iif(aply_yn&#32;==&#32;&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;&#32;,&apos;none&apos;,&#32;&apos;combo&apos;)" expandimage="btn_combo" expandshow="true" expandsize="17"/>
						<cell align="center" col="5" colid="DUTY" combocol="COMM_CD_VAL" combodataset="ds_duty" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:iif(aply_yn&#32;==&#32;&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;&#32;,&apos;none&apos;,&#32;&apos;combo&apos;)" expandimage="btn_combo" expandshow="true" expandsize="17"/>
						<cell align="center" col="6" colid="ORG_NM" combocol="code" combotext="name" display="text" edit="expr:iif(aply_yn&#32;==&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;&#32;||&#32;(aply_yn&#32;==&apos;N&apos;&#32;&amp;&amp;&#32;indept&#32;!=&#32;&apos;50000035&apos;&#32;&amp;&amp;&#32;indept&#32;!=&#32;&apos;50000059&apos;),&#32;&apos;none&apos;,&#32;&apos;normal&apos;)" expandimage="btn_i_detail" expandshow="expr:iif(aply_yn&#32;==&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;&#32;||&#32;(aply_yn&#32;==&apos;N&apos;&#32;&amp;&amp;&#32;indept&#32;!=&#32;&apos;50000035&apos;&#32;&amp;&amp;&#32;indept&#32;!=&#32;&apos;50000059&apos;),&#32;&apos;false&apos;,&#32;&apos;true&apos;)" expandsize="17"/>
						<cell align="center" col="7" colid="POS_AGENCY_NM" combocol="code" combotext="name" display="text" edit="expr:iif(aply_yn&#32;==&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;,&#32;&apos;none&apos;,&#32;&apos;normal&apos;)" expandimage="btn_i_detail" expandshow="expr:iif(aply_yn&#32;==&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;,&#32;&apos;false&apos;,&#32;&apos;true&apos;)" expandsize="17"/>
						<cell align="center" col="8" colid="ORG_AREA_NM" combocol="code" combotext="name" display="text" edit="expr:iif(aply_yn&#32;==&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;,&#32;&apos;none&apos;,&#32;&apos;normal&apos;)" expandimage="btn_i_detail" expandshow="expr:iif(aply_yn&#32;==&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;,&#32;&apos;false&apos;,&#32;&apos;true&apos;)" expandsize="17"/>
						<cell col="9" colid="ATTC_CAT" combocol="COMM_CD_VAL" combodataset="ds_attc_cat" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:iif(aply_yn&#32;==&#32;&apos;Y&apos;&#32;||&#32;t_flag&#32;==&#32;&apos;U&apos;&#32;,&apos;none&apos;,&#32;&apos;combo&apos;)" expandimage="btn_combo" expandshow="true" expandsize="17"/>
						<cell align="center" col="10" colid="NOEMPLOYEE_YN" combocol="code" combotext="name" display="text"/>
						<cell align="center" col="11" colid="APLY_YN" combocol="CODE" combodataset="ds_aply_yn" combotext="NAME" display="combo"/>
						<cell align="center" col="12" colid="T_FLAG" combocol="CODE" combodataset="ds_t_flag" combotext="NAME" display="combo"/>
						<cell align="center" col="13" colid="MOVETELNO" display="text"/>
						<cell align="center" col="14" colid="INTELNO" display="text"/>
						<cell col="15" colid="EMAIL1" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_save" ImageID="btn_c_2" Left="894" LeftMargin="5" OnClick="btn_Save_OnClick" Style="sty_btn_c" TabOrder="5" Text="저장" Top="568" Visible="FALSE" Width="60"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_delete" ImageID="btn_c_2" Left="956" LeftMargin="5" OnClick="btn_Delete_OnClick" Style="sty_btn_c" TabOrder="6" Text="삭제" Top="568" Visible="FALSE" Width="60"></Button>
		<Div Border="Raised" Height="68" Id="div_process1" Left="8" Style="sty_div_input" TabOrder="7" Text="Div0" Top="496" Width="1008">
			<Contents>
				<Static Align="Right" Border="None" Height="20" Id="Static2" Left="2" Style="sty_lb_Basic" TabOrder="1" Text="담당업무" Top="34" VAlign="Middle" Width="70"></Static>
				<Static Align="Right" Border="None" Height="20" Id="Static3" Left="22" Style="sty_lb_Basic" TabOrder="2" Text="부서" Top="10" VAlign="Middle" Width="46"></Static>
				<Edit Align="CENTER" BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="INDEPT" Enable="FALSE" Height="20" Id="Edit2" ImeMode="english" Left="78" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="10" UpperOnly="TRUE" UseIME="FALSE" Width="72"></Edit>
				<Static Align="Right" Border="None" Height="20" Id="Static6" Left="366" Style="sty_lb_Basic" TabOrder="4" Text="소속" Top="10" VAlign="Middle" Width="40"></Static>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="BOOSER" Enable="FALSE" Height="20" Id="Edit8" ImeMode="english" Left="154" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="5" Top="10" UpperOnly="TRUE" UseIME="FALSE" Width="188"></Edit>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="SOSOK" Enable="FALSE" Height="20" Id="Edit5" ImeMode="english" Left="414" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="6" Top="10" UpperOnly="TRUE" UseIME="FALSE" Width="304"></Edit>
				<Static Align="Right" Border="None" Height="20" Id="Static1" Left="714" Style="sty_lb_Basic" TabOrder="7" Text="직군" Top="10" VAlign="Middle" Width="46"></Static>
				<Static Align="Right" Border="None" Height="20" Id="Static4" Left="850" Style="sty_lb_Basic" TabOrder="8" Text="직위" Top="34" VAlign="Middle" Width="46"></Static>
				<Static Align="Right" Border="None" Height="20" Id="Static5" Left="842" Style="sty_lb_Basic" TabOrder="9" Text="직책" Top="10" VAlign="Middle" Width="54"></Static>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="JBGRP" Enable="FALSE" Height="20" Id="Edit3" ImeMode="english" Left="766" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="10" Top="10" UpperOnly="TRUE" UseIME="FALSE" Width="88"></Edit>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="JBRANK" Enable="FALSE" Height="20" Id="Edit4" ImeMode="english" Left="906" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="11" Top="34" UpperOnly="TRUE" UseIME="FALSE" Width="88"></Edit>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="JBCHARGE" Enable="FALSE" Height="20" Id="Edit6" ImeMode="english" Left="906" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="12" Top="10" UpperOnly="TRUE" UseIME="FALSE" Width="88"></Edit>
				<Static Align="Right" Border="None" Height="20" Id="Static7" Left="346" Style="sty_lb_Basic" TabOrder="13" Text="근무주소" Top="34" VAlign="Middle" Width="64"></Static>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="WRKADDR" Enable="FALSE" Height="20" Id="Edit0" ImeMode="english" Left="414" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="14" Top="34" UpperOnly="TRUE" UseIME="FALSE" Width="440"></Edit>
				<Edit BindDataset="ds_inf_person_info" Border="Flat" CheckLength="Byte" Column="AFFAIRS1" Enable="FALSE" Height="20" Id="Edit9" ImeMode="english" Left="78" LeftMargin="2" MaxLength="10" RightMargin="2" Style="sty_ipt_form" TabOrder="15" Top="34" UpperOnly="TRUE" UseIME="FALSE" Width="264"></Edit>
			</Contents>
		</Div>
		<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="12" LeftMargin="15" Style="sty_img_tit" TabOrder="8" Text="인사&#32;정보" Top="472" Width="96"></Image>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID  : BASUSM00300
* 업무명      : Group ware 사용자관리
* 프로그램명  : G/W 사용자관리
--------------------------------------------------------------------------------
* 작성자      : 하창주
* 작성일      : 2009.04.22
--------------------------------------------------------------------------------
* 1. 변경이력
수정자        :
수정일        :
수정 내역     :
*******************************************************************************/

/*******************************************************************************
// 1. 전 처리기
*******************************************************************************/
#include "lib::lib_commF.js"
#include "lib::lib_util.js"
#include "lib::lib_commPopup.js"

var FV_ORG_ID; 
var FV_ORG_NM;  

/*******************************************************************************
 * @description    : 최초 폼 로드시 발생 - 이벤트
*******************************************************************************/
function form_OnLoadCompleted(obj)
{
	// 권한 설정
	cf_setAuth(pFrmNum);

	//전송일자 셋팅.
	div_search.cal_staSendDt.Value = addDate(toDay(), -7);
	div_search.cal_endSendDt.Value = toDay();
	
    FV_ORG_ID = gds_session.GetColumn(0,"orgId");
    FV_ORG_NM = gds_session.GetColumn(0,"orgNm");

	div_search.edt_orgId.value = FV_ORG_ID;
    div_search.edt_orgNm.value = FV_ORG_NM;	
	
	// 공통 코드 설정
	cf_setCommonCodeDsEnv();
	cf_setCommonCode("ds_user_group", "ZBAS_C_00250");	//사용자 그룹
	cf_setCommonCode("ds_duty", "ZBAS_C_00210");		//직책
	cf_setCommonCode("ds_attc_cat", "ZBAS_C_00380");	//소속구분
	cf_checkCommonCode();
	
	//trace(ds_user_group.SaveXML());
}


/*******************************************************************************
 * @description    : 전체 조직 트리 팝업 호출- 이벤트
*******************************************************************************/
function div_search_btn_orgTree_OnClick(obj)
{
    // 조직 트리 팝업 호출
   cf_callOrgTree2("div_search.edt_orgId", "div_search.edt_orgNm","");    
}

/*******************************************************************************
 * @description    : 전체 조직 트리 팝업 호출- 이벤트
*******************************************************************************/
function div_search_edt_orgId_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
    if(nChar == "13"){
        // 조직 트리 팝업 호출
        cf_callOrgTree2("div_search.edt_orgId", "div_search.edt_orgNm",""); 
    }
}

/*******************************************************************************
 * @description    : org OnChar Changed 이벤트
*******************************************************************************/
function div_search_edt_orgId_OnCharChanged(obj,strPreText,strPostText)
{
    if(strPreText != strPostText){
        div_search.edt_orgNm.value = "";
    }   
}


function df_search(obj)
{
	//ds_condition.Clear();
	
	//trace("sta_send_dt : " + div_search.cal_staSendDt.value);
	
	// 조회 조건 설정
	ds_condition.SetColumn(0, "sta_send_dt" , div_search.cal_staSendDt.value);
	ds_condition.SetColumn(0, "end_send_dt" , div_search.cal_endSendDt.value);
	ds_condition.SetColumn(0, "aply_yn" , div_search.cmb_aply_yn.value);
	ds_condition.SetColumn(0, "t_flag" , div_search.cmb_t_flag.value);
	
	var org_id = ds_condition.GetColumn(0, "org_id");
	//반영건의 경우 PS 영업의 조직ID를 넘긴다.
	ds_condition.SetColumn(0, "ps_org_id" , "");
	if ( div_search.cmb_aply_yn.value == "Y" ) {
		ds_condition.SetColumn(0, "ps_org_id" , org_id);
	}
	
	if ( uf_isNull(org_id) ) {
		alert("소속을 선택하세요.");
		return;
	}
		
	//cf_setParam(ds_condition, "sta_send_dt", div_search.cal_staSendDt.value);
	//cf_setParam(ds_condition, "end_send_dt", div_search.cal_endSendDt.value);
	//cf_setParam(ds_condition, "aply_yn", div_search.cmb_aply_yn.value);
	//cf_setParam(ds_condition, "t_flag", div_search.cmb_t_flag.value);
	//cf_setParam(ds_condition, "indept", div_search.cmb_indept.value);
	//trace(ds_condition.SaveXML());

	var sSvcID	= "svcSearch";
	var sInDs	= "ds_condition=ds_condition";
	var sOutDs	= "ds_inf_person_info=ds_inf_person_info";
	var sArg	= "sktst.bas.USM#getInfPersonInfoList";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}


/*******************************************************************************
* 함수명 : f_callBack 
* 기능명 : 트랜잭션 콜백 
* 파라미터
1. sSvcID  : 서비스 아이디
*******************************************************************************/
function f_callBack(sSvcID)
{	
	if (sSvcID == "svcSearch")  {
		//trace(ds_inf_person_info.SaveXML());
		var nCnt = ds_inf_person_info.GetRowCount();
		var nChkCnt = 0;
		var indept = "";
		var aplyYn = "";
		var tFlag = "";
		for (var i = 0; i < nCnt; i++) {
			indept = ds_inf_person_info.GetColumn(i, "indept");
			aplyYn = ds_inf_person_info.GetColumn(i, "aply_yn");
			tFlag = ds_inf_person_info.GetColumn(i, "t_flag");
			
			//성장채널, 강동센터 의 경우
			if ( aplyYn == 'N' && tFlag == 'I' && (indept == "50000035" || indept == "50000059") ) {
				ds_inf_person_info.SetColumn(i, "org_id", "");
				ds_inf_person_info.SetColumn(i, "org_nm", "");
			}
		}

		cf_setOrgDs(ds_inf_person_info);	// 창 닫기 이벤트시 변경여부 채크

	} else if (sSvcID == "addBasUserMgmt")  {

		//if (confirm("재조회 하시겠습니까?") == true) {
			df_search(null);
		//}

	} else if (sSvcID == "deletePerson")  {
		df_search(null);
	} else if (sSvcID == "getIndeptList")  {
		ds_indept.InsertRow(0);
		ds_indept.SetColumn(0, "INDEPT", "");
		ds_indept.SetColumn(0, "BOOSER", "전체");
		div_search.cmb_indept.value = "";
		//trace(ds_indept.SaveXML());
	}

}

/*******************************************************************************
 * @description    : 그리드 팝업- 이벤트
*******************************************************************************/
function grd_list_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
	var sOrgId = ds_inf_person_info.GetColumn(nRow, "ORG_ID");
		
	if (nCell == 6) {	//소속조직
		ds_org.ClearData();
		ds_org.AddRow();
		cf_commPopOrgCdDs("ds_org", 0);
		
		if (ds_org.rowcount > 0) {
			//trace("ORG_NM : " + ds_org.GetColumn(0, "ORG_NM"));
			ds_inf_person_info.SetColumn(nRow, "ORG_ID", ds_org.GetColumn(0, "ORG_ID"));
			ds_inf_person_info.SetColumn(nRow, "ORG_NM", ds_org.GetColumn(0, "ORG_NM"));
			ds_inf_person_info.SetColumn(nRow, "ORG_CL", ds_org.GetColumn(0, "ORG_CL"));
			ds_inf_person_info.SetColumn(nRow, "POS_AGNECY", "");
			ds_inf_person_info.SetColumn(nRow, "POS_AGNECY_NM", "");
			ds_inf_person_info.SetColumn(nRow, "ORG_AREA", "");
			ds_inf_person_info.SetColumn(nRow, "ORG_AREA_NM", "");
		}

	} else if (nCell == 7) {	//소속대리점
		if (sOrgId == null || sOrgId == "" || ds_inf_person_info.GetColumn(nRow, "ORG_NM") == "") {
			alert("소속조직을 먼저 입력 또는 선택해 주십시오.");
			return;
		}
		
		if (ds_inf_person_info.GetColumn(nRow, "ORG_CL") !=  "3" ) {
			alert("소속조직이 영업센터인 경우만 대리점과 근무지를 입력할 수 있습니다.");
			return;
		}
		
		var sArg  = "org_id=" + quote(sOrgId); //필수
		ds_inf_person_info.SetColumn(nRow, "POS_AGENCY", "");
		ds_inf_person_info.SetColumn(nRow, "POS_AGENCY_NM", "");
		cf_callAgencyPop(sArg, ds_inf_person_info, "POS_AGENCY_NM,POS_AGENCY", nRow);
		
		ds_inf_person_info.SetColumn(nRow, "ORG_AREA", "");
		ds_inf_person_info.SetColumn(nRow, "ORG_AREA_NM", "");
	
	} else if (nCell == 8) {	//근무지
		if (sOrgId == null || sOrgId == "" || ds_inf_person_info.GetColumn(nRow, "ORG_NM") == "") {
			alert("소속조직을 먼저 입력 또는 선택해 주십시오.");
			return;
		}
		
		if (ds_inf_person_info.GetColumn(nRow, "ORG_CL") !=  "3" ) {
			alert("소속조직이 영업센터인 경우만 대리점과 근무지를 입력할 수 있습니다.");
			return;
		}
		
		var sPosAgency = ds_inf_person_info.GetColumn(nRow, "POS_AGENCY");
		if (sPosAgency == null || sPosAgency == "" || ds_inf_person_info.GetColumn(nRow, "POS_AGENCY_NM") == "") {
			alert("소속대리점을 먼저 입력해 주십시오");
			return;
		}
		
		var sArg  = "deal_co_cl1=" + quote("A1,A2,A3,B1,B2"); // 필수 - 대리점
		sArg += " org_id=" + quote(sOrgId); // 옵션 - 소속조직
		sArg += " pos_agency=" + quote(sPosAgency); // 옵션 - 소속대리점
		trace("sArg : " + sArg);
		ds_inf_person_info.SetColumn(nRow, "ORG_AREA", "");
		ds_inf_person_info.SetColumn(nRow, "ORG_AREA_NM", "");
		cf_callDealPop(sArg, ds_inf_person_info, "ORG_AREA_NM,ORG_AREA", nRow);
		
	} else if (nCell == 9) {
		//alert("소속구분 선택");
	}
}

/*******************************************************************************
 * @description    : 저장
*******************************************************************************/
function btn_Save_OnClick(obj)
{
	//Vaild Chack
	var nCnt = ds_inf_person_info.GetRowCount();
	var nChkCnt = 0;
	var indept = ""; //HR부서코드
	var ordId = "";	//소속조직
	
	for (var i = 0; i < nCnt; i++) {
		if (ds_inf_person_info.GetColumn(i, "chk") == "1") {
			if (ds_inf_person_info.GetColumn(i, "duty") != "9" && ds_inf_person_info.GetColumn(i, "empno") == "" ) {
				alert("사번을 입력하십시오.");
				return false;
			} else if (ds_inf_person_info.GetColumn(i, "user_grp") == null || ds_inf_person_info.GetColumn(i, "user_grp") == "") {
				alert("사용자그룹을 선택하십시오.");
				return false;
			} else if (ds_inf_person_info.GetColumn(i, "duty") == null || ds_inf_person_info.GetColumn(i, "duty") == "") {
				alert("직책을 선택하십시오.");
				return false;
			} else if (ds_inf_person_info.GetColumn(i, "org_id") == null || ds_inf_person_info.GetColumn(i, "org_id") == "") {
				alert("소속조직을 입력해주십시오.");
				ds_inf_person_info.SetColumn(i, "org_nm", "");
				return false;
			} else if (ds_inf_person_info.GetColumn(i, "attc_cat") == null || ds_inf_person_info.GetColumn(i, "attc_cat") == "") {
				alert("소속구분을 선택하십시오.");
				return false;
			}

			//HR부서코드가 중복되는 소속의 경우 강제로 조건 처리함
			indept = ds_inf_person_info.GetColumn(i, "indept");
			orgId = ds_inf_person_info.GetColumn(i, "org_id");
			//alert(indept + " : " + orgId);
			
			//성장채널 의 경우
			if ( indept == "50000035" && orgId != "C19970" && orgId != "C10011" ) {
				alert("선택할 수 없는 소속조직입니다.");
				return false;
			}
			//강동센터 의 경우
			if ( indept == "50000059" && orgId != "C10007" && orgId != "C10005" ) {
				alert("선택할 수 없는 소속조직입니다.");
				return false;
			}

			nChkCnt++;
		}
	}

	if (nChkCnt ==  0) {
		alert("처리대상건이 존재하지 않습니다.");
		return;
	}

	if (confirm("저장 하시겠습니까?") == true) {
		var sSvcID 	= "addBasUserMgmt";
		var sInDs 	= "ds_inf_person_info=ds_inf_person_info";
		var sOutDs 	= "";
		var sArg 	= "sktst.bas.USM#addBasUserMgmt";

		// 공통 트랜잭션 호출
		cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	}
}


function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "ATTC_CAT")
	{
		//var attc_cat = obj.GetColumn(nRow, "ATTC_CAT");
		//alert(varOldValue + " : " + varNewValue);
		if (obj.GetColumn(nRow, "NOEMPLOYEE_YN") == "Y" && varNewValue != "9" ) {
			alert("비직원인 경우 소속구분은 비직원이어야 합니다.[변경 불가]");
			obj.SetColumn(nRow, "ATTC_CAT", varOldValue);
		} else if (obj.GetColumn(nRow, "NOEMPLOYEE_YN") == "N" && varNewValue == "9" ) {
			alert("직원인 경우 소속구분을 비직원 선택이 불가합니다.");
			obj.SetColumn(nRow, "ATTC_CAT", varOldValue);
		}
	}
}


/*******************************************************************************
 * @description    : 삭제
*******************************************************************************/
function btn_Delete_OnClick(obj)
{
	//Vaild Chack
	var nCnt = ds_inf_person_info.GetRowCount();
	var nChkCnt = 0;
	for (var i = 0; i < nCnt; i++) {
		if (ds_inf_person_info.GetColumn(i, "chk") == "1") {
			nChkCnt++;
		}
	}
	
	if (nChkCnt ==  0) {
		alert("처리대상건이 존재하지 않습니다.");
		return;
	}

	if (confirm("PS 영업시스템의 사용자 대상에서 제외하시겠습니까?") == true) {
		
		var sSvcID 	= "deletePerson";
		var sInDs 	= "ds_inf_person_info=ds_inf_person_info";
		var sOutDs 	= "";
		var sArg 	= "sktst.bas.USM#deletePerson";
	
		// 공통 트랜잭션 호출
		cf_Transaction(sSvcID, sInDs, sOutDs, sArg);

	}
}

function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if (nCell < 1) {
		var nChekValue = obj.getCellProp("head", 0, "text");

		if (nChekValue == "0" || nChekValue == "") {
			nChekValue = 1;
		} else {
			nChekValue = 0;
		}
		
		obj.setCellProp("head", 0, "text", nChekValue);
		
		var nRow = ds_inf_person_info.rowcount;
		
		for (var i = 0; i < nRow; i++) {
			if ( ds_inf_person_info.GetColumn(i, "aply_yn") != "Y" && ds_inf_person_info.GetColumn(i, "t_flag") != "X") {
				ds_inf_person_info.SetColumn(i, "chk", nChekValue);
			}
		}
		
	} else {
		//cf_markGridSort(obj,nCell,nX,nY,nPivotIndex);
	}
}
]]></Script>
</Window>