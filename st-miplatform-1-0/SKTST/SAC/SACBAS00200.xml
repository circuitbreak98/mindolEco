<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="600" Id="SACBAS00200" Left="8" OnLoadCompleted="SACBAS00200_OnLoadCompleted" PidAttrib="7" Title="분개기준등록" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents>
					<colinfo id="jour_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_typ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jour_std_info">
				<Contents>
					<colinfo id="dis_jour_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="dis_jour_cd_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="dis_acc_typ" size="256" summ="default" type="STRING"/>
					<colinfo id="seq_no" size="256" summ="default" type="STRING"/>
					<colinfo id="dis_firt_key" size="256" summ="default" type="STRING"/>
					<colinfo id="spec_gl" size="256" summ="default" type="STRING"/>
					<colinfo id="dis_dc_cat" size="256" summ="default" type="STRING"/>
					<colinfo id="dis_inv_firt_key" size="256" summ="default" type="STRING"/>
					<colinfo id="inv_spec_gl" size="256" summ="default" type="STRING"/>
					<colinfo id="gl_acc" size="256" summ="default" type="STRING"/>
					<colinfo id="gl_acc_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="occu_typ" size="256" summ="default" type="STRING"/>
					<colinfo id="cust_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_cond" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_def" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_mth" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_init_dt" size="256" summ="default" type="STRING"/>
					<colinfo id="ref1" size="256" summ="default" type="STRING"/>
					<colinfo id="ref2" size="256" summ="default" type="STRING"/>
					<colinfo id="ref3" size="256" summ="default" type="STRING"/>
					<colinfo id="ref4" size="256" summ="default" type="STRING"/>
					<colinfo id="ref5" size="256" summ="default" type="STRING"/>
					<colinfo id="remark" size="256" summ="default" type="STRING"/>
					<colinfo id="jour_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_typ" size="256" summ="default" type="STRING"/>
					<colinfo id="firt_key" size="256" summ="default" type="STRING"/>
					<colinfo id="dc_cat" size="256" summ="default" type="STRING"/>
					<colinfo id="inv_firt_key" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="action" size="256" summ="default" type="STRING"/>
					<colinfo id="jour_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="acc_typ" size="256" summ="default" type="STRING"/>
					<colinfo id="seq_no" size="256" summ="default" type="STRING"/>
					<colinfo id="firt_key" size="256" summ="default" type="STRING"/>
					<colinfo id="spec_gl" size="256" summ="default" type="STRING"/>
					<colinfo id="dc_cat" size="256" summ="default" type="STRING"/>
					<colinfo id="inv_firt_key" size="256" summ="default" type="STRING"/>
					<colinfo id="inv_spec_gl" size="256" summ="default" type="STRING"/>
					<colinfo id="gl_acc" size="256" summ="default" type="STRING"/>
					<colinfo id="gl_acc_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="occu_typ" size="256" summ="default" type="STRING"/>
					<colinfo id="cust_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_cond" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_def" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_mth" size="256" summ="default" type="STRING"/>
					<colinfo id="pay_init_dt" size="256" summ="default" type="STRING"/>
					<colinfo id="ref1" size="256" summ="default" type="STRING"/>
					<colinfo id="ref2" size="256" summ="default" type="STRING"/>
					<colinfo id="ref3" size="256" summ="default" type="STRING"/>
					<colinfo id="ref4" size="256" summ="default" type="STRING"/>
					<colinfo id="ref5" size="256" summ="default" type="STRING"/>
					<colinfo id="remark" size="256" summ="default" type="STRING"/>
					<colinfo id="user_id" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents>
					<colinfo id="result" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AutoFit="TRUE" BindDataset="ds_jour_std_info" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="347" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="22" Height="312" Id="grd_list" InputPanel="FALSE" Left="10" LineColor="user33" MinWidth="100" OnCellClick="grd_list_OnCellClick" Right="1014" RowHeight="21" Style="sty_Grid" TabOrder="2" TabStop="true" Top="35" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="1004">
			<contents>
				<format id="Default">
					<columns>
						<col width="90"/>
						<col width="141"/>
						<col width="80"/>
						<col width="50"/>
						<col width="60"/>
						<col width="79"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="200"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" font="돋움,10,Bold" text="전송항목코드"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" font="돋움,10,Bold" text="전송항목코드명"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" font="돋움,10,Bold" text="전표유형"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" font="돋움,10,Bold" text="No"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" font="돋움,10,Bold" text="전기키"/>
						<cell bkcolor="user34" col="5" color="user35" display="text" font="돋움,10,Bold" text="특별&#32;GL"/>
						<cell bkcolor="user34" col="6" color="user35" display="text" font="돋움,10,Bold" text="차/대"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" font="돋움,10,Bold" text="역전기키"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" font="돋움,10,Bold" text="역특별&#32;GL"/>
						<cell bkcolor="user34" col="9" color="user35" display="text" font="돋움,10,Bold" text="GL&#32;계정"/>
						<cell bkcolor="user34" col="10" color="user35" display="text" font="돋움,10,Bold" text="계정내역"/>
						<cell col="11" display="text"/>
						<cell col="12" display="text"/>
						<cell col="13" display="text"/>
						<cell col="14" display="text"/>
						<cell col="15" display="text"/>
						<cell col="16" display="text"/>
						<cell col="17" display="text"/>
						<cell col="18" display="text"/>
						<cell col="19" display="text"/>
						<cell col="20" display="text"/>
						<cell col="20" display="text"/>
						<cell col="21" display="text"/>
						<cell col="22" display="text"/>
						<cell col="23" display="text"/>
						<cell col="24" display="text"/>
						<cell col="25" display="text"/>
						<cell col="26" display="text"/>
						<cell col="27" display="text"/>
					</head>
					<body>
						<cell align="center" col="0" colid="dis_jour_cd" display="text"/>
						<cell col="1" colid="dis_jour_cd_nm" display="text"/>
						<cell align="center" col="2" colid="dis_acc_typ" display="text"/>
						<cell align="center" col="3" colid="seq_no" display="text"/>
						<cell align="center" col="4" colid="dis_firt_key" display="text"/>
						<cell align="center" col="5" colid="spec_gl" display="text"/>
						<cell align="center" col="6" colid="dis_dc_cat" display="text"/>
						<cell align="center" col="7" colid="dis_inv_firt_key" display="text"/>
						<cell align="center" col="8" colid="inv_spec_gl" display="text"/>
						<cell align="center" col="9" colid="gl_acc" display="text"/>
						<cell col="10" colid="gl_acc_nm" display="text"/>
						<cell col="11" colid="occu_typ" display="text"/>
						<cell col="12" colid="cust_yn" display="text"/>
						<cell col="13" colid="pay_cond" display="text"/>
						<cell col="14" colid="pay_def" display="text"/>
						<cell col="15" colid="pay_mth" display="text"/>
						<cell col="16" colid="pay_init_dt" display="text"/>
						<cell col="17" colid="ref1" display="text"/>
						<cell col="18" colid="ref2" display="text"/>
						<cell col="19" colid="ref3" display="text"/>
						<cell col="20" colid="ref4" display="text"/>
						<cell col="21" colid="ref5" display="text"/>
						<cell col="22" colid="remark" display="text"/>
						<cell col="23" colid="jour_cd" display="text"/>
						<cell col="24" colid="acc_typ" display="text"/>
						<cell col="25" colid="firt_key" display="text"/>
						<cell col="26" colid="dc_cat" display="text"/>
						<cell col="27" colid="inv_firt_key" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="25" Id="Image3" ImageID="bul_tit" Left="10" LeftMargin="15" Style="sty_img_tit" TabOrder="1" Text="분개&#32;기준정보" Top="10" Width="192"></Image>
		<Div Border="Raised" Height="205" Id="div_dtl_info" Left="10" Style="sty_div_dataview" TabOrder="3" Text="Div1" Top="357" Width="1004">
			<Contents>
				<Static Align="Right" Height="20" Id="Static6" Left="37" Style="sty_lb_Search" TabOrder="1" Text="발생유형" Top="7" VAlign="Middle" Width="60"></Static>
				<Static Align="Right" Height="20" Id="Static0" Left="23" Style="sty_lb_Search" TabOrder="3" Text="전송항목" Top="30" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static1" Left="23" Style="sty_lb_Search" TabOrder="6" Text="전표유형" Top="53" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static2" Left="23" Style="sty_lb_Search" TabOrder="7" Text="순번" Top="76" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static5" Left="354" Style="sty_lb_Search" TabOrder="9" Text="GL&#32;계정" Top="53" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static7" Left="308" Style="sty_lb_Search" TabOrder="10" Text="거래처&#32;발생유무" Top="77" VAlign="Middle" Width="120"></Static>
				<Static Align="Right" Height="20" Id="Static8" Left="740" Style="sty_lb_Search" TabOrder="12" Text="참고&#32;3" Top="77" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static9" Left="740" Style="sty_lb_Search" TabOrder="14" Text="참고&#32;4" Top="100" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static10" Left="740" Style="sty_lb_Search" TabOrder="16" Text="참고&#32;5" Top="123" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static11" Left="23" Style="sty_lb_Search" TabOrder="17" Text="전기키" Top="98" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static12" Left="23" Style="sty_lb_Search" TabOrder="21" Text="특별&#32;GL" Top="122" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static13" Left="23" Style="sty_lb_Search" TabOrder="23" Text="차대구분" Top="145" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static14" Left="354" Style="sty_lb_Search" TabOrder="24" Text="역전기키" Top="7" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static3" Left="354" Style="sty_lb_Search" TabOrder="27" Text="역특별&#32;GL" Top="30" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static4" Left="308" Style="sty_lb_Search" TabOrder="31" Text="지급조건" Top="100" VAlign="Middle" Width="120"></Static>
				<Static Align="Right" Height="20" Id="Static15" Left="308" Style="sty_lb_Search" TabOrder="33" Text="지급보류" Top="123" VAlign="Middle" Width="120"></Static>
				<Static Align="Right" Height="20" Id="Static16" Left="308" Style="sty_lb_Search" TabOrder="35" Text="지급방법" Top="146" VAlign="Middle" Width="120"></Static>
				<Static Align="Right" Height="20" Id="Static17" Left="694" Style="sty_lb_Search" TabOrder="37" Text="지급기산일" Top="7" VAlign="Middle" Width="120"></Static>
				<Static Align="Right" Height="20" Id="Static18" Left="740" Style="sty_lb_Search" TabOrder="40" Text="참고&#32;1" Top="30" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static19" Left="740" Style="sty_lb_Search" TabOrder="42" Text="참고&#32;2" Top="53" VAlign="Middle" Width="74"></Static>
				<Static Align="Right" Height="20" Id="Static20" Left="4" Style="sty_lb_Search" TabOrder="44" Text="비고(금액로직)" Top="169" VAlign="Middle" Width="93"></Static>
				<Combo Border="Flat" Height="21" Id="cmb_occu_typ" Left="99" Style="sty_ipt_form" TabOrder="2" Top="7" Width="125"></Combo>
				<Combo Border="Flat" Height="21" Id="cmb_jour_cd" Left="99" Style="sty_ipt_form" TabOrder="4" Top="30" Width="125"></Combo>
				<Combo Border="Flat" Height="21" Id="cmb_acc_typ" Left="99" Style="sty_ipt_form" TabOrder="5" Top="53" Width="125"></Combo>
				<Edit Border="Flat" Height="20" Id="edt_seq_no" Left="100" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="18" Top="77" Width="70"></Edit>
				<Combo Border="Flat" Height="21" Id="cmb_firt_key" Left="99" Style="sty_ipt_form" TabOrder="19" Top="99" Width="125"></Combo>
				<Edit Border="Flat" Height="20" Id="edt_spec_gl" Left="100" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="20" Top="123" Width="125"></Edit>
				<Combo Border="Flat" Height="21" Id="cmb_dc_cat" Left="99" Style="sty_ipt_form" TabOrder="22" Top="145" Width="125">
					<Contents>
						<Record Code="1" Data="차변"/>
						<Record Code="2" Data="대변"/>
					</Contents>
				</Combo>
				<Edit Border="Flat" Height="20" Id="edt_gl_acc" Left="431" LeftMargin="2" OnCharChanged="div_dtl_info_edt_gl_acc_OnCharChanged" OnKeyDown="div_dtl_info_edt_gl_acc_OnKeyDown" RightMargin="2" Style="sty_ipt_form" TabOrder="8" Top="53" Width="125"></Edit>
				<Combo Border="Flat" Height="21" Id="cmb_inv_firt_key" Left="430" Style="sty_ipt_form" TabOrder="25" Top="4" Width="125"></Combo>
				<Edit Border="Flat" Height="20" Id="edt_inv_spec_gl" Left="431" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="26" Top="30" Width="125"></Edit>
				<Button Height="21" Id="btn_salePlc" ImageID="btn_i_detail" Left="554" OnClick="div_general_btn_salePlc_OnClick" TabOrder="28" Text="Button0" Top="53" Width="19"></Button>
				<Edit Border="Flat" Enable="FALSE" Height="20" Id="edt_gl_acc_nm" Left="573" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="29" Top="53" Width="125"></Edit>
				<Combo Border="Flat" Height="21" Id="cmb_cust_yn" Left="430" Style="sty_ipt_form" TabOrder="30" Top="77" Width="125">
					<Contents>
						<Record Code="Y" Data="Y"/>
						<Record Code="N" Data="N"/>
					</Contents>
				</Combo>
				<Combo Border="Flat" Height="21" Id="cmb_pay_cond" Left="430" Style="sty_ipt_form" TabOrder="32" Top="100" Width="125"></Combo>
				<Combo Border="Flat" Height="21" Id="cmb_pay_def" Left="430" Style="sty_ipt_form" TabOrder="34" Top="123" Width="125"></Combo>
				<Combo Border="Flat" Height="21" Id="cmb_pay_mth" Left="430" Style="sty_ipt_form" TabOrder="36" Top="146" Width="125"></Combo>
				<Calendar Border="Flat" ButtonImageID="btn_i_calendar" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_pay_init_dt" Left="817" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="38" TodayColor="user26" Top="7" UserData="지급기산일" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="123"></Calendar>
				<Edit Border="Flat" Height="20" Id="edt_ref1" Left="817" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="39" Top="31" Width="125"></Edit>
				<Edit Border="Flat" Height="20" Id="edt_ref2" Left="817" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="41" Top="53" Width="125"></Edit>
				<Edit Border="Flat" Height="20" Id="edt_ref3" Left="817" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="11" Top="77" Width="125"></Edit>
				<Edit Border="Flat" Height="20" Id="edt_ref4" Left="817" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="13" Top="100" Width="125"></Edit>
				<Edit Border="Flat" Height="20" Id="edt_ref5" Left="817" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="15" Top="123" Width="125"></Edit>
				<Edit Border="Flat" Height="20" Id="edt_remark" Left="100" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="43" Top="170" Width="840"></Edit>
				<Image Height="21" Id="Image1" ImageID="bul_mand" Left="32" TabOrder="45" Top="6" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image0" ImageID="bul_mand" Left="32" TabOrder="46" Top="30" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image2" ImageID="bul_mand" Left="32" TabOrder="47" Top="53" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image3" ImageID="bul_mand" Left="59" TabOrder="48" Top="76" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image4" ImageID="bul_mand" Left="45" TabOrder="49" Top="97" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image5" ImageID="bul_mand" Left="32" TabOrder="50" Top="144" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image6" ImageID="bul_mand" Left="364" TabOrder="51" Top="6" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image7" ImageID="bul_mand" Left="364" TabOrder="52" Top="51" Transparent="TRUE" Width="20"></Image>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_cancel" ImageID="btn_c_2" Left="953" LeftMargin="5" OnClick="btn_cancel_OnClick" Style="sty_btn_c" TabOrder="4" Text="취소" Top="565" Width="60"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="Button0" ImageID="btn_c_2" Left="889" LeftMargin="5" OnClick="btn_save_OnClick" Style="sty_btn_c" TabOrder="5" Text="저장" Top="565" Width="60"></Button>
		<Button Cursor="HAND" Height="21" Id="Button58" ImageID="btn_i_add_w" Left="971" OnClick="Button58_OnClick" TabOrder="7" Text="Button1" ToolTipText="행추가" Top="10" Width="19"></Button>
		<Button Cursor="HAND" Height="21" Id="Button55" ImageID="btn_i_subtract_w" Left="994" OnClick="Button55_OnClick" TabOrder="6" Text="Button1" ToolTipText="추가된&#32;행삭제" Top="10" Width="19"></Button>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID  : SACBAS00200
* 업무명      : 판매회계
* 프로그램명  : 기준정보등록
--------------------------------------------------------------------------------
* 작성자      : 은준기
* 작성일      : 2009.04.24
--------------------------------------------------------------------------------
* 1. 변경이력
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

//==============================================================================
// 공통 스크립트 로딩
//==============================================================================
#include "lib::lib_commF.js"
#include "lib::lib_util.js"
#include "lib::lib_commPopup.js"

//==============================================================================
// 전역변수선언
//==============================================================================
var FV_LOGIN_ID = gds_session.GetColumn(0, "loginId");		//사용자계정
var FV_ORG_ID = gds_session.GetColumn(0, "orgId");			//조직코드
var FV_ORG_CL = gds_session.GetColumn(0, "orgCl");			//조직구분
var FV_SUP_ORG_ID = gds_session.GetColumn(0, "supOrgId");	//상위조직코드
var FV_USER_GRP = gds_session.GetColumn(0, "userGrp");		//사용자그룹
var FV_ORG_AREA = gds_session.GetColumn(0, "orgAreaId");	//근무지코드
var FV_POS_AGENCY_ID = gds_session.GetColumn(0,"posAgencyId");         	// 소속 대리점ID
var FV_POS_AGENCY_NM = gds_session.GetColumn(0,"posAgencyNm");       	// 소속 대리점명
var FV_POS_AGENCY_UKEY_ID = gds_session.GetColumn(0,"posAgencyUkeyId"); // 소속 대리점UKEY ID

var FV_ACTION;
var FV_OCCU_TYP;
var FV_JOUR_CD;
var FV_ACC_TYP;

var FV_OCCU_TYP_TMP;
var FV_JOUR_CD_TMP;
var FV_ACC_TYP_TMP;
var FV_SEQ_NO_TMP;
var FV_FIRT_KEY_TMP;
var FV_SPEC_GL_TMP;
var FV_DC_CAT_TMP;
var FV_INV_FIRT_KEY_TMP;
var FV_INV_SPEC_GL_TMP;
var FV_GL_ACC_TMP;
var FV_GL_ACC_NM_TMP;
var FV_CUST_YN_TMP;
var FV_PAY_COND_TMP;
var FV_PAY_DEF_TMP;
var FV_PAY_MTH_TMP;
var FV_PAY_INIT_DT_TMP;
var FV_REF1_TMP;
var FV_REF2_TMP;
var FV_REF3_TMP;
var FV_REF4_TMP;
var FV_REF5_TMP;
var FV_REMARK_TMP;

function SACBAS00200_OnLoadCompleted(obj)
{
	cf_setAuth(pFrmNum);

	// 공통 코드를 위한 데이타셋 설정
	cf_setCommonCodeDsEnv();

	cf_setCommonCode("div_dtl_info.cmb_occu_typ"    , "ZSAC_C_00070"); // 발생유형 : ZSAC_C_00070
	cf_setCommonCode("div_dtl_info.cmb_jour_cd"     , "ZSAC_C_00060"); // 전송항목 : ZSAC_C_00060
	cf_setCommonCode("div_dtl_info.cmb_acc_typ"     , "ZSAC_C_00040"); // 전표유형 : ZSAC_C_00040
	cf_setCommonCode("div_dtl_info.cmb_pay_cond"    , "ZSAC_C_00010"); // 지급조건 : ZSAC_C_00010
	cf_setCommonCode("div_dtl_info.cmb_pay_def"     , "ZSAC_C_00020"); // 지급보류 : ZSAC_C_00020
	cf_setCommonCode("div_dtl_info.cmb_pay_mth"     , "ZSAC_C_00030"); // 지급방법 : ZSAC_C_00030
	cf_setCommonCode("div_dtl_info.cmb_firt_key"    , "ZSAC_C_00050"); // 전기키 : ZSAC_C_00050
	cf_setCommonCode("div_dtl_info.cmb_inv_firt_key", "ZSAC_C_00050"); // 역전기키 : ZSAC_C_00050	// 설정된 코드를 기반으로 공통 코드를 추가 및 데이타 바인딩
	http.Sync  = true;
	cf_checkCommonCode();
	
	FV_ACTION   = action;
	FV_OCCU_TYP = occu_typ;
	FV_JOUR_CD  = jour_cd;
	FV_ACC_TYP  = acc_typ;

	f_init();	//폼 초기화 
	http.Sync  = false;
}

function f_init()
{
    div_dtl_info.cmb_occu_typ.value = "";
    div_dtl_info.cmb_jour_cd.value  = "";
    div_dtl_info.cmb_acc_typ.value  = "";
    div_dtl_info.cmb_pay_cond.value     = "";
    div_dtl_info.cmb_pay_def.value      = "";
    div_dtl_info.cmb_pay_mth.value      = "";
    div_dtl_info.cmb_firt_key.value     = "";
    div_dtl_info.cmb_inv_firt_key.value = "";     
     
    if (FV_ACTION == "new" ) {

    } else if (FV_ACTION == "mod" ) {
        div_dtl_info.cmb_occu_typ.value = FV_OCCU_TYP;
        div_dtl_info.cmb_jour_cd.value  = FV_JOUR_CD;
        div_dtl_info.cmb_acc_typ.value  = FV_ACC_TYP;

        div_dtl_info.cmb_occu_typ.Enable = false;
        div_dtl_info.cmb_jour_cd.Enable  = false;
        div_dtl_info.cmb_acc_typ.Enable  = false;
        div_dtl_info.edt_seq_no.Enable   = false;

        jour_std_info_search();
    }
}

function jour_std_info_search()
{
    cf_setParam(ds_condition, "jour_cd", FV_JOUR_CD);
	cf_setParam(ds_condition, "acc_typ", FV_ACC_TYP);
	
	var sSvcID = "svcList";
	var sInDs = "nc_input_fieldDs=ds_condition";
	var sOutDs = "ds_jour_std_info=ds_jour_std_info_for_acc_typ";
	var sArg = "sktst.sac.BAS#getJourStdInfoforAccTyp";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}

function f_callBack(sSvcID){
	switch(sSvcID)
	{
	case "svcList":
        set_dtl_info(grd_list,0);
		break;
	case "ProcResult":
        if (FV_ACTION == "new" ) {
	        alert("등록이 완료되었습니다.");
	        FV_ACTION = "mod";
	        FV_OCCU_TYP = div_dtl_info.cmb_occu_typ.value;
            FV_JOUR_CD = div_dtl_info.cmb_jour_cd.value;
	        FV_ACC_TYP = div_dtl_info.cmb_acc_typ.value;

            div_dtl_info.cmb_occu_typ.Enable = false;
            div_dtl_info.cmb_jour_cd.Enable  = false;
            div_dtl_info.cmb_acc_typ.Enable  = false;
            div_dtl_info.edt_seq_no.Enable   = false;

	        jour_std_info_search();
        } else if (FV_ACTION == "mod" ) {
	        alert("수정이 완료되었습니다.");
	        jour_std_info_search();
	    }
		break;
	default:
		break;	
	}	
}

function btn_cancel_OnClick(obj)
{
	Close();
}


function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    set_dtl_info(obj,nRow);
}


function set_dtl_info(obj,nRow)
{
    FV_OCCU_TYP_TMP       = " " + obj.GetCellValue(nRow,11);
    FV_JOUR_CD_TMP        = " " + obj.GetCellValue(nRow,23);
    FV_ACC_TYP_TMP        = " " + obj.GetCellValue(nRow,24);
    FV_SEQ_NO_TMP         = " " + obj.GetCellValue(nRow,3);
    FV_FIRT_KEY_TMP       = " " + obj.GetCellValue(nRow,25);
    FV_SPEC_GL_TMP        = " " + obj.GetCellValue(nRow,5);
    FV_DC_CAT_TMP         = " " + obj.GetCellValue(nRow,26);
    FV_INV_FIRT_KEY_TMP   = " " + obj.GetCellValue(nRow,27);
    FV_INV_SPEC_GL_TMP    = " " + obj.GetCellValue(nRow,8);
    FV_GL_ACC_TMP         = " " + obj.GetCellValue(nRow,9);
    FV_GL_ACC_NM_TMP      = " " + obj.GetCellValue(nRow,10);
    FV_CUST_YN_TMP        = " " + obj.GetCellValue(nRow,12);
    FV_PAY_COND_TMP       = " " + obj.GetCellValue(nRow,13);
    FV_PAY_DEF_TMP        = " " + obj.GetCellValue(nRow,14);
    FV_PAY_MTH_TMP        = " " + obj.GetCellValue(nRow,15);
    FV_PAY_INIT_DT_TMP    = " " + obj.GetCellValue(nRow,16);
    FV_REF1_TMP           = " " + obj.GetCellValue(nRow,17);
    FV_REF2_TMP           = " " + obj.GetCellValue(nRow,18);
    FV_REF3_TMP           = " " + obj.GetCellValue(nRow,19);
    FV_REF4_TMP           = " " + obj.GetCellValue(nRow,20);
    FV_REF5_TMP           = " " + obj.GetCellValue(nRow,21);
    FV_REMARK_TMP         = " " + obj.GetCellValue(nRow,22);

	div_dtl_info.cmb_occu_typ.value     = obj.GetCellValue(nRow,11);
    div_dtl_info.cmb_jour_cd.value      = obj.GetCellValue(nRow,23);
    div_dtl_info.cmb_acc_typ.value      = obj.GetCellValue(nRow,24);
	div_dtl_info.edt_seq_no.Text        = obj.GetCellValue(nRow,3);
    div_dtl_info.cmb_firt_key.value     = obj.GetCellValue(nRow,25);
    div_dtl_info.edt_spec_gl.Text       = obj.GetCellValue(nRow,5);
    div_dtl_info.cmb_dc_cat.value       = obj.GetCellValue(nRow,26);
    div_dtl_info.cmb_inv_firt_key.value = obj.GetCellValue(nRow,27);
    div_dtl_info.edt_inv_spec_gl.Text   = obj.GetCellValue(nRow,8);
    div_dtl_info.edt_gl_acc.Text        = obj.GetCellValue(nRow,10);
    div_dtl_info.edt_gl_acc_nm.Text     = obj.GetCellValue(nRow,9);
    div_dtl_info.cmb_cust_yn.value      = obj.GetCellValue(nRow,12);
    div_dtl_info.cmb_pay_cond.value     = obj.GetCellValue(nRow,13);
    div_dtl_info.cmb_pay_def.value      = obj.GetCellValue(nRow,14);
    div_dtl_info.cmb_pay_mth.value      = obj.GetCellValue(nRow,15);
    div_dtl_info.cal_pay_init_dt.Text   = obj.GetCellValue(nRow,16);
    div_dtl_info.edt_ref1.Text          = obj.GetCellValue(nRow,17);
    div_dtl_info.edt_ref2.Text          = obj.GetCellValue(nRow,18);
    div_dtl_info.edt_ref3.Text          = obj.GetCellValue(nRow,19);
    div_dtl_info.edt_ref4.Text          = obj.GetCellValue(nRow,20);
    div_dtl_info.edt_ref5.Text          = obj.GetCellValue(nRow,21);
    div_dtl_info.edt_remark.Text        = obj.GetCellValue(nRow,22);
}

function btn_save_OnClick(obj)
{
    var strMessage;

    if ( div_dtl_info.cmb_occu_typ.Index == -1 ) {
        alert("발생유형을 선택하여 주십시요.");
        div_dtl_info.cmb_occu_typ.SetFocus();
        return;
    }
    if ( div_dtl_info.cmb_jour_cd.Index == -1 ) {
        alert("전송항목을 선택하여 주십시요.");
        div_dtl_info.cmb_jour_cd.SetFocus();
        return;
    }
    if ( div_dtl_info.cmb_acc_typ.Index == -1 ) {
        alert("전표유현을 선택하여 주십시요.");
        div_dtl_info.cmb_acc_typ.SetFocus();
        return;
    }
    if ( div_dtl_info.edt_seq_no.value == "" ) {
        alert("순번을 입력하여 주십시요.");
        div_dtl_info.edt_seq_no.SetFocus();
        return;
    }
    if ( div_dtl_info.cmb_firt_key.Index == -1 ) {
        alert("전기키을 선택하여 주십시요.");
        div_dtl_info.cmb_firt_key.SetFocus();
        return;
    }
    if ( div_dtl_info.cmb_dc_cat.Index == -1 ) {
        alert("차대구분을 선택하여 주십시요.");
        div_dtl_info.cmb_dc_cat.SetFocus();
        return;
    }
    if ( div_dtl_info.cmb_inv_firt_key.Index == -1 ) {
        alert("역전기키을 선택하여 주십시요.");
        div_dtl_info.cmb_inv_firt_key.SetFocus();
        return;
    }
    if ( div_dtl_info.edt_gl_acc.value == "" ) {
        alert("GL계정을 선택하여 주십시요.");
        div_dtl_info.edt_gl_acc.SetFocus();
        return;
    }

    if(
           FV_OCCU_TYP_TMP     == " " + div_dtl_info.cmb_occu_typ.value
        && FV_JOUR_CD_TMP      == " " + div_dtl_info.cmb_jour_cd.value
        && FV_ACC_TYP_TMP      == " " + div_dtl_info.cmb_acc_typ.value
        && FV_SEQ_NO_TMP       == " " + div_dtl_info.edt_seq_no.value
        && FV_FIRT_KEY_TMP     == " " + div_dtl_info.cmb_firt_key.value
        && FV_SPEC_GL_TMP      == " " + div_dtl_info.edt_spec_gl.value
        && FV_DC_CAT_TMP       == " " + div_dtl_info.cmb_dc_cat.value
        && FV_INV_FIRT_KEY_TMP == " " + div_dtl_info.cmb_inv_firt_key.value
        && FV_INV_SPEC_GL_TMP  == " " + div_dtl_info.edt_inv_spec_gl.value
        && FV_GL_ACC_TMP       == " " + div_dtl_info.edt_gl_acc.value
        && FV_GL_ACC_NM_TMP    == " " + div_dtl_info.edt_gl_acc_nm.value
        && FV_CUST_YN_TMP      == " " + div_dtl_info.cmb_cust_yn.value
        && FV_PAY_COND_TMP     == " " + div_dtl_info.cmb_pay_cond.value
        && FV_PAY_DEF_TMP      == " " + div_dtl_info.cmb_pay_def.value
        && FV_PAY_MTH_TMP      == " " + div_dtl_info.cmb_pay_mth.value
        && FV_PAY_INIT_DT_TMP  == " " + div_dtl_info.cal_pay_init_dt.value
        && FV_REF1_TMP         == " " + div_dtl_info.edt_ref1.value
        && FV_REF2_TMP         == " " + div_dtl_info.edt_ref2.value
        && FV_REF3_TMP         == " " + div_dtl_info.edt_ref3.value
        && FV_REF4_TMP         == " " + div_dtl_info.edt_ref4.value
        && FV_REF5_TMP         == " " + div_dtl_info.edt_ref5.value
        && FV_REMARK_TMP       == " " + div_dtl_info.edt_remark.value
      ) {
        alert("변경된 내용이 없습니다.");
        return;
    } else {
        strMessage = "저장하시겠습니까?";
        
        if(Confirm(strMessage)) {
            jour_std_info_save();
        }

    }
      
}


function jour_std_info_save()
{
    cf_setParam(ds_save, "action"      , FV_ACTION);
    cf_setParam(ds_save, "occu_typ"    , div_dtl_info.cmb_occu_typ.value);
    cf_setParam(ds_save, "jour_cd"     , div_dtl_info.cmb_jour_cd.value);
    cf_setParam(ds_save, "acc_typ"     , div_dtl_info.cmb_acc_typ.value);
    cf_setParam(ds_save, "seq_no"      , div_dtl_info.edt_seq_no.value);
    cf_setParam(ds_save, "firt_key"    , div_dtl_info.cmb_firt_key.value);
    cf_setParam(ds_save, "spec_gl"     , div_dtl_info.edt_spec_gl.value);
    cf_setParam(ds_save, "dc_cat"      , div_dtl_info.cmb_dc_cat.value);
    cf_setParam(ds_save, "inv_firt_key", div_dtl_info.cmb_inv_firt_key.value);
    cf_setParam(ds_save, "inv_spec_gl" , div_dtl_info.edt_inv_spec_gl.value);
    cf_setParam(ds_save, "gl_acc"      , div_dtl_info.edt_gl_acc_nm.value);
    cf_setParam(ds_save, "cust_yn"     , div_dtl_info.cmb_cust_yn.value);
    cf_setParam(ds_save, "pay_cond"    , div_dtl_info.cmb_pay_cond.value);
    cf_setParam(ds_save, "pay_def"     , div_dtl_info.cmb_pay_def.value);
    cf_setParam(ds_save, "pay_mth"     , div_dtl_info.cmb_pay_mth.value);
    cf_setParam(ds_save, "pay_init_dt" , div_dtl_info.cal_pay_init_dt.value);
    cf_setParam(ds_save, "ref1"        , div_dtl_info.edt_ref1.value);
    cf_setParam(ds_save, "ref2"        , div_dtl_info.edt_ref2.value);
    cf_setParam(ds_save, "ref3"        , div_dtl_info.edt_ref3.value);
    cf_setParam(ds_save, "ref4"        , div_dtl_info.edt_ref4.value);
    cf_setParam(ds_save, "ref5"        , div_dtl_info.edt_ref5.value);
    cf_setParam(ds_save, "remark"      , div_dtl_info.edt_remark.value);           
    cf_setParam(ds_save, "user_id"     , FV_LOGIN_ID);

	var sSvcID = "ProcResult";
	var sInDs = "nc_input_fieldDs=ds_save";
	var sOutDs = "ds_result=ds_result";
	var sArg = "sktst.sac.BAS#setJourStdInfo";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
}


function div_general_btn_salePlc_OnClick(obj)
{
	var sArg;
	sArg = 'param1=' + quote(div_dtl_info.edt_gl_acc.Text);
	var sResult = dialog("SAC::SACBAS00900.xml", sArg);
}

function div_dtl_info_edt_gl_acc_OnCharChanged(obj,strPreText,strPostText)
{
	if(strPreText != strPostText){
		div_dtl_info.edt_gl_acc_nm.value = "";
	}
}

function div_dtl_info_edt_gl_acc_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13){
		div_general_btn_salePlc_OnClick();
	}
}

function Button58_OnClick(obj)
{
	var oGrdDs = object(grd_list.BindDataset);
	
	var nRow = oGrdDs.AddRow();
	ds_comm_cd_dtl.SetColumn(nRow,"prt_seq",toNumber(ds_comm_cd_dtl.GetColumn(nRow-1, "prt_seq"))+1);
	ds_comm_cd_dtl.SetColumn(ds_comm_cd_dtl.GetRowPos(),"comm_cd_id",div_header.edt_commCdID.Value);
	ds_comm_cd_dtl.SetColumn(ds_comm_cd_dtl.GetRowPos(),"eff_sta_dt", Mid(GetDate(),0,8));
	ds_comm_cd_dtl.SetColumn(ds_comm_cd_dtl.GetRowPos(),"eff_end_dt",'99991231');
	ds_comm_cd_dtl.SetColumn(ds_comm_Cd_dtl.GetRowPos(),"rgst_cl",'2');
}
]]></Script>
</Window>