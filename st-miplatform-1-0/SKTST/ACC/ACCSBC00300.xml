<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="600" Id="ACCSBC00300" Left="8" OnLoadCompleted="ACCSBC00300_OnLoadCompleted" PidAttrib="7" Title="판매점여신설정" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPEN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRGR_USER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UKEY_AGENCY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UKEY_CHANNEL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="GRT_INSU_CO" size="256" summ="default" type="STRING"/>
					<colinfo id="GRT_INSU_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="INSP_EFF_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="INSP_EXP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="INSP_GUA_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDT_LMT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDT_LMT_AMT_TMP" size="256" summ="default" type="STRING"/>
					<colinfo id="RMN_CRDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_USER" size="256" summ="default" type="STRING"/>
					<colinfo id="RMKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LEFT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_CHECK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condition" OnColumnChanged="ds_condition_OnColumnChanged">
				<Contents>
					<colinfo id="POS_AGENCY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRGR_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UKEY_AGENCY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="dtm_date" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_CHECK" size="256" summ="default" type="STRING"/>
					<record>
						<APPR_CHECK></APPR_CHECK>
						<CHRGR_USER_ID></CHRGR_USER_ID>
						<DEAL_CO_CD></DEAL_CO_CD>
						<DEAL_CO_NM></DEAL_CO_NM>
						<dtm_date></dtm_date>
						<POS_AGENCY></POS_AGENCY>
						<UKEY_AGENCY_CD></UKEY_AGENCY_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cmbUser">
				<Contents>
					<colinfo id="id" size="256" summ="default" type="STRING"/>
					<colinfo id="nm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents>
					<colinfo id="deal_sta_dt" size="256" summ="default" type="STRING"/>
					<colinfo id="chrgr_user_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="deal_co_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="deal_co_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="ukey_agency_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="ukey_channel_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cnt" size="256" summ="default" type="STRING"/>
					<colinfo id="grt_insu_co" size="256" summ="default" type="STRING"/>
					<colinfo id="grt_insu_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="user_id" size="256" summ="default" type="STRING"/>
					<colinfo id="seq" size="256" summ="default" type="STRING"/>
					<colinfo id="bf_crdt_lmt_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="insp_gua_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="crdt_lmt_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmn_crdt" size="256" summ="default" type="STRING"/>
					<colinfo id="pct" size="256" summ="default" type="STRING"/>
					<colinfo id="bf_pct" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="eqp_round_day" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="skt_chag_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chag_dpst_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chag_bond_bamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmks" size="256" summ="default" type="STRING"/>
					<colinfo id="open_yn" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_childPop">
				<Contents>
					<colinfo id="deal_sta_dt" size="256" summ="default" type="STRING"/>
					<colinfo id="chrgr_user_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="deal_co_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="deal_co_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="ukey_agency_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="ukey_channel_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cnt" size="256" summ="default" type="STRING"/>
					<colinfo id="grt_insu_co" size="256" summ="default" type="STRING"/>
					<colinfo id="grt_insu_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="user_id" size="256" summ="default" type="STRING"/>
					<colinfo id="seq" size="256" summ="default" type="STRING"/>
					<colinfo id="bf_crdt_lmt_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="insp_gua_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="crdt_lmt_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmn_crdt" size="256" summ="default" type="STRING"/>
					<colinfo id="pct" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="eqp_round_day" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="skt_chag_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chag_dpst_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chag_bond_bamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmks" size="256" summ="default" type="STRING"/>
					<colinfo id="open_yn" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_resultPop">
				<Contents>
					<colinfo id="deal_sta_dt" size="256" summ="default" type="STRING"/>
					<colinfo id="chrgr_user_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="deal_co_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="deal_co_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="ukey_agency_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="ukey_channel_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cnt" size="256" summ="default" type="STRING"/>
					<colinfo id="grt_insu_co" size="256" summ="default" type="STRING"/>
					<colinfo id="grt_insu_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="user_id" size="256" summ="default" type="STRING"/>
					<colinfo id="seq" size="256" summ="default" type="STRING"/>
					<colinfo id="bf_crdt_lmt_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="insp_gua_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="crdt_lmt_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmn_crdt" size="256" summ="default" type="STRING"/>
					<colinfo id="pct" size="256" summ="default" type="STRING"/>
					<colinfo id="bf_pct" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_acc_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_new_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_chg_sale_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_eqp_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="to_usim_dis_qty" size="256" summ="default" type="STRING"/>
					<colinfo id="eqp_round_day" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_eqp_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="avg_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="pre_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="to_usim_dis_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="skt_chag_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chag_dpst_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chag_bond_bamt" size="256" summ="default" type="STRING"/>
					<colinfo id="rmks" size="256" summ="default" type="STRING"/>
					<colinfo id="open_yn" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sendList">
				<Contents>
					<colinfo id="args1" size="256" summ="default" type="STRING"/>
					<colinfo id="args2" size="256" summ="default" type="STRING"/>
					<record>
						<args1>1</args1>
						<args2>2</args2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apprCheck">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<NAME>전체</NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<NAME>승인완료</NAME>
					</record>
					<record>
						<CODE>S</CODE>
						<NAME>승인요청</NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Button Cursor="HAND" Height="21" Id="btn_excel" ImageID="btn_i_exceldown_w" Left="997" OnClick="btn_excel_OnClick" TabOrder="1" Text="Button1" ToolTipText="Excel&#32;Download" Top="56" Width="19"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="s" ImageID="btn_c_2" Left="956" LeftMargin="5" OnClick="btn_send_OnClick" Style="sty_btn_c" TabOrder="2" Text="저장" Top="561" Width="60"></Button>
		<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="14" LeftMargin="15" Style="sty_img_tit" TabOrder="3" Text="판매점&#32;여신&#32;목록" Top="56" Width="192"></Image>
		<Grid AutoEnter="TRUE" BindDataset="ds_list" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="543" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="463" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user33" OnCellClick="grd_list_OnCellClick" OnExpandUp="grd_list_OnExpandUp" OnHeadClick="cf_allChecknSort" Right="1012" RowHeight="21" Style="sty_Grid" TabOrder="4" TabStop="true" Top="80" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="1004">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="32"/>
						<col fix="left" width="80"/>
						<col fix="left" width="36"/>
						<col fix="left" width="36"/>
						<col fix="left" width="64"/>
						<col fix="left" width="80"/>
						<col fix="left" width="159"/>
						<col fix="left" width="70"/>
						<col fix="left" width="70"/>
						<col width="115"/>
						<col width="132"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="58"/>
						<col width="16"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" rowspan="2" text="No"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" rowspan="2" text="승인여부"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" rowspan="2" text="선택"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" rowspan="2" text="신설&#10;여부"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" rowspan="2" text="영업담당"/>
						<cell bkcolor="user34" col="5" color="user35" display="text" rowspan="2" text="거래처구분"/>
						<cell bkcolor="user34" col="6" color="user35" colspan="3" display="text" text="정산처"/>
						<cell bkcolor="user34" col="9" color="user35" display="text" rowspan="2" text="보증보험사"/>
						<cell bkcolor="user34" col="10" color="user35" display="text" rowspan="2" text="증권번호"/>
						<cell bkcolor="user34" col="11" color="user35" display="text" rowspan="2" text="증권유효일"/>
						<cell bkcolor="user34" col="12" color="user35" display="text" rowspan="2" text="증권만료일"/>
						<cell bkcolor="user34" col="13" color="user35" display="text" rowspan="2" text="잔여기간"/>
						<cell bkcolor="user34" col="14" color="user35" display="text" rowspan="2" text="잔여여신"/>
						<cell bkcolor="user34" col="15" color="user35" display="text" rowspan="2" text="담보금액"/>
						<cell bkcolor="user34" col="16" color="user35" display="text" rowspan="2" text="여신한도"/>
						<cell bkcolor="user34" col="17" color="user35" colspan="2" display="text" rowspan="2" text="순담보비율"/>
						<cell bkcolor="user34" col="19" color="user35" display="text" rowspan="2" text="품의자"/>
						<cell bkcolor="user34" col="20" color="user35" display="text" rowspan="2" text="품의일"/>
						<cell bkcolor="user34" col="21" color="user35" display="text" rowspan="2" text="승인자"/>
						<cell bkcolor="user34" col="22" color="user35" display="text" rowspan="2" text="승인일"/>
						<cell bkcolor="user34" col="23" color="user35" display="text" rowspan="2" text="비고"/>
						<cell bkcolor="user34" col="6" color="user35" display="text" row="1" text="정산처명"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" row="1" text="대리점코드"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" row="1" text="채널코드"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="0" colid="chrgr_user_nm" display="text" expr="currow+1"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="1" colid="APPR_CHECK" display="normal"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="2" colid="CHK" display="checkbox"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="3" colid="OPEN_YN" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="4" colid="chrgr_user_nm" display="normal"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="5" colid="DEAL_CO_CL_NM" display="normal"/>
						<cell align="left" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="6" colid="DEAL_CO_NM" display="normal" font="돋움,9,Underline"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="7" colid="UKEY_AGENCY_CD" display="normal"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="8" colid="UKEY_CHANNEL_CD" display="normal"/>
						<cell align="left" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="9" colid="GRT_INSU_CO_NM" display="normal"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="10" colid="INSP_NO" display="normal"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="11" colid="INSP_EFF_DT" display="date"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="12" colid="INSP_EXP_DT" display="date"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="13" colid="LEFT_DT" display="normal"/>
						<cell align="right" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="14" colid="RMN_CRDT" display="number"/>
						<cell align="right" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="15" colid="INSP_GUA_AMT" display="number"/>
						<cell align="right" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="16" colid="CRDT_LMT_AMT" display="number" limit="13"/>
						<cell align="right" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="17" colid="PCT" display="text" expr='NumFormat(PCT)+&quot;%&quot;'/>
						<cell align="right" col="18" display="text" expandimage="btn_i_detail_b" expandshow="true"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="19" colid="MOD_USER" display="normal"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="20" colid="MOD_DTM" display="date"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="21" colid="APPR_USER_ID" display="text"/>
						<cell align="center" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="22" colid="APPR_DT" display="date"/>
						<cell align="left" bkcolor="expr:iif(RMN_CRDT&lt;=0,&#32;&apos;User25&apos;,&apos;default&apos;)" col="23" colid="RMKS" display="normal"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user37" col="0" color="user38" colspan="14" display="text" font="돋움,10,Bold" text="합&#32;계"/>
						<cell align="right" bkcolor="user37" col="14" color="user38" display="number" expr="sum(&apos;RMN_CRDT&apos;)" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="15" color="user38" display="number" expr="sum(&apos;INSP_GUA_AMT&apos;)" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="16" color="user38" display="number" expr="sum(&apos;CRDT_LMT_AMT&apos;)" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="17" color="user38" display="text" expr='NumFormat(round(sum(&apos;CRDT_LMT_AMT&apos;)/sum(&apos;INSP_GUA_AMT&apos;)*100))+&quot;%&quot;' font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="18" color="user38" display="text" font="돋움,10,Bold"/>
						<cell align="right" bkcolor="user37" col="19" color="user38" colspan="5" display="text" font="돋움,10,Bold"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Div Border="Raised" Height="40" Id="div_search" Left="12" Style="sty_div_search" TabOrder="5" Text="Div0" Top="10" Width="1004">
			<Contents>
				<Static Align="Right" Height="20" Id="Static1" Left="6" Style="sty_lb_Search" TabOrder="5" Text="대리점" Top="7" VAlign="Middle" Width="60"></Static>
				<Static Align="Right" Height="20" Id="Static5" Left="355" Style="sty_lb_Search" TabOrder="4" Text="영업담당" Top="7" VAlign="Middle" Width="60"></Static>
				<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_search" ImageID="btn_a_2" Left="726" LeftMargin="5" OnClick="div_search_btn_search_OnClick" Style="sty_btn_a" TabOrder="3" Text="조회" Top="7" Width="60"></Button>
				<Combo BindDataset="ds_condition" Border="Flat" CodeColumn="id" Column="chrgr_user_id" DataColumn="nm" Height="20" Id="cmb_chrgrUser" InnerDataset="ds_cmbUser" Left="417" OnKeyDown="div_search_common_OnKeyDown" Style="sty_ipt_form" TabOrder="2" Top="6" Width="99"></Combo>
				<Static Align="Right" Height="20" Id="Static0" Left="778" Style="sty_lb_Search" TabOrder="6" Text="조회일" Top="7" VAlign="Middle" Visible="FALSE" Width="68"></Static>
				<Calendar BindDataset="ds_condition" Border="Flat" ButtonImageID="btn_i_calendar" Column="dtm_date" DayFont="Default,-1" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_aplyStaDtm" Left="852" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="7" TodayColor="user26" Top="7" Visible="FALSE" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="90"></Calendar>
				<Edit BindDataset="ds_condition" Border="Flat" Column="dtm_hh" Height="20" Id="edt_hour" Left="943" LeftMargin="2" MaxLength="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="8" Top="7" Visible="FALSE" Width="22"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" Column="dtm_mm" Height="20" Id="edt_min" ImeMode="none" Left="966" LeftMargin="2" MaxLength="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="9" Top="7" Visible="FALSE" Width="22"></Edit>
				<Image Height="21" Id="Image0" ImageID="bul_mand" Left="15" TabOrder="10" Top="6" Transparent="TRUE" Width="20"></Image>
				<Image Height="21" Id="Image1" ImageID="bul_mand" Left="795" TabOrder="11" Top="6" Transparent="TRUE" Visible="FALSE" Width="20"></Image>
				<Edit BindDataset="ds_condition" Border="Flat" Column="uKey_agency_cd" Enable="FALSE" Height="20" Id="edt_agency" ImeMode="none" Left="248" LeftMargin="2" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="13" Top="7" Width="78"></Edit>
				<Button Cursor="HAND" Height="21" Id="btn_agency" ImageID="btn_i_detail" Left="229" OnClick="btn_agency_OnClick" TabOrder="12" Text="Button0" Top="7" Width="19"></Button>
				<Edit BindDataset="ds_condition" Border="Flat" Column="deal_co_nm" Height="20" Id="edt_agencyNm" ImeMode="native" Left="72" LeftMargin="2" OnChanged="div_search_edt_agencyNm_OnChanged" OnKeyDown="div_search_edt_agencyNm_OnKeyDown" RightMargin="2" Style="sty_ipt_form" TabOrder="1" Top="7" Width="156"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" Column="POS_AGENCY" Height="20" Id="edt_posAgency" ImeMode="native" Left="328" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="14" Top="7" Visible="FALSE" Width="6"></Edit>
				<Static Align="Right" Height="20" Id="Static2" Left="539" Style="sty_lb_Search" TabOrder="16" Text="승인여부" Top="7" VAlign="Middle" Width="60"></Static>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="NAME" Height="20" Id="cmb_apprCheck" InnerDataset="ds_apprCheck" Left="601" OnKeyDown="div_search_common_OnKeyDown" Style="sty_ipt_form" TabOrder="15" Top="6" Width="99"></Combo>
			</Contents>
		</Div>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID  : ACCSBC00300
* 업무명      : 판매점 - 판매점여신 
* 프로그램명  : 판매점여신관리 
--------------------------------------------------------------------------------
* 작성자      : 전현주 
* 작성일      : 2010.05.09
--------------------------------------------------------------------------------
* 1. 변경이력
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

//==============================================================================
// 공통 스크립트 로딩
//==============================================================================
#include "lib::lib_commF.js"
#include "lib::lib_DIS.js"
#include "lib::lib_commPopup.js"
#include "lib::lib_util.js"
#include "lib::lib_commMsg.js"

//==============================================================================
// 전역변수선언
//==============================================================================
var FV_LOGIN_ID;      	//사용자계정     
var FV_ORG_ID;         	//조직코드    
var FV_ORG_CL;         	//조직구분      
var FV_SUP_ORG_ID;      //상위조직코드   
var FV_USER_GRP;        //사용자그룹   
var FV_ORG_AREA_ID; 	// 근무지 cd.
var FV_ORG_AREA_NM; 	// 근무지 nm.       
var FV_POS_AGENCY_ID;   // 소속 대리점ID 
var FV_POS_AGENCY_NM;   // 소속 대리점명 
var FV_POS_AGENCY_UKEY_ID; // 소속 대리점UKEY ID 

 


/*******************************************************************************
 * @description    : 최초 폼 로드시 발생 - 이벤트
*******************************************************************************/
function ACCSBC00300_OnLoadCompleted(obj)
{
	// 권한 설정
	cf_setAuth(pFrmNum);
	
	FV_LOGIN_ID = gds_session.GetColumn(0, "loginId");		                         
	FV_ORG_ID 	= gds_session.GetColumn(0, "orgId");		                             
	FV_ORG_CL 	= gds_session.GetColumn(0, "orgCl");		                           
	FV_SUP_ORG_ID 	= gds_session.GetColumn(0, "supOrgId");	                       
	FV_USER_GRP 	= gds_session.GetColumn(0, "userGrp");	                        
	FV_ORG_AREA_ID  = gds_session.GetColumn(0,"orgAreaId");     
    FV_ORG_AREA_NM  = gds_session.GetColumn(0,"orgAreaNm");                       
	FV_POS_AGENCY_ID 	= gds_session.GetColumn(0,"posAgencyId");       
	FV_POS_AGENCY_NM 	= gds_session.GetColumn(0,"posAgencyNm");          
	FV_POS_AGENCY_UKEY_ID = gds_session.GetColumn(0,"posAgencyUkeyId");  
	
	div_search.cmb_apprCheck.Index = 0;

	http.Sync = true;
	
	//대리점
	uf_enableAgencyByAuth("div_search", "edt_agencyNm,edt_posAgency,btn_agency", "edt_agency");
	
	f_init();	//폼 초기화 
	
	http.Sync = false;
	
	
}
 

/*******************************************************************************
* 함수명 : f_callBack 
* 기능명 : 트랜잭션 콜백 
* 파라미터
1. sSvcID  : 서비스 아이디
*******************************************************************************/
function f_callBack(sSvcID)
{	
	if (sSvcID == "getSalesCrdt") {
		if (div_search.cmb_chrgrUser.Index < 1 ) {
			div_search.cmb_chrgrUser.Index = 0;
		}
		 
	} else if (sSvcID == "getSalesUser") {
		ds_cmbUser.InsertRow(0);
		ds_cmbUser.SetColumn(0, "nm", "전체");
		div_search.cmb_chrgrUser.Index = 0;
	} else if (sSvcID == "saveSalesCrdt"){
	
		/*
		http.Sync = true;
		
	    //MSIE1_DocumentComplete();
	    
	    f_sendData();
	    
	    http.Sync = false;
	    */
	
		div_search_btn_search_OnClick();
	} else if(sSvcID == "test"){
	
		alert("저장되었습니다.");
		//return;
		
		f_getXmlData();
	}
}

/*******************************************************************************
 * @description    : 조회 
*******************************************************************************/
function div_search_btn_search_OnClick(obj)
{
	ds_list.ClearData();
	
	if (length(trim(div_search.edt_agency.Text)) ==0 ||
			   length(trim(div_search.edt_agencyNm.Text)) ==0	) {
		alert(cf_getMessage(MSG_00028, "대리점")); //대리점이(가) 입력되지 않았습니다
		btn_agency_OnClick();
		return false;
	} else {	 
	
	    cf_setParam(ds_condition, "ACC_DT", AddDate(today(), -1));
	    cf_setParam(ds_condition, "APPR_CHECK"     , div_search.cmb_apprCheck.Value);
	   
	    var sSvcID 	= "getSalesCrdt";
		var sInDs  	= "nc_input_fieldDs=ds_condition";
		var sOutDs 	= "ds_list=ds_list ds_result=ds_result";
		var sArg	= "sktst.acc.SBC#getSalesCrdtList";
		cf_Transaction(sSvcID, sInDs, sOutDs, sArg, "", true, true);
	}
 }
  
  
  function btn_send_OnClick(obj){
  
    
   /*
   연동풀 때 이것도 풀기
    if(FV_LOGIN_ID !=""){
		if(substr(FV_LOGIN_ID,0,2) != "14"){
			alert("승인요청자 id를 확인하십시오.");
			return false;
		}
	}
*/
	
	var chkCnt = ds_list.CaseCount("CHK==" + quote("1"));
    
    if(chkCnt >1){
		alert("거래처를 한 곳만 선택하십시오.");
		return false;
    }
    
	if(chkCnt == 1){
	
		 ds_resultPop.ClearData();
		 
	     for(var i=0; i<ds_list.rowcount; i++){
	
			if(ds_list.GetColumn(i,"CHK") == "1"){
			
			    var sInDealCoCd = ds_list.GetColumn(i,"DEAL_CO_CD");
			    
			     ds_result.SetColumn(ds_result.FindRow("DEAL_CO_CD",sInDealCoCd),"CRDT_LMT_AMT", toNumber(ds_list.GetColumn(i,"CRDT_LMT_AMT")));
			     ds_result.SetColumn(ds_result.FindRow("DEAL_CO_CD",sInDealCoCd),"PCT", toNumber(ds_list.GetColumn(i,"PCT")));
			     ds_result.SetColumn(ds_result.FindRow("DEAL_CO_CD",sInDealCoCd),"RMKS", ds_list.GetColumn(i,"RMKS"));
			    
			     ds_result.Filter("DEAL_CO_CD=='" + sInDealCoCd + "'");
				 cf_copyDataset(ds_resultPop, ds_result, null, false, true);
				 				 
				 if(ds_list.GetColumn(i,"OPEN_YN") == "1"){
				 
					ds_resultPop.SetColumn(ds_resultPop.rowcount-1,"OPEN_YN","Y");
				 }else{
					ds_resultPop.SetColumn(ds_resultPop.rowcount-1,"OPEN_YN","N");
				 }
				 
				 ds_result.UnFilter();
			
			}
	
		 }
	}
	
	/*
	김형선 M 요청으로 연동막다 20110407
	var dsParent = "ds_resultPop";
	
	var sArg  = "dsParent='"+dsParent+"'";
			
	dialog("ACC::ACCSBC00340.xml", sArg, 112, 35);
	*/
	
	btn_save_OnClick();
    
  }
/*******************************************************************************
 * @description    : 저장처리
*******************************************************************************/

function btn_save_OnClick(obj)
{
	/*
    var chkCnt = ds_list.CaseCount("CHK==" + quote("1"));
    
    if(chkCnt >1){
		alert("거래처를 한 곳만 선택하십시오.");
		return false;
    }
    
	if(chkCnt == 1){
	
		 ds_resultPop.ClearData();
		 
	     for(var i=0; i<ds_list.rowcount; i++){
	
			if(ds_list.GetColumn(i,"CHK") == "1"){
			
			    var sInDealCoCd = ds_list.GetColumn(i,"DEAL_CO_CD");
			    
			     ds_result.SetColumn(ds_result.FindRow("DEAL_CO_CD",sInDealCoCd),"CRDT_LMT_AMT", toNumber(ds_list.GetColumn(i,"CRDT_LMT_AMT")));
			     ds_result.SetColumn(ds_result.FindRow("DEAL_CO_CD",sInDealCoCd),"PCT", toNumber(ds_list.GetColumn(i,"PCT")));
			     ds_result.SetColumn(ds_result.FindRow("DEAL_CO_CD",sInDealCoCd),"RMKS", ds_list.GetColumn(i,"RMKS"));
			    
			     ds_result.Filter("DEAL_CO_CD=='" + sInDealCoCd + "'");
				 cf_copyDataset(ds_resultPop, ds_result, null, false, true);
				 				 
				 if(ds_list.GetColumn(i,"OPEN_YN") == "1"){
				 
					ds_resultPop.SetColumn(ds_resultPop.rowcount-1,"OPEN_YN","Y");
				 }else{
					ds_resultPop.SetColumn(ds_resultPop.rowcount-1,"OPEN_YN","N");
				 }
				 
				 ds_result.UnFilter();
			
			}
	
		 }
	}
	*/
	
	
	var sSvcID 	= "saveSalesCrdt";
	var sInDs  	= "nc_input_fieldDs=ds_condition ds_list=ds_list ds_resultPop=ds_resultPop";
	//var sOutDs 	= "ds_result=ds_list";
	var sOutDs 	= "";
	var sArg	= "sktst.acc.SBC#saveSalesCrdtList";
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, "", true, true);
	
	
}


//==============================================================================
//  기타 업무 메소드들
//============================================================================== 
/*******************************************************************************
 * @description    : 초기화
*******************************************************************************/
function f_init()
{
 
	
}

/*******************************************************************************
 * @description : 조회조건 세팅 
 ******************************************************************************/ 
function div_search_edt_agency_OnChanged(obj,strText)
{
	div_search.edt_agencyNm.Text = "";
}

/*******************************************************************************
 * @description : enter key 조회 
 ******************************************************************************/ 
function div_search_common_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,LLParam,HLParam)
{
	if (nChar==13) {
		div_search_btn_search_OnClick();
	}
}

/*******************************************************************************
 * @description : 영업사원가져오기 
 ******************************************************************************/ 
function ds_condition_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID == "POS_AGENCY" ) {
		var sSvcID 	= "getSalesUser";
		var sInDs  	= "nc_input_fieldDs=ds_condition";
		var sOutDs 	= "ds_cmbUser=ds_cmbUser";
		var sArg	= "sktst.acc.SBC#getSalesUser";
		cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	} 
}

/*******************************************************************************
 * @description : excel
 ******************************************************************************/ 
function btn_excel_OnClick(obj)
{
	cf_exportExcel(grd_list);
}

/*******************************************************************************
 * @description : 대리점 팝업 
 ******************************************************************************/ 
function btn_agency_OnClick(obj)
{
	var sArg  = "org_id="+quote(FV_ORG_ID); 
		sArg += " org_cl="+quote(FV_ORG_CL); 
 
	cf_callAgencyPop(sArg, ds_condition, "DEAL_CO_NM,POS_AGENCY,UKEY_AGENCY_CD" );
}



function div_search_edt_agencyNm_OnChanged(obj,strText)
{
	ds_condition.SetColumn(0, "POS_AGENCY", "");
	ds_condition.SetColumn(0, "UKEY_AGENCY_CD", "");
	ds_cmbUser.Clear();
}

function div_search_edt_agencyNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {
		ApplyData();
		var sArg  = "org_id="+quote(FV_ORG_ID); 
			sArg += " org_cl="+quote(FV_ORG_CL); 
		cf_callAgencyPop(sArg, ds_condition, "DEAL_CO_NM,POS_AGENCY,UKEY_AGENCY_CD" );
	}
}
function Button0_OnClick(obj)
{
	cf_debug("ds_resultPop");
}


function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 1){
		
		var sInOrgCd =    ds_list.GetColumn(nRow,"ORG_CD");
		var sInDealCoCd =    ds_list.GetColumn(nRow,"DEAL_CO_CD");
		var sInDealCoClNm = ds_list.GetColumn(nRow,"DEAL_CO_CL_NM");
		var sInDealCoNm =    ds_list.GetColumn(nRow,"DEAL_CO_NM");
		var sInGrtInsuCoNm =    ds_list.GetColumn(nRow,"GRT_INSU_CO_NM");
		var sInRmnCrdt =    ds_list.GetColumn(nRow,"RMN_CRDT");
		
		var sArg  =  "sOrgCd="+quote(sInOrgCd); 
		    sArg += " sDealCoCd="+quote(sInDealCoCd); 
		    sArg += " sDealCoClNm="+quote(sInDealCoClNm); 
			sArg += " sDealCoNm="+quote(sInDealCoNm);
			sArg += " sGrtInsuCoNm="+quote(sInGrtInsuCoNm);
			sArg += " sRmnCrdt="+quote(sInRmnCrdt);
				
		dialog("ACC::ACCSBC00350.xml", sArg, 528, 344);
	}
	
	if(nCell == 2 || nCell == 16){
	
		var sInCrdtPct = ds_list.GetColumn(nRow,"PCT");
		var sInRmks =    ds_list.GetColumn(nRow,"RMKS");
		var sInOpenYn =    ds_list.GetColumn(nRow,"OPEN_YN");
		var sInRmnCrdt =    ds_list.GetColumn(nRow,"RMN_CRDT");
		var sInCurrow =    nRow;
		var sInDealCoCd = ds_list.GetColumn(nRow,"DEAL_CO_CD");
	     var sInGrpInsuCoNm = ds_list.GetColumn(nRow,"GRT_INSU_CO_NM");
	     
	    var sInRmnCrdt =    ds_list.GetColumn(nRow,"RMN_CRDT");
		var sInPct =    ds_list.GetColumn(nRow,"PCT");
		var sInCrdtLmtAmt =    ds_list.GetColumn(nRow,"CRDT_LMT_AMT");
	     
		ds_childPop.ClearData();
	  	     
	     ds_result.Filter("DEAL_CO_CD=='" + sInDealCoCd + "'");
	     cf_copyDataSet(ds_childPop, ds_result);
		 ds_result.UnFilter();
		 
		 var dsParent = "ds_childPop";
			
		var  sArg  = "dsParent='"+dsParent+"'";
		    sArg += " sDealCoCd=" + quote(sInDealCoCd);
		    sArg += " sOpenYn=" + quote(sInOpenYn);
		    sArg += " sRmnCrdt=" + quote(sInRmnCrdt);
			sArg += " sGrpInsuCoNm=" + quote(sInGrpInsuCoNm);
		    sArg += " sCrdtPct="+quote(sInCrdtPct); 
			sArg += " sRmks="+quote(sInRmks);
			sArg += " sCurrow="+quote(sInCurrow);
			sArg += " sRmnCrdt="+quote(sInRmnCrdt); 
			sArg += " sPct="+quote(sInPct);
			sArg += " sCrdtLmtAmt="+quote(sInCrdtLmtAmt);
				
		dialog("ACC::ACCSBC00310.xml", sArg, 830, 160);
	}
	
	
	if(nCell == 17){
		
		var sInOrgCd =    ds_list.GetColumn(nRow,"ORG_CD");
		var sInDealCoCd =    ds_list.GetColumn(nRow,"DEAL_CO_CD");
		var sInDealCoClNm = ds_list.GetColumn(nRow,"DEAL_CO_CL_NM");
		var sInDealCoNm =    ds_list.GetColumn(nRow,"DEAL_CO_NM");
		var sInGrtInsuCoNm =    ds_list.GetColumn(nRow,"GRT_INSU_CO_NM");
		var sInRmnCrdt =    ds_list.GetColumn(nRow,"RMN_CRDT");
		
		var sArg  =  "sOrgCd="+quote(sInOrgCd); 
		    sArg += " sDealCoCd="+quote(sInDealCoCd); 
		    sArg += " sDealCoClNm="+quote(sInDealCoClNm); 
			sArg += " sDealCoNm="+quote(sInDealCoNm);
			sArg += " sGrtInsuCoNm="+quote(sInGrtInsuCoNm);
			sArg += " sRmnCrdt="+quote(sInRmnCrdt);
				
		dialog("ACC::ACCSBC00320.xml", sArg, 830, 160);
	}
	/*
	if(nCell == 5){
	
	     ds_childPop.ClearData();
	     
	     var sInDealCoCd = ds_list.GetColumn(nRow,"DEAL_CO_CD");
	     var sInGrpInsuCoNm = ds_list.GetColumn(nRow,"GRT_INSU_CO_NM");
	     
	     ds_result.Filter("DEAL_CO_CD=='" + sInDealCoCd + "'");
	     cf_copyDataSet(ds_childPop, ds_result);
		 //ds_childPop.CopyF(ds_result);		
		 ds_result.UnFilter();
		 
		 var dsParent = "ds_childPop";
	
		 var sArg  = "dsParent='"+dsParent+"'";
			sArg += " sDealCoCd=" + quote(sInDealCoCd);
			sArg += " sGrpInsuCoNm=" + quote(sInGrpInsuCoNm);
			
			dialog("ACC::ACCSBC00330.xml", sArg, 560, 400 );
	
	}
	*/
}


function grd_list_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 18){
	
		var sInOrgCd =    ds_list.GetColumn(nRow,"ORG_CD");
		var sInDealCoCd =    ds_list.GetColumn(nRow,"DEAL_CO_CD");
		var sInDealCoClNm = ds_list.GetColumn(nRow,"DEAL_CO_CL_NM");
		var sInDealCoNm =    ds_list.GetColumn(nRow,"DEAL_CO_NM");
		var sInRmnCrdt =    ds_list.GetColumn(nRow,"RMN_CRDT");
		var sInGrtInsuCoNm =    ds_list.GetColumn(nRow,"GRT_INSU_CO_NM");
		
		var sArg  =  "sOrgCd="+quote(sInOrgCd); 
		    sArg += " sDealCoCd="+quote(sInDealCoCd); 
		    sArg += " sDealCoClNm="+quote(sInDealCoClNm); 
			sArg += " sDealCoNm="+quote(sInDealCoNm);
			sArg += " sRmnCrdt="+quote(sInRmnCrdt);
			sArg += " sGrtInsuCoNm="+quote(sInGrtInsuCoNm);
				
		dialog("ACC::ACCSBC00320.xml", sArg, 830, 160);
	}
}


function f_getXmlData(obj,pDisp,URL)
{
	alert("test!!!");
}

/*
function MSIE1_DocumentComplete(obj,pDisp,URL)
{
	
	var URL = "http://localhost:8088/ps/test1.jsp";
	var sInDealCoCd = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"deal_co_cd");
	var sInSeq = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"seq");
	//var sInSeq = 12;
	var sInOpenYn = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"open_yn");
	var sInDealCoNm = urlEncodeUtf8(ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"deal_co_nm"));
	var sInSalePlcCnt = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"cnt");
	var sInChrgrUserNm = urlEncodeUtf8(ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"chrgr_user_nm"));
	var sInGrtInsuCo = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"grt_insu_co");
	var sInGrtInsuNm = urlEncodeUtf8(ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"grt_insu_nm"));
	var sInInspGuaAmt =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"insp_gua_amt");
	var sInBfCrdtLmtAmt =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"bf_crdt_lmt_amt");
	var sInLeftCrdtAmt =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"rmn_crdt");
	var sInAvgAccAmt =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"avg_acc_amt");
	var sInPreAccAmt =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"pre_acc_amt");
	var sInToAccAmt =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"to_acc_amt");
	var sInAvgNewSaleQty =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"avg_new_sale_qty");
	var sInPreNewSaleQty =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"pre_new_sale_qty");
	var sInToNewSaleQty = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"to_new_sale_qty");
	var sInAvgChgSaleQty =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"avg_chg_sale_qty");
	var sInPreChgSaleQty =ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"pre_chg_sale_qty");
	var sInToChgSaleQty = ds_resultPop.GetColumn(ds_resultPop.rowcount-1,"to_chg_sale_qty");
	
	
	var PostData = TextToBin("sDealCoCd="+sInDealCoCd+"&sSeq="+sInSeq+"&sOpenYn="+sInOpenYn+"&sDealCoNm="+sInDealCoNm+"&sSalePlcCnt="+sInSalePlcCnt+"&sChrgrUserNm="+sInChrgrUserNm+"&sGrtInsuCo="+sInGrtInsuCo+"&sGrtInsuNm="+sInGrtInsuNm+"&sInspGuaAmt="+sInInspGuaAmt+"&sBfCrdtLmtAmt="+sInBfCrdtLmtAmt+"&sLeftCrdtAmt="+sInLeftCrdtAmt+"&sAvgAccAmt="+sInAvgAccAmt+"&sPreAccAmt="+sInPreAccAmt+"&sToAccAmt="+sInToAccAmt+"&sAvgNewSaleQty="+sInAvgNewSaleQty+"&sPreNewSaleQty="+sInPreNewSaleQty+"&sToNewSaleQty="+sInToNewSaleQty+"&sAvgChgSaleQty="+sInAvgChgSaleQty+"&sPreChgSaleQty="+sInPreChgSaleQty+"&sToChgSaleQty="+sInToChgSaleQty);
	var Headers = "Content-Type:application/x-www-form-urlencoded";
	//var Headers = "Content-Type:text/html;charset=euc-kr";
	MSIE1.Navigate(URL, "", "_new"+Random(), PostData, Headers);
	
}
*/



var unreserved = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_.~";
var reserved = "!*'();:@&=+$,/?%#[]";
var allowed = unreserved + reserved;
var hexchars = "0123456789ABCDEFabcdef";
var decchars = "ABCDEF";

function convert16To10(str)
{
	var sum=0;
	
	str = toUpper(str);
	
	var s = midb(str,0,1);
	if ( s >= "A" && s <= "F" )
	{
		sum += (10+pos(decchars,s))*16;
	} else if ( s >= "0" && s <= "9" ){
		sum += (toNumber(s)*16);
	}

	s = midb(str,1,1);
	if ( s >= "A" && s <= "F" )
	{
		sum += (10+pos(decchars,s));
	} else if ( s >= "0" && s <= "9" ){
		sum += toNumber(s);
	}

	trace("convert : " + sum);
	return sum;
}

function gethex(decimal) 
{
  return "%" + charAt(hexchars,ext_getBitCalc(">>",decimal,4)) + 
               charAt(hexchars,ext_getBitCalc("&",decimal,15));
}

function getdec(hexencoded) 
{ 
   if (length(hexencoded) == 3) 
   { 
     if (charAt(hexencoded,0) == "%") { 
       if (indexOf(hexchars,charAt(hexencoded,1)) != -1 && indexOf(hexchars,charAt(hexencoded,2)) != -1) { 
         return convert16To10(midb(hexencoded,1,2)); 
       } 
     } 
   } 
   return 256; 
}

function urlEncodeUtf8(decoded) 
{
  // Some variables:
	var encoded = "";
	
	// ---------------- If UTF-8 character encoding was chosen: ----------------
	
	for (var i = 0; i < length(decoded); i++ ) 
	{
		var ch = charAt(decoded,i);
		// Check if character is an unreserved character:
		if (indexOf(unreserved,ch) != -1) {
			encoded = encoded + ch;
		} else {

			// The position in the Unicode table tells us how many bytes are needed.
			// Note that if we talk about first, second, etc. in the following, we are
			// counting from left to right:
			//
			//   Position in   |  Bytes needed   | Binary representation
			//  Unicode table  |   for UTF-8     |       of UTF-8
			// ----------------------------------------------------------
			//     0 -     127 |    1 byte       | 0XXX.XXXX
			//   128 -    2047 |    2 bytes      | 110X.XXXX 10XX.XXXX
			//  2048 -   65535 |    3 bytes      | 1110.XXXX 10XX.XXXX 10XX.XXXX
			// 65536 - 2097151 |    4 bytes      | 1111.0XXX 10XX.XXXX 10XX.XXXX 10XX.XXXX
	
			var charcode = Asc(charAt(decoded,i));
	
			// Position 0 - 127 is equal to percent-encoding with an ASCII character encoding:
			if (charcode < 128) {
			  encoded = encoded + gethex(charcode);
			}
	
			// Position 128 - 2047: two bytes for UTF-8 character encoding.
			if (charcode > 127 && charcode < 2048) {
			  // First UTF byte: Mask the first five bits of charcode with binary 110X.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc(">>",charcode,6),12));
			  // Second UTF byte: Get last six bits of charcode and mask them with binary 10XX.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc("&",charcode,63),128));
			}
	
			// Position 2048 - 65535: three bytes for UTF-8 character encoding.
			if (charcode > 2047 && charcode < 65536) {
			  // First UTF byte: Mask the first four bits of charcode with binary 1110.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc(">>",charcode,12),224));
			  // Second UTF byte: Get the next six bits of charcode and mask them binary 10XX.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc("&",ext_getBitCalc(">>",charcode,6),63),128));
			  // Third UTF byte: Get the last six bits of charcode and mask them binary 10XX.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc("&",charcode,63),128));
			}
	
			// Position 65536 - : four bytes for UTF-8 character encoding.
			if (charcode > 65535) {
			  // First UTF byte: Mask the first three bits of charcode with binary 1111.0XXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc(">>",charcode,18),240));
			  // Second UTF byte: Get the next six bits of charcode and mask them binary 10XX.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc("&",ext_getBitCalc(">>",charcode,12),63),128));
			  // Third UTF byte: Get the last six bits of charcode and mask them binary 10XX.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc("&",ext_getBitCalc(">>",charcode,6),63),128));
			  // Fourth UTF byte: Get the last six bits of charcode and mask them binary 10XX.XXXX:
			  encoded = encoded + gethex(ext_getBitCalc("|",ext_getBitCalc("&",charcode,63),128));
			}
		}

	}  // end of for ...
	return encoded;
}

function f_sendData(){

	var dsParent = "ds_resultPop";
	
	var sArg  = "dsParent='"+dsParent+"'";
			
	dialog("ACC::ACCSBC00340.xml", sArg, 112, 35);
}

function Button1_OnClick(obj)
{
	cf_debug("ds_result");
}
]]></Script>
</Window>