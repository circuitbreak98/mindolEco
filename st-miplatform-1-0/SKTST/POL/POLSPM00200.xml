<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="600" Id="POLSPM00200" Left="8" OnLoadCompleted="POLSPM00200_OnLoadCompleted" PidAttrib="7" Title="판매가격표(선호도)&#32;등록" Top="8" Ver="1.0" Width="1192" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_condition">
				<Contents>
					<colinfo id="APLY_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="HIST_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_TYP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_STA_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_END_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MIN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="END_MIN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPLST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UKEY_AGENCY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="APRV_ST" size="256" summ="default" type="STRING"/>
					<colinfo id="TPLST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_MOD_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_MIN" size="256" summ="default" type="STRING"/>
					<record>
						<APLY_DT></APLY_DT>
						<APLY_END_DTM></APLY_END_DTM>
						<APLY_MOD_TM></APLY_MOD_TM>
						<APLY_STA_DTM></APLY_STA_DTM>
						<APLY_YM></APLY_YM>
						<APRV_ST></APRV_ST>
						<DEAL_CO_NM></DEAL_CO_NM>
						<DEL_RSN></DEL_RSN>
						<END_HOUR></END_HOUR>
						<END_MIN></END_MIN>
						<HIST_YN></HIST_YN>
						<HOUR></HOUR>
						<MIN></MIN>
						<MOD_HOUR></MOD_HOUR>
						<MOD_MIN></MOD_MIN>
						<ORG_ID></ORG_ID>
						<SALE_TYP_CD></SALE_TYP_CD>
						<SPLST_ID></SPLST_ID>
						<TPLST_ID></TPLST_ID>
						<UKEY_AGENCY_CD></UKEY_AGENCY_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saleTypCd">
				<Contents>
					<colinfo id="COMM_CD_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_preferGrdCl">
				<Contents>
					<colinfo id="COMM_CD_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_orgLst">
				<Contents>
					<colinfo id="chk" size="256" summ="default" type="STRING"/>
					<colinfo id="org_id" size="256" summ="default" type="STRING"/>
					<colinfo id="org_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_typ_cd" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_preferLst">
				<Contents>
					<colinfo id="column0" size="256" summ="default" type="STRING"/>
					<colinfo id="column1" size="256" summ="default" type="STRING"/>
					<colinfo id="column2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_splst">
				<Contents>
					<colinfo id="splst_id" size="256" summ="default" type="STRING"/>
					<colinfo id="aply_ym" size="256" summ="default" type="STRING"/>
					<colinfo id="org_id" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_typ_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="aply_sta_dtm" size="256" summ="default" type="STRING"/>
					<colinfo id="aply_end_dtm" size="256" summ="default" type="STRING"/>
					<colinfo id="rmks" size="256" summ="default" type="STRING"/>
					<colinfo id="del_yn" size="256" summ="default" type="STRING"/>
					<colinfo id="upd_cnt" size="256" summ="default" type="STRING"/>
					<colinfo id="ins_dtm" size="256" summ="default" type="STRING"/>
					<colinfo id="ins_user_id" size="256" summ="default" type="STRING"/>
					<colinfo id="mod_dtm" size="256" summ="default" type="STRING"/>
					<colinfo id="mod_user_id" size="256" summ="default" type="STRING"/>
					<colinfo id="pol_cl" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_splstPrefer" OnColumnChanged="ds_splstPrefer_OnColumnChanged">
				<Contents>
					<colinfo id="amt_grd_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_from" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_to" size="256" summ="default" type="STRING"/>
					<colinfo id="prefer_grd_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="splst_id" size="256" summ="default" type="STRING"/>
					<colinfo id="aply_ym" size="256" summ="default" type="STRING"/>
					<colinfo id="org_id" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_typ_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_fix_rt" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_fix_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_fix_rt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_fix_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chk" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_amtGrdCl">
				<Contents>
					<colinfo id="seq" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_from" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_to" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_marCl">
				<Contents>
					<colinfo id="COMM_CD_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_CD_VAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_splstPreferCopy" OnColumnChanged="ds_splstPreferCopy_OnColumnChanged" UpdateControl="False">
				<Contents>
					<colinfo id="amt_grd_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_from" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_to" size="256" summ="default" type="STRING"/>
					<colinfo id="prefer_grd_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="splst_id" size="256" summ="default" type="STRING"/>
					<colinfo id="aply_ym" size="256" summ="default" type="STRING"/>
					<colinfo id="org_id" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_typ_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_fix_rt" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_fix_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_fix_rt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_fix_amt" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conditionObj">
				<Contents>
					<colinfo id="APLY_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="HIST_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_TYP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_STA_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_END_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MIN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="END_MIN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPLST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UKEY_AGENCY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="APRV_ST" size="256" summ="default" type="STRING"/>
					<colinfo id="TPLST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APLY_MOD_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_HOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD_MIN" size="256" summ="default" type="STRING"/>
					<record>
						<APLY_DT></APLY_DT>
						<APLY_END_DTM></APLY_END_DTM>
						<APLY_MOD_TM></APLY_MOD_TM>
						<APLY_STA_DTM></APLY_STA_DTM>
						<APLY_YM></APLY_YM>
						<APRV_ST></APRV_ST>
						<DEAL_CO_NM></DEAL_CO_NM>
						<DEL_RSN></DEL_RSN>
						<END_HOUR></END_HOUR>
						<END_MIN></END_MIN>
						<HIST_YN></HIST_YN>
						<HOUR></HOUR>
						<MIN></MIN>
						<MOD_HOUR></MOD_HOUR>
						<MOD_MIN></MOD_MIN>
						<ORG_ID></ORG_ID>
						<SALE_TYP_CD></SALE_TYP_CD>
						<SPLST_ID></SPLST_ID>
						<TPLST_ID></TPLST_ID>
						<UKEY_AGENCY_CD></UKEY_AGENCY_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_compSplstPrefer">
				<Contents>
					<colinfo id="amt_grd_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="amt_from" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="amt_to" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="prefer_grd_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="splst_id" size="256" summ="default" type="STRING"/>
					<colinfo id="aply_ym" size="256" summ="default" type="STRING"/>
					<colinfo id="org_id" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_typ_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_fix_rt" size="256" summ="default" type="STRING"/>
					<colinfo id="mar_fix_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_cl" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_fix_rt" size="256" summ="default" type="STRING"/>
					<colinfo id="sale_cmms_fix_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="chk" size="256" summ="default" type="STRING"/>
					<colinfo id="from_sort" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prodLst">
				<Contents>
					<colinfo id="PROD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condition_prod">
				<Contents>
					<colinfo id="PROD_GROUP_CD" size="256" summ="default" type="STRING"/>
					<record>
						<PROD_GROUP_CD></PROD_GROUP_CD>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Border="Raised" Height="40" Id="div_search" Left="10" Style="sty_div_input" TabOrder="1" Text="질의내용" Top="12" Width="1150">
			<Contents>
				<Static Align="Right" Height="20" Id="Static3" Left="300" Style="sty_lb_Basic" TabOrder="2" Text="적용기간" Top="7" VAlign="Middle" Width="70"></Static>
				<Calendar BindDataset="ds_condition" Border="Flat" ButtonImageID="btn_i_calendar" Column="APLY_STA_DTM" DayFont="Default,-1" Enable="FALSE" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_aplyStaDtm" Left="372" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" OnChanged="div_search_cal_aplyStaDtm_OnChanged" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="2" TodayColor="user26" Top="7" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="90"></Calendar>
				<Static Align="Center" Height="20" Id="Static4" Left="511" TabOrder="3" Text="~" Top="7" VAlign="Middle" Width="20"></Static>
				<Calendar BindDataset="ds_condition" Border="Flat" ButtonImageID="btn_i_calendar" Column="APLY_END_DTM" DayFont="Default,-1" Enable="FALSE" HeaderBorder="NONE" HeaderFont="Default,-1" HeadStyle="sty_calendar_head" Height="20" Id="cal_aplyEndDtm" Left="532" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" RightMargin="2" SaturdayTextColor="user28" Style="sty_calendar" SundayTextColor="user27" TabOrder="2" TodayColor="user26" Top="7" WeeksFont="Default,-1" WeekStyle="sty_calendar_week" Width="90"></Calendar>
				<Static Align="Right" Height="20" Id="Static5" Left="10" Style="sty_lb_Basic" TabOrder="1" Text="적용년월" Top="7" VAlign="Middle" Width="60"></Static>
				<Edit BindDataset="ds_condition" Border="Flat" CanChange="div_search_edt_hour_CanChange" Column="HOUR" Enable="FALSE" Height="20" Id="edt_hour" Left="463" LeftMargin="2" MaxLength="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="0" Top="7" Width="22"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" CanChange="div_search_edt_min_CanChange" Column="MIN" Enable="FALSE" Height="20" Id="edt_min" Left="486" LeftMargin="2" MaxLength="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="1" Top="7" Width="22"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" Column="END_HOUR" Enable="FALSE" Height="20" Id="edt_endHour" Left="623" LeftMargin="2" MaxLength="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="7" Width="22"></Edit>
				<Edit BindDataset="ds_condition" Border="Flat" Column="END_MIN" Enable="FALSE" Height="20" Id="edt_endMin" Left="646" LeftMargin="2" MaxLength="2" Number="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="7" Width="22"></Edit>
				<MaskEdit BindDataset="ds_condition" Border="Flat" Column="APLY_YM" Enable="FALSE" Height="20" Id="cal_polYm" Left="73" LeftMargin="2" Mask="@@@@-@@" MaxLength="6" Readonly="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="10" Top="8" Type="STRING" Width="77"></MaskEdit>
				<Button Cursor="HAND" Enable="FALSE" Height="20" Id="btn_monthCalendar" ImageID="btn_i_calendar" Left="150" OnClick="btn_monthCalendar_OnClick" TabOrder="4" TabStop="FALSE" Text="Button3" Top="8" Width="17"></Button>
				<Button Align="Left" ButtonStyle="TRUE" Height="21" Id="btn_search" ImageID="btn_a_4" Left="1049" LeftMargin="5" OnClick="div_search_btn_search_OnClick" Style="sty_btn_a" TabOrder="12" Text="대상정책" Top="6" Width="91"></Button>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_save" ImageID="btn_c_2" Left="1036" LeftMargin="5" OnClick="df_save" Style="sty_btn_c" TabOrder="3" Text="저장" Top="565" Width="60"></Button>
		<Div Border="Raised" Height="99" Id="div_adjust" Left="10" Style="sty_div_input" TabOrder="2" Text="질의내용" Top="459" Width="1150">
			<Contents>
				<Static Align="Right" Height="20" Id="Static8" Left="12" Style="sty_lb_Basic" TabOrder="0" Text="비고" Top="6" VAlign="Middle" Width="50"></Static>
				<TextArea Border="Flat" CheckLength="Byte" Height="75" Id="txt_rmks" Left="66" MaxLength="90" Style="sty_ipt_form" TabOrder="1" Top="6" VScroll="TRUE" Width="1074"></TextArea>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_delete" ImageID="btn_d_2" Left="1099" LeftMargin="5" OnClick="df_delete" Style="sty_btn_d" TabOrder="4" Text="삭제" Top="565" Width="60"></Button>
		<Image Align="Left" Height="25" Id="Image2" ImageID="bul_tit" Left="13" LeftMargin="15" Style="sty_img_tit" TabOrder="5" Text="조직" Top="53" Width="192"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_orgLst" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="448" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="370" Id="grd_org" InputPanel="FALSE" Left="13" LineColor="user33" MinWidth="100" OnChar="grd_org_OnChar" OnExpandUp="grd_org_OnExpandUp" OnKeyDown="grd_org_OnKeyDown" Right="272" RowHeight="21" Style="sty_Grid" TabOrder="7" TabStop="true" Top="78" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="259">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="110"/>
						<col width="73"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="checkbox" edit="checkbox" rowspan="2"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" rowspan="2" text="*&#32;조직"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" rowspan="2" text="*&#32;판매유형"/>
					</head>
					<body>
						<cell align="center" col="0" colid="chk" display="checkbox" edit="checkbox"/>
						<cell col="1" colid="org_nm" cursor="hand" display="text" edit="expr:decode(FV_NEW_FLAG,&apos;Y&apos;,&apos;normal&apos;,&apos;none&apos;)" expandimage="btn_i_detail_b" expandshow="expr:decode(FV_NEW_FLAG,&apos;Y&apos;,true,false)"/>
						<cell col="2" colid="sale_typ_cd" combocol="COMM_CD_VAL" combodataset="ds_saleTypCd" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:decode(FV_NEW_FLAG,&apos;Y&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="25" Id="Image0" ImageID="bul_tit" Left="584" LeftMargin="15" Style="sty_img_tit" TabOrder="6" Text="마진&#32;및&#32;판매수수료" Top="55" Width="172"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_splstPrefer" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="448" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="370" Id="grd_margin" InputPanel="FALSE" Left="584" LineColor="user33" MinWidth="100" Right="1160" RowHeight="21" Style="sty_Grid" TabOrder="8" TabStop="true" Top="78" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="576">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="92"/>
						<col width="89"/>
						<col width="71"/>
						<col width="73"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" rowspan="2"/>
						<cell bkcolor="user34" col="1" color="user35" display="text" rowspan="2" text="상한금액"/>
						<cell bkcolor="user34" col="2" color="user35" display="text" rowspan="2" text="하한금액"/>
						<cell bkcolor="user34" col="3" color="user35" colspan="3" display="text" text="마진"/>
						<cell bkcolor="user34" col="3" color="user35" display="text" row="1" text="*&#32;구분"/>
						<cell bkcolor="user34" col="4" color="user35" display="text" row="1" text="*&#32;정액(원)"/>
						<cell bkcolor="user34" col="5" color="user35" display="text" row="1" text="*&#32;정율(%)"/>
						<cell bkcolor="user34" col="6" color="user35" colspan="3" display="text" text="수수료"/>
						<cell bkcolor="user34" col="6" color="user35" display="text" row="1" text="*&#32;구분"/>
						<cell bkcolor="user34" col="7" color="user35" display="text" row="1" text="*&#32;정액(원)"/>
						<cell bkcolor="user34" col="8" color="user35" display="text" row="1" text="*&#32;정율(%)"/>
					</head>
					<body>
						<cell align="right" col="0" colid="chk" display="checkbox" edit="checkbox"/>
						<cell align="right" col="1" colid="amt_from" display="text" edit="number"/>
						<cell align="right" col="2" colid="amt_to" display="text" edit="number"/>
						<cell col="3" colid="mar_cl" combocol="COMM_CD_VAL" combodataset="ds_marCl" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:decode(FV_EDIT_FLAG,&apos;Y&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
						<cell col="4" colid="mar_fix_amt" display="number" edit="expr:decode(FV_EDIT_FLAG,&apos;Y&apos;,decode(mar_cl,&apos;1&apos;,&apos;number&apos;,&apos;none&apos;),&apos;none&apos;)"/>
						<cell col="5" colid="mar_fix_rt" display="number" edit="expr:decode(FV_EDIT_FLAG,&apos;Y&apos;,decode(mar_cl,&apos;2&apos;,&apos;number&apos;,&apos;none&apos;),&apos;none&apos;)"/>
						<cell col="6" colid="sale_cmms_cl" combocol="COMM_CD_VAL" combodataset="ds_marCl" combotext="COMM_CD_VAL_NM" display="combo" edit="expr:decode(FV_EDIT_FLAG,&apos;Y&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
						<cell col="7" colid="sale_cmms_fix_amt" display="number" edit="expr:decode(FV_EDIT_FLAG,&apos;Y&apos;,decode(sale_cmms_cl,&apos;1&apos;,&apos;number&apos;,&apos;none&apos;),&apos;none&apos;)"/>
						<cell col="8" colid="sale_cmms_fix_rt" display="number" edit="expr:decode(FV_EDIT_FLAG,&apos;Y&apos;,decode(sale_cmms_cl,&apos;2&apos;,&apos;number&apos;,&apos;none&apos;),&apos;none&apos;)"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="25" Id="Image1" ImageID="bul_tit" Left="280" LeftMargin="15" OnClick="Image1_OnClick" Style="sty_img_tit" TabOrder="9" Text="상품그룹" Top="53" Width="144"></Image>
		<Grid AutoFit="TRUE" BindDataset="ds_preferGrdCl" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="448" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="370" Id="grd_preferGrd" InputPanel="FALSE" Left="280" LineColor="user33" MinWidth="100" OnCellClick="grd_preferGrd_OnCellClick" Right="424" RowHeight="21" Style="sty_Grid" TabOrder="10" TabStop="true" Top="78" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="144">
			<contents>
				<format id="Default">
					<columns>
						<col width="89"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" rowspan="2" text="상품그룹"/>
					</head>
					<body>
						<cell col="0" colid="COMM_CD_VAL_NM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="21" Id="div_excel" Left="197" TabOrder="11" Text="Div2" Top="56" Width="77">
			<Contents>
				<Button Cursor="HAND" Height="21" Id="btn_addRow" ImageID="btn_i_add_w" Left="32" OnClick="div_excel_btn_addRow_OnClick" TabOrder="1" Text="Button1" ToolTipText="행추가" Width="19"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_delRow" ImageID="btn_i_subtract_w" Left="55" OnClick="div_excel_btn_delRow_OnClick" TabOrder="2" Text="Button1" ToolTipText="추가된&#32;행삭제" Width="19"></Button>
			</Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="25" Id="btn_mod" ImageID="btn_c_4" Left="10" LeftMargin="5" OnClick="btn_mod_OnClick" Style="sty_btn_c" TabOrder="12" Text="정책변경" Top="565" Width="85"></Button>
		<Div Border="Raised" Height="37" Id="div_margin" Left="10" Style="sty_div_input" TabOrder="13" Text="질의내용" Top="643" Visible="FALSE" Width="1150">
			<Contents>
				<Static Align="Right" Height="20" Id="Static3" Left="26" Style="sty_lb_Basic" TabOrder="2" Text="마진구분" Top="7" VAlign="Middle" Width="60"></Static>
				<Combo Border="Flat" CodeColumn="COMM_CD_VAL" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_cl" InnerDataset="ds_marCl" Left="88" OnChanged="div_margin_cmb_cl_OnChanged" Style="sty_ipt_form" TabOrder="4" Top="5" Width="99"></Combo>
				<Static Align="Right" Height="20" Id="Static4" Left="274" Style="sty_lb_Basic" TabOrder="1" Text="정액" Top="6" VAlign="Middle" Width="94"></Static>
				<MaskEdit Border="Flat" Height="20" Id="msk_fixAmt" Left="372" LeftMargin="2" Mask="#,###,###,###" MaxLength="10" NullValue="0" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="6" Value="0" Width="102"></MaskEdit>
				<Static Align="Right" Height="20" Id="Static0" Left="578" Style="sty_lb_Basic" TabOrder="5" Text="정율" Top="6" VAlign="Middle" Width="94"></Static>
				<MaskEdit Border="Flat" Height="20" Id="msk_fixRt" Left="676" LeftMargin="2" Mask="###" MaxLength="3" NullValue="0" RightMargin="2" Style="sty_ipt_form" TabOrder="6" Top="6" Value="0" Width="102"></MaskEdit>
				<Button Align="Left" ButtonStyle="TRUE" Height="21" Id="btn_aply" ImageID="btn_a_2" Left="1076" LeftMargin="5" OnClick="div_margin_btn_aply_OnClick" Style="sty_btn_a" TabOrder="7" Text="적용" Top="5" Width="64"></Button>
				<Static Align="Right" Height="20" Id="Static1" Left="468" Style="sty_lb_Basic" TabOrder="8" Text="원" Top="6" VAlign="Middle" Width="20"></Static>
				<Static Align="Right" Height="20" Id="Static2" Left="772" Style="sty_lb_Basic" TabOrder="9" Text="%" Top="6" VAlign="Middle" Width="20"></Static>
			</Contents>
		</Div>
		<Image Align="Left" Height="25" Id="Image3" ImageID="bul_tit" Left="13" LeftMargin="15" OnClick="Image3_OnClick" Style="sty_img_tit" TabOrder="14" Text="마진&#32;일괄적용" Top="621" Visible="FALSE" Width="192"></Image>
		<Image Align="Left" Height="25" Id="Image4" ImageID="bul_tit" Left="13" LeftMargin="15" Style="sty_img_tit" TabOrder="15" Text="수수료&#32;일괄적용" Top="685" Visible="FALSE" Width="192"></Image>
		<Div Border="Raised" Height="37" Id="div_cmms" Left="10" Style="sty_div_input" TabOrder="16" Text="질의내용" Top="707" Visible="FALSE" Width="1150">
			<Contents>
				<Static Align="Right" Height="20" Id="Static3" Left="12" Style="sty_lb_Basic" TabOrder="2" Text="수수료구분" Top="7" VAlign="Middle" Width="74"></Static>
				<Combo Border="Flat" CodeColumn="COMM_CD_VAL" DataColumn="COMM_CD_VAL_NM" Height="20" Id="cmb_cl" InnerDataset="ds_marCl" Left="88" OnChanged="div_cmms_cmb_cl_OnChanged" Style="sty_ipt_form" TabOrder="4" Top="5" Width="99"></Combo>
				<Static Align="Right" Height="20" Id="Static4" Left="274" Style="sty_lb_Basic" TabOrder="1" Text="정액" Top="6" VAlign="Middle" Width="94"></Static>
				<MaskEdit Border="Flat" Height="20" Id="msk_fixAmt" Left="372" LeftMargin="2" Mask="#,###,###,###" MaxLength="10" NullValue="0" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="6" Value="0" Width="102"></MaskEdit>
				<Static Align="Right" Height="20" Id="Static0" Left="578" Style="sty_lb_Basic" TabOrder="5" Text="정율" Top="6" VAlign="Middle" Width="94"></Static>
				<MaskEdit Border="Flat" Height="20" Id="msk_fixRt" Left="676" LeftMargin="2" Mask="###" MaxLength="3" NullValue="0" RightMargin="2" Style="sty_ipt_form" TabOrder="6" Top="6" Value="0" Width="102"></MaskEdit>
				<Button Align="Left" ButtonStyle="TRUE" Height="21" Id="btn_aply" ImageID="btn_a_2" Left="1076" LeftMargin="5" OnClick="div_cmms_btn_aply_OnClick" Style="sty_btn_a" TabOrder="7" Text="적용" Top="5" Width="64"></Button>
				<Static Align="Right" Height="20" Id="Static1" Left="468" Style="sty_lb_Basic" TabOrder="8" Text="원" Top="6" VAlign="Middle" Width="20"></Static>
				<Static Align="Right" Height="20" Id="Static2" Left="772" Style="sty_lb_Basic" TabOrder="9" Text="%" Top="6" VAlign="Middle" Width="20"></Static>
			</Contents>
		</Div>
		<Div Height="21" Id="div_row" Left="1085" TabOrder="17" Text="Div2" Top="56" Width="77">
			<Contents>
				<Button Cursor="HAND" Height="21" Id="btn_addRow" ImageID="btn_i_add_w" Left="32" OnClick="div_row_btn_addRow_OnClick" TabOrder="1" Text="Button1" ToolTipText="행추가" Width="19"></Button>
				<Button Cursor="HAND" Height="21" Id="btn_delRow" ImageID="btn_i_subtract_w" Left="55" OnClick="div_row_btn_delRow_OnClick" TabOrder="2" Text="Button1" ToolTipText="추가된&#32;행삭제" Width="19"></Button>
			</Contents>
		</Div>
		<Grid AutoFit="TRUE" BindDataset="ds_prodLst" BkColor2="user32" BoldHead="true" Border="Flat" Bottom="448" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="Control" HeadBorder="Flat" HeadHeight="22" Height="370" Id="Grid0" InputPanel="FALSE" Left="432" LineColor="user33" MinWidth="100" Right="576" RowHeight="21" Style="sty_Grid" TabOrder="18" TabStop="true" Top="78" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="user33" WheelScrollRow="1" Width="144">
			<contents>
				<format id="Default">
					<columns>
						<col width="89"/>
					</columns>
					<head>
						<cell bkcolor="user34" col="0" color="user35" display="text" rowspan="2" text="적용모델"/>
					</head>
					<body>
						<cell col="0" colid="PROD_NM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* 프로그램ID : POLSPM00200
* 업무명      : 판매가격표
* 프로그램명  : 판매가격표(선호도) 등록
--------------------------------------------------------------------------------
* 작성자      : 이문규
* 작성일      : 2011.10.11
--------------------------------------------------------------------------------
* 1. 변경이력
수정자    :
수정일    :
수정 내역 :
*******************************************************************************/

/*******************************************************************************
// 1. 전 처리기
*******************************************************************************/
#include "lib::lib_commF.js"
#include "lib::lib_commPopup.js"
#include "lib::lib_util.js"

/*******************************************************************************
// 2. 폼 변수 정의
*******************************************************************************/
var FV_STR_NAME; 			//사용자 이름
var SAVE_FLAG = "N";
var APRV_SAVE_FLAG = "N"; 	//승인요청,저장 구분 FLAG
var PRE_APLY_STA_DTM = ""; 
var FV_USER_ID;				// 사용자ID
var FV_USER_NM;				// 사용자명
var FV_ORG_ID;				// 소속
var FV_ORG_CL;				// 소속구분

var FV_KEY_SPLST_ID;        // 가격표ID
var FV_KEY_APLY_YM;         // 적용년월
var FV_KEY_ORG_ID;          // 조직 ID
var FV_KEY_SALE_TYP_CD;     // 판매유형
var FV_APLY_STA_DTM;
var FV_APLY_END_DTM;
var FV_NEW_FLAG;            // 신규 구분
var FV_EDIT_FLAG;           // 수정 구분
var FV_PRE_FRM_NUM;         // 이전화면폼

/*******************************************************************************
* 함수명 : POLASP00200_OnLoadCompleted
* 기능명 : OnLoadCompleted 이벤트
*******************************************************************************/
function POLSPM00200_OnLoadCompleted(obj)
{
	//cf_setGrdChecknSortEvent(grd_polSplst);	// 그리드 정렬
	// 권한 설정
	cf_setAuth(pFrmNum);
		
	lf_getSession();           
	lf_setCombo();
	lf_setInit();
			
	http.Sync = true;
	
	if(uf_isNull(FV_KEY_SPLST_ID) == true && FV_NEW_FLAG == "Y"){ //신규버튼 클릭시
	
	    //f_getAmtGrdCl();   // 금액 그리드 조회

        FV_EDIT_FLAG = "Y";
	}else{

	    f_getSplst();    // 판매가격표, 선호도별 판매가격표 조회
	    
	}
	
	// 일괄적용항목 enable 처리
	lf_setAplyInit();
        
	http.Sync = false;

}

/*******************************************************************************
 * @description    : 글로벌 세션 정보
*******************************************************************************/
function lf_getSession()
{
    // 파라메터
    if(IsExistVar("SPLST_ID"      ,true)){ FV_KEY_SPLST_ID = SPLST_ID; }
    if(IsExistVar("APLY_YM"       ,true)){ FV_KEY_APLY_YM = APLY_YM; }
    if(IsExistVar("ORG_ID"        ,true)){ FV_KEY_ORG_ID = ORG_ID; }
    if(IsExistVar("SALE_TYP_CD"   ,true)){ FV_KEY_SALE_TYP_CD = SALE_TYP_CD; }
    if(IsExistVar("APLY_STA_DTM"  ,true)){ FV_APLY_STA_DTM = APLY_STA_DTM; }
    if(IsExistVar("APLY_END_DTM"  ,true)){ FV_APLY_END_DTM = APLY_END_DTM; }
    if(IsExistVar("NEW_FLAG"      ,true)){ FV_NEW_FLAG = NEW_FLAG;   }
    if(IsExistVar("FV_PRE_FRM_NUM",true)){ FV_PRE_FRM_NUM = PRE_FRM_NUM;   }

    // 글러벌 세션
	FV_USER_ID    = gds_session.GetColumn(0, "loginid");						// 사용자ID
	FV_USER_NM    = gds_session.GetColumn(0, "usernm");		
	
	FV_ORG_ID     = gds_session.GetColumn(0, "orgid");
	FV_ORG_CL     = gds_session.GetColumn(0, "orgcl");	
}

/*******************************************************************************
 * @description    : 조회 조건상의 Combox 항목에 공통코드를 설정
*******************************************************************************/
function lf_setCombo()
{
	http.Sync = true;
	cf_setCommonCodeDsEnv();
	cf_setCommonCode("ds_saleTypCd"  , "ZPOL_C_00030");   		//판매유형
	//cf_setCommonCode("ds_preferGrdCl", "ZBAS_P_00070"); 		//선호도
	cf_setCommonCode("ds_preferGrdCl", "ZPOL_C_00560"); 		//상품그룹
	cf_setCommonCode("ds_marCl"      , "ZPOL_C_00550", "선택"); 		//마진구분
	cf_checkCommonCode(); 
	http.Sync = false;		
}

/*******************************************************************************
* 함수명 : lf_setInit
* 기능명 : 도매가격표관리에서 신규버튼 클릭시 초기세팅
*******************************************************************************/
function lf_setInit()
{

    if (FV_NEW_FLAG == "Y"){
        //신규일때
        div_search.btn_search.Enable = true;
        div_excel.btn_addRow.Enable = true;
        div_excel.btn_delRow.Enable = true;
        
        grd_org.Enable = true;
        grd_preferGrd.Enable = true;
        grd_margin.Enable = true;
        
        div_adjust.txt_rmks.Enable = true;
        btn_save.Enable = true;
        btn_delete.Enable = true;
    
    }else{
        //수정일때
        //정책종료 버튼과 삭제 버튼만 활성화
        div_search.btn_search.Enable = false;
        div_excel.btn_addRow.Enable = false;
        div_excel.btn_delRow.Enable = false;
        
        div_adjust.txt_rmks.Enable = false;
        btn_save.Enable = true;
        btn_delete.Enable = true;
    }
    
    var sStaAplyDt = "";
    var sStaHour   = "";
    var sStaMin    = "";
    var sEndAplyDt = "";
    var sEndHour   = "";
    var sEndMin    = "";
    var lastDay    = "";

    if (FV_NEW_FLAG == "Y"){
    
        sStaAplyDt = FV_KEY_APLY_YM + "01";
        sStaHour = "00";
        sStaMin  = "00";

	    lastDay = uf_MonthLastDay(FV_KEY_APLY_YM+"01");
	    
        sEndAplyDt = FV_KEY_APLY_YM + lastDay;	    
        sEndHour = "23";
        sEndMin  = "59";

    }else{
    
        sStaAplyDt = substr(FV_APLY_STA_DTM,0,8);
        sStaHour   = substr(FV_APLY_STA_DTM,8,2);
        sStaMin    = substr(FV_APLY_STA_DTM,10,2);

	    //lastDay = uf_MonthLastDay(FV_KEY_APLY_YM+"01");
	    
        sEndAplyDt = substr(FV_APLY_END_DTM,0,8);
        sEndHour   = substr(FV_APLY_END_DTM,8,2);
        sEndMin    = substr(FV_APLY_END_DTM,10,2);
    }
    
    // 조건값을 ds에 셋팅
	cf_setParam(ds_condition, "splst_id"    , FV_KEY_SPLST_ID);
	cf_setParam(ds_condition, "aply_ym"     , FV_KEY_APLY_YM);
	cf_setParam(ds_condition, "org_id"      , FV_KEY_ORG_ID);
	cf_setParam(ds_condition, "sale_typ_cd" , FV_KEY_SALE_TYP_CD);
	cf_setParam(ds_condition, "aply_sta_dtm", sStaAplyDt);
	cf_setParam(ds_condition, "hour"        , sStaHour);
	cf_setParam(ds_condition, "min"         , sStaMin);
	cf_setParam(ds_condition, "aply_end_dtm", sEndAplyDt);
	cf_setParam(ds_condition, "end_hour"    , sEndHour);
	cf_setParam(ds_condition, "end_min"     , sEndMin);

}

/*******************************************************************************
* 함수명 : lf_setAplyInit
* 기능명 : 
*******************************************************************************/
function lf_setAplyInit()
{
    if (FV_EDIT_FLAG == "Y"){
        div_margin.cmb_cl.Enable = true;
        div_margin.msk_fixAmt.Enable = false;
        div_margin.msk_fixRt.Enable = false;
        div_margin.btn_aply.Enable = true;

        div_cmms.cmb_cl.Enable = true;
        div_cmms.msk_fixAmt.Enable = false;
        div_cmms.msk_fixRt.Enable = false;
        div_cmms.btn_aply.Enable = true;
    }else{
        div_margin.cmb_cl.Enable = false;
        div_margin.msk_fixAmt.Enable = false;
        div_margin.msk_fixRt.Enable = false;
        div_margin.btn_aply.Enable = false;

        div_cmms.cmb_cl.Enable = false;
        div_cmms.msk_fixAmt.Enable = false;
        div_cmms.msk_fixRt.Enable = false;
        div_cmms.btn_aply.Enable = false;
    }
    
    return;
}

/*******************************************************************************
* 함수명 : df_reSet
* 기능명 : 화면 초기화
*******************************************************************************/
function df_reSet(sArg)
{

}

/*******************************************************************************
* 함수명 : f_callBack 
* 기능명 : 트랜잭션 콜백 
* 파라미터
1. sSvcID  : 서비스 아이디
*******************************************************************************/
function f_callBack(sSvcID)
{
	if(sSvcID == "svcGetAmtGrdCl" ){
        
		ds_splstPrefer.FireEvent = false;	
	    var rowCntP = ds_preferGrdCl.rowcount;
	    var rowCntA = ds_amtGrdCl.rowcount;
	    
	    
	    // 선호도 그리드에 바인드할 dataset 생성
	    //ds_preferLst.Clear();
	    //for (i = 0 ; i < rowCntP ; i++){
	    //    ds_preferLst.AddRow();
	    //    ds_preferLst.SetColumn(i,"prefer_grd_cl", ds_preferGrdCl.GetColumn(i,"comm_cd_val"));
	    //    ds_preferLst.SetColumn(i,"prefer_grd_cl", ds_preferGrdCl.GetColumn(i,"comm_cd_val"));
	    //}

        var iCnt = 0;
	    //ds_splstPrefer.Clear();
	    
	    for (i = 0 ; i < rowCntP ; i++){
	        for (j = 0; j < rowCntA ; j++) {
	            
				ds_splstPrefer.AddRow();

				ds_splstPrefer.SetColumn(iCnt, "prefer_grd_cl", ds_preferGrdCl.GetColumn(i,"comm_cd_val"));
				
				ds_splstPrefer.SetColumn(iCnt, "amt_grd_cl"   , ds_amtGrdCl.GetColumn(j,"amt_grd_cl"));
				ds_splstPrefer.SetColumn(iCnt, "amt_from"     , ds_amtGrdCl.GetColumn(j,"amt_from"));
				ds_splstPrefer.SetColumn(iCnt, "amt_to"       , ds_amtGrdCl.GetColumn(j,"amt_to"));
				
				iCnt++;
				
			}
	    }
	    
	    ds_splstPrefer.Filter("prefer_grd_cl='"+ds_preferGrdCl.GetColumn(ds_preferGrdCl.currow, "comm_cd_val")+"'");
        grd_margin.BindDataset = "ds_splstPrefer";
        
		ds_splstPrefer.FireEvent = true;        	    
	}
	
	if(sSvcID == "svcGetSplst" ){
		    
		//trace(ds_splst.SaveXML());
		//trace(ds_splstPrefer.SaveXML());
		    
		ds_splstPrefer.FireEvent = false;
		    
		var rowCntP = ds_splst.rowcount;
	    var rowCntA = ds_splstPrefer.rowcount;
	    
	    ds_orgLst.ClearData();
	    for (i = 0 ; i < rowCntP ; i++){
	        ds_orgLst.AddRow();
	        ds_orgLst.SetColumn(i, "org_id" , ds_splst.GetColumn(i,"org_id"));
	        ds_orgLst.SetColumn(i, "org_nm" , ds_splst.GetColumn(i,"org_nm"));
	        ds_orgLst.SetColumn(i, "sale_typ_cd" , ds_splst.GetColumn(i,"sale_typ_cd"));
	    }
	    
        ds_splstPrefer.Filter("prefer_grd_cl='"+ds_preferGrdCl.GetColumn(0, "comm_cd_val")+"'");	    
        
        grd_margin.BindDataset = "ds_splstPrefer";
        
		ds_splstPrefer.FireEvent = true;

        div_adjust.txt_rmks.Text = ds_splst.GetColumn(0,"rmks");
        // 마진 및 수수료에 대한 수정 가능 flag
		if (ds_splst.GetColumn(0,"aply_ym") == substr(cf_getDate(),0,6) ) {
		
		    if (ds_splst.GetColumn(0,"aply_sta_dtm") >= substr(cf_getDate(),0,12)) {
		        FV_EDIT_FLAG = "Y";
		    } else {
		        FV_EDIT_FLAG = "N";
		    }
            
        }else{
            FV_EDIT_FLAG = "Y";
        }
        
        //
	}else if (sSvcID == "svcGetObjSplst" ) {
		ds_splstPrefer.FireEvent = false;
		    
		var rowCntP = ds_splst.rowcount;
	    var rowCntA = ds_splstPrefer.rowcount;
	    
	    ds_orgLst.ClearData();
	    for (i = 0 ; i < rowCntP ; i++){
	        ds_orgLst.AddRow();
	        ds_orgLst.SetColumn(i, "org_id" , ds_splst.GetColumn(i,"org_id"));
	        ds_orgLst.SetColumn(i, "org_nm" , ds_splst.GetColumn(i,"org_nm"));
	        ds_orgLst.SetColumn(i, "sale_typ_cd" , ds_splst.GetColumn(i,"sale_typ_cd"));
	    }
	    
        ds_splstPrefer.Filter("prefer_grd_cl='"+ds_preferGrdCl.GetColumn(0, "comm_cd_val")+"'");	    
        
        grd_margin.BindDataset = "ds_splstPrefer";
        
		ds_splstPrefer.FireEvent = true;

        // 마진 및 수수료에 대한 수정 가능 flag
        FV_EDIT_FLAG = "Y";
	}

	if(sSvcID == "svcSavePolSplst" || sSvcID == "svcSplstPreferChg" ){
	    alert("저장되었습니다.");
		gf_movenCall(FV_PRE_FRM_NUM, "div_search_btn_get_OnClick", "");
        this.Close();
	}

	if(sSvcID == "svcModSplstPrefer"){
	    alert("저장되었습니다.");
		gf_movenCall(FV_PRE_FRM_NUM, "div_search_btn_get_OnClick", "");
        this.Close();
	}
	
	if(sSvcID == "svcDelSplst"){
	    alert("삭제되었습니다.");
		gf_movenCall(FV_PRE_FRM_NUM, "div_search_btn_get_OnClick", "");
        this.Close();
	}
}

/*******************************************************************************
* 함수명 : df_search
* 기능명 : 공통 조회 버튼 클릭
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function df_search(sButtonID)
{
	var sSvcID = "svcSearch";
	var sInDs = "ds_condition=ds_condition";
	var sOutDs = "ds_polSplstTmp=ds_polSplstTmp";
	var sArg = "sktst.pol.ASP#getPolSpLstDetail";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	
}

/*******************************************************************************
 * @description    : 공통 저장 함수
*******************************************************************************/
function df_save()
{
    // 조직 validation check
    // 마진 및 판매수수료 validation check
    
    // tpol_splst 판매가격표 dataset 셋팅
    var rowCntOrg    = ds_orgLst.rowcount;
    var rowCntSplst  = ds_splstPrefer.RowCountNF();

	alert('1');

    // 조직 validation check
    // 마진 및 판매수수료 validation check
    
    // 조직, 판매유형 null 체크
    if( rowCntOrg <= 0 ) {
        alert("대상 조직을 선택해 주십시요.");
        return;
    }
    
    for( i = 0 ; i < rowCntOrg ; i++ ) {

        if( uf_isEmpty(ds_orgLst.GetColumn(i,"org_id")) ) {
            alert("대상 조직을 입력해 주십시요.");
            f_set_gridFocus(grd_org, i, 1);
            return;
        }

        if( uf_isEmpty(ds_orgLst.GetColumn(i,"sale_typ_cd")) ) {
            alert("판매유형을 입력해 주십시요.");
            f_set_gridFocus(grd_org, i, 2);
            return;
        }

        if ( (i + 1) < rowCntOrg ) { 
            rowSearch = ds_orgLst.SearchRow("org_id='"+ds_orgLst.GetColumn(i,"org_id")+"' AND sale_typ_cd='"+ds_orgLst.GetColumn(i,"sale_typ_cd")+"'", i+1);
            if (rowSearch != -1){
                alert("중복된 조직,판매유형이 있습니다.");
                return;
            }
        }        
    }
    
    alert('2');
    
    if ( f_amtValidation() == "false" ) {
        return;
    }
    
    var msg = "";
    /*
    for( i = 0 ; i < rowCntSplst ; i++ ) {

		msg = "[";
		msg = msg + ds_preferGrdCl.GetColumn(ds_preferGrdCl.FindRow("comm_cd_val", ds_splstPrefer.GetColumnNF(i,"prefer_grd_cl")),"comm_cd_val_nm") + ",";
		msg = msg + ds_splstPrefer.GetColumnNF(i,"amt_from") + "-";
		msg = msg + ds_splstPrefer.GetColumnNF(i,"amt_to") + "";
		msg = msg +"]";
    
        if( uf_isEmpty(ds_splstPrefer.GetColumnNF(i,"mar_cl")) ) {
            alert(msg + " 마진구분을 입력해 주십시요.");
            return;
        }

        if( ds_splstPrefer.GetColumnNF(i,"mar_cl") == "1" && uf_isEmpty(ds_splstPrefer.GetColumnNF(i,"mar_fix_amt")+"") ) {
            alert(msg + " 마진금액을 입력해 주십시요.");
            return;
        }

        if( ds_splstPrefer.GetColumnNF(i,"mar_cl") == "2" && uf_isEmpty(ds_splstPrefer.GetColumnNF(i,"mar_fix_rt")+"") ) {
            alert(msg + " 마진율을 입력해 주십시요.");
            return;
        }

        if( uf_isEmpty(ds_splstPrefer.GetColumnNF(i,"sale_cmms_cl")) ) {
            alert(msg + " 수수료구분을 입력해 주십시요.");
            return;
        }

        if( ds_splstPrefer.GetColumnNF(i,"sale_cmms_cl") == "1" && uf_isEmpty(ds_splstPrefer.GetColumnNF(i,"sale_cmms_fix_amt")+"") ) {
            alert(msg + " 수수료금액을 입력해 주십시요.");
            return;
        }

        if( ds_splstPrefer.GetColumnNF(i,"sale_cmms_cl") == "2" && uf_isEmpty(ds_splstPrefer.GetColumnNF(i,"sale_cmms_fix_rt")+"") ) {
            alert(msg + " 수수료율을 입력해 주십시요.");
            return;
        }
    }
    */
	var sSvcID = "";
	var sInDs  = "";
	var sOutDs = "";
	var sArg   = "";
	
	if ( FV_NEW_FLAG == "Y" ) {
        // 신규
         
		var iCnt = 0;
		
		ds_splst.ClearData();
		ds_splstPreferCopy.ClearData();
		
		for ( i = 0 ; i < rowCntOrg ; i++ ) {
			
			// tpol_splst 판매가격표 dataset 셋팅
			ds_splst.AddRow();
			ds_splst.SetColumn(i, "splst_id"    , "");
			ds_splst.SetColumn(i, "aply_ym"     , APLY_YM);
			ds_splst.SetColumn(i, "org_id"      , ds_orgLst.GetColumn(i, "org_id"));
			ds_splst.SetColumn(i, "sale_typ_cd" , ds_orgLst.GetColumn(i, "sale_typ_cd"));
			ds_splst.SetColumn(i, "aply_sta_dtm", substr(ds_condition.getColumn(0,"APLY_STA_DTM"),0,8) + ds_condition.GetColumn(0,"hour") + ds_condition.GetColumn(0,"min"));
			ds_splst.SetColumn(i, "aply_end_dtm", substr(ds_condition.getColumn(0,"APLY_END_DTM"),0,8) + ds_condition.GetColumn(0,"end_hour") + ds_condition.GetColumn(0,"end_min"));
			ds_splst.SetColumn(i, "pol_cl"      , "01");
			ds_splst.SetColumn(i, "rmks"        , div_adjust.txt_rmks.Text);
	
			ds_splstPrefer.FireEvent = false;
			ds_splstPrefer.UnFilter();
			for ( j = 0 ; j < rowCntSplst ; j++ ) {
				
				// tpol_splst_prefer 선호도별 판매가격표 dataset 셋팅
				ds_splstPreferCopy.AddRow();
				ds_splstPreferCopy.CopyRow(iCnt, "ds_splstPrefer", j);
				 
				ds_splstPreferCopy.SetColumn(iCnt, "splst_id"    , "");
				ds_splstPreferCopy.SetColumn(iCnt, "aply_ym"     , APLY_YM);
				ds_splstPreferCopy.SetColumn(iCnt, "org_id"      , ds_orgLst.GetColumn(i, "org_id"));
				ds_splstPreferCopy.SetColumn(iCnt, "sale_typ_cd" , ds_orgLst.GetColumn(i, "sale_typ_cd"));
				
				ds_splstPreferCopy.SetRowType(iCnt, ds_splstPrefer.GetRowType(j));
							
				iCnt++;
				
			}
			trace('3');
			ds_splstPrefer.Filter("prefer_grd_cl='"+ds_preferGrdCl.GetColumn(ds_preferGrdCl.row, "comm_cd_val")+"'");
			ds_splstPrefer.FireEvent = true;
	
		}

		 sSvcID = "svcSavePolSplst";
		 sInDs  = "ds_splst=ds_splst ds_splstPreferCopy=ds_splstPreferCopy";
		 sOutDs = "";
		 sArg   = "sktst.pol.SPM#savePolSplst";		
     } else {
         // 수정
		 sSvcID = "svcModSplstPrefer";
		 sInDs  = "ds_splst=ds_splst ds_splstPreferCopy=ds_splstPrefer:U";
		 sOutDs = "";
		 sArg   = "sktst.pol.SPM#updateSplstPrefer";
     }
     trace('4');
	 cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
    
	return;

}

/*******************************************************************************
* 함수명 : f_getAmtGrdCl
* 기능명 : 금액 그리드 조회
* 파라미터
1. sButtonID  : 
*******************************************************************************/
function f_getAmtGrdCl()
{
	var sSvcID = "svcGetAmtGrdCl";
	var sInDs = "nc_input_fieldDs=ds_condition";
	var sOutDs = "ds_amtGrdCl=ds_amtGrdCl";
	var sArg = "sktst.pol.SPM#getAmtGrdCl";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	
}

/*******************************************************************************
* 함수명 : f_getSplst
* 기능명 : 판매가격표 및 선호도별 판매가격표 조회
* 파라미터
1. sButtonID  : 
*******************************************************************************/
function f_getSplst()
{
    //trace(ds_condition.SaveXML());
    
	var sSvcID = "svcGetSplst";
	var sInDs = "nc_input_fieldDs=ds_condition";
	var sOutDs = "ds_splst=ds_splst ds_splstPrefer=ds_splstPrefer";
	var sArg = "sktst.pol.SPM#getSplstPreferLst";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	
}

/*******************************************************************************
* 함수명 : f_pre_save
* 기능명 : 저장버튼 전 체크함수 
*******************************************************************************/
function f_pre_delete()
{
	
	if(NEW_FLAG == "Y"){
		alert(cf_getMessage(MSG_00138, "신규등록 화면"));
		return false;
	}
	
	if(ds_polSplstTmp.rowcount < 1){
		return false;
	}
	
	if(HIST_FLAG == "Y"){
		alert(cf_getMessage(MSG_00138, "종결된 도매가격표"));
		return false;
	}
	
	
	if(CRUD_FLAG != "Y"){
		alert(cf_getMessage(MSG_00130, "최종 도매가격표"));
		return false;
	}
	
    return true;
}

/*******************************************************************************
* 함수명 : df_delete
* 기능명 : 공통 수정 버튼 클릭
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function df_delete(sButtonID)
{
	var sCurrYYmm = substr(cf_today(),0,6);

    if ( FV_NEW_FLAG == "Y" ) {
	    alert("삭제할 판매가격표가 없습니다.");
	    return;
    }
    
	if ( FV_KEY_APLY_YM <= sCurrYYmm ){
	    alert("미적용 판매가격표만 삭제할수 있습니다.");
	    return;
	}
	
	var sSvcID = "svcDelSplst";
	var sInDs = "nc_input_fieldDs=ds_condition";
	var sOutDs = "";
	var sArg = "sktst.pol.SPM#deleteSplstPrefer";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	
	return;
}

/*******************************************************************************
* 함수명 : btn_mod_OnClick
* 기능명 : 정책변경 버튼 
*******************************************************************************/
function btn_mod_OnClick(obj)
{	
	var sArg = " APLY_STA_DTM=" + quote(ds_condition.getColumn(0,"APLY_STA_DTM"));
		sArg += " HOUR=" + quote(ds_condition.getColumn(0,"HOUR"));
		sArg += " MIN=" + quote(ds_condition.getColumn(0,"MIN"));
		sArg += " APLY_END_DTM=" + quote(ds_condition.getColumn(0,"APLY_END_DTM"));
		sArg += " END_HOUR=" + quote(ds_condition.getColumn(0,"END_HOUR"));
		sArg += " END_MIN=" + quote(ds_condition.getColumn(0,"END_MIN"));
		sArg += " POL_CL=" + quote('1');
		sArg += " MOD_FLAG=" + quote('Y');
		
	var rtn = dialog("POL::POLSPM00400.xml", sArg, 336, 128);

	if(rtn == 1){
	
		if(confirm(cf_getMessage(MSG_00136, "새로운 판매가격표를 등록")) == 1){
			
			//ds_polSplstTmp.Reset(); //정책변경시에는 초기가격표 그대로 복원한다.
			
			//div_search_btn_search_OnClick();
			
			var sSvcID = "svcSplstPreferChg";
			var sInDs = "ds_condition=ds_condition ds_splst=ds_splst";
			var sOutDs = "";
			var sArg = "sktst.pol.SPM#saveSplstPreferChg";
			
			cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
				
		}else{
		
			//cf_setParam(ds_condition,"APLY_STA_DTM"  ,substr(PRE_APLY_STA_DTM,0,8));
			//cf_setParam(ds_condition,"HOUR"          ,substr(PRE_APLY_STA_DTM,8,2));
			//cf_setParam(ds_condition,"MIN"         	 ,substr(PRE_APLY_STA_DTM,10,2));
	
		}
	}
    return;
}

/*******************************************************************************
* 함수명 : df_update
* 기능명 : 공통 수정 버튼 클릭
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function df_update(sButtonID)
{

}

/*******************************************************************************
* 함수명 : df_close
* 기능명 : 화면 종료
*******************************************************************************/
function df_close(sButtonID)
{
	this.close();
}

/*******************************************************************************
* 함수명 : f_dupSplstKey
* 기능명 : 판매가격표의 등록여부 key 체크
* 파라미터
1. sButtonID  : 버튼 아이디
*******************************************************************************/
function f_dupSplstKey()
{
/*
	ds_splstKey.ClearData();
		
	var sSvcID = "svcSplstKey";
	var sInDs = "nc_input_fieldDs=ds_Condition";
	var sOutDs = "ds_splstKey=ds_splstKey";
	var sArg = "sktst.pol.ASP#getSplstKey";
	
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
*/	
}

/*******************************************************************************
* 함수명 : div_search_btn_search_OnClick
* 기능명 :  모델선택버튼 OnClick 이벤트 발생
*******************************************************************************/
function div_search_btn_search_OnClick(obj)
{
	var sArg  = "APLY_YM="+quote(div_search.cal_polYm.Value);
        sArg += " SALE_TYP_CD=" + quote(ds_condition.getColumn(0,"SALE_TYP_CD")); 
        sArg += " ORG_ID=" + quote(ds_condition.getColumn(0,"ORG_ID"));
        sArg += " APLY_STA_DTM=" + quote(ds_condition.getColumn(0,"APLY_STA_DTM"));
	    sArg += " HOUR=" + quote(ds_condition.getColumn(0,"HOUR")); 
	    sArg += " MIN=" + quote(ds_condition.getColumn(0,"MIN"));
	    sArg += " POL_CL=" + quote("01");
	    	    
	var rtn = dialog("POL::POLSPM00210.xml", sArg, 336, 128);
	
	if (rtn[0] == "1"){
	
	    ds_conditionObj.SetColumn(0,"splst_id", rtn[1]);
	    ds_conditionObj.SetColumn(0,"aply_ym", rtn[2]);
	    ds_conditionObj.SetColumn(0,"org_id", rtn[3]);
	    ds_conditionObj.SetColumn(0,"sale_typ_cd", rtn[4]);
	    
	    var sSvcID = "svcGetObjSplst";
	    var sInDs = "nc_input_fieldDs=ds_conditionObj";
	    var sOutDs = "ds_splst=ds_splst ds_splstPrefer=ds_splstPrefer";
	    var sArg = "sktst.pol.SPM#getSplstPreferLst";
	
	    cf_Transaction(sSvcID, sInDs, sOutDs, sArg);
	}
    
    return;
}

/*******************************************************************************
* 함수명 : div_search_cal_aplyStaDtm_CanChange
* 기능명 :  적용기간 시작일 CanChange 발생시
*******************************************************************************/
function div_search_cal_aplyStaDtm_OnChanged(obj,strOldText,strNewText)
{	
	if(strOldText != strNewText){

		if (!(f_compareDate(obj,strOldText,strNewText,"Y"))) return;
		
	}
}

/*******************************************************************************
* 함수명 : div_search_edt_hour_CanChange
* 기능명 :  적용기간 시간 CanChange 발생시
*******************************************************************************/
function div_search_edt_hour_CanChange(obj,stroldText,strText)
{
	if(strOldText != strText){

		if (!(f_compareDate(obj,strOldText,strText,"H"))) return;
		
	}
}

/*******************************************************************************
* 함수명 : div_search_edt_min_CanChange
* 기능명 :  적용기간 분 CanChange 발생시
*******************************************************************************/
function div_search_edt_min_CanChange(obj,stroldText,strText)
{
	if(strOldText != strText){

		if (!(f_compareDate(obj,strOldText,strText,"M"))) return;
		
	}
}

/*******************************************************************************
* 함수명 : f_compareDate
* 기능명 :  시작일자 종료일자 비교
*******************************************************************************/
function f_compareDate(obj,stroldText,strText,flag)
{
	var startDate = "";
	
	if(flag == "Y"){
		
		startDate = strText + ds_condition.GetColumn(0,"HOUR") + ds_condition.GetColumn(0,"MIN");
				 
    }else if(flag == "H"){
		
		if(strText > 23){
			obj.text = "00";
			obj.SetFocus();
			alert(cf_getMessage(MSG_00034, "23시"));
			return false;
		}
		
    	startDate = ds_condition.GetColumn(0,"APLY_STA_DTM") + strText + ds_condition.GetColumn(0,"MIN");
    	
	}else if(flag == "M"){
		
		if(strText > 59){
			obj.text = "00";
			obj.SetFocus();
			alert(cf_getMessage(MSG_00034, "59분"));
			return false;
		}
		
    	startDate = ds_condition.GetColumn(0,"APLY_STA_DTM") + ds_condition.GetColumn(0,"HOUR") + strText;              
	}  
	  
	var endtDate = ds_condition.GetColumn(0,"APLY_END_DTM") + ds_condition.GetColumn(0,"END_HOUR") + ds_condition.GetColumn(0,"END_MIN");	

	if(startDate >= endtDate){
	
		cf_setParam(ds_condition,"APLY_STA_DTM", stroldText);
		obj.setFocus();
		alert(cf_getMessage(MSG_00094, "적용기간 시작일자;적용기간 종료일자"));
		return false;
		
	}else if(substr(startDate,0,6) != substr(endtDate,0,6)){
		
		cf_setParam(ds_condition,"APLY_STA_DTM", stroldText);
		obj.setFocus();
		alert(cf_getMessage(MSG_00087, "적용년월"));
		return false;
				
	}else{
		return true;
	}

}


/*******************************************************************************
* 함수명 : f_set_gridFocus
* 기능명 : 그리드 포커스 이동
*******************************************************************************/
function f_set_gridFocus(gridObj, nRow, nCellIdx) 
{	
	var dataSetObj = object(gridObj.bindDataset);
	dataSetObj.row = nRow;
	gridObj.SetCellPos(nCellIdx);
	gridObj.SetFocus();
}

/*******************************************************************************
 * @description    :  월달력 사용 - 이벤트
*******************************************************************************/
function btn_monthCalendar_OnClick(obj)
{
	cf_callMonthCalendar(div_search.cal_polYm);
}

/*******************************************************************************
* 함수명 : btn_import_OnClick
* 기능명 :  엑셀 export
*******************************************************************************/
function btn_export_OnClick(obj)
{
	//cf_exportExcel(grd_polSplst);
}

/*******************************************************************************
 * @description    :  조직 그리드의 row 추가
*******************************************************************************/
function div_excel_btn_addRow_OnClick(obj)
{
	ds_orgLst.AddRow();
}

/*******************************************************************************
 * @description    :  조직 그리드의 row 삭제
*******************************************************************************/
function div_excel_btn_delRow_OnClick(obj)
{
    var rowCnt = ds_orgLst.rowcount;
        
    https.Sync = true;
    
    for ( i = rowCnt ; i >= 0 ; i--){
        if (ds_orgLst.GetColumn(i,"chk") == "1") {
            ds_orgLst.DeleteRow(i);
        }
    }
    
    https.Sync = false;
	
}

/*******************************************************************************
 * @description    :  조직 그리드의 row 추가
*******************************************************************************/
function div_row_btn_addRow_OnClick(obj)
{
	ds_splstPrefer.AddRow();
	trace(ds_preferGrdCl.GetColumn('1='+ds_preferGrdCl.row,"comm_cd_val"));
	ds_splstPrefer.SetColumn(ds_splstPrefer.row, "prefer_grd_cl", ds_preferGrdCl.GetColumn(ds_preferGrdCl.row,"comm_cd_val"));
//    ds_splstPrefer.Filter("prefer_grd_cl="+ds_preferGrdCl.GetColumn(ds_preferGrdCl.currow, "comm_cd_val"));
	
}

/*******************************************************************************
 * @description    :  조직 그리드의 row 삭제
*******************************************************************************/
function div_row_btn_delRow_OnClick(obj)
{
    var rowCnt = ds_splstPrefer.rowcount;
        
    https.Sync = true;
    
    for ( i = rowCnt ; i >= 0 ; i--){
        if (ds_splstPrefer.GetColumn(i,"chk") == "1") {
            ds_splstPrefer.DeleteRow(i);
        }
    }
    
    https.Sync = false;
	
}

/*******************************************************************************
 * @description    :  조직 그리드의 조직팝업 호출
*******************************************************************************/
function grd_org_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
/*
	if(nCell == 1){
        cf_commPopOrgCdDs("ds_orgLst", nRow);
	}
*/	
}

/*******************************************************************************
 * @description    :  조직 그리드의 조직팝업 호출
*******************************************************************************/
function grd_org_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 1){
        cf_commPopOrgCdDs("ds_orgLst", nRow);
    }        
}

/*******************************************************************************
 * @description    :  
*******************************************************************************/
function grd_preferGrd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    ds_splstPrefer.Filter("prefer_grd_cl='"+ds_preferGrdCl.GetColumn(nRow, "comm_cd_val")+"'");
    
    f_getProdList(nRow);
}

function ds_splstPrefer_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(ToLowerCase(strColumnID) == "mar_cl") {
	    ds_splstPrefer.SetColumn(nRow,"mar_fix_rt","");
	    ds_splstPrefer.SetColumn(nRow,"mar_fix_amt","");
	}else if(ToLowerCase(strColumnID) == "sale_cmms_cl"){
	    ds_splstPrefer.SetColumn(nRow,"sale_cmms_fix_rt","");
	    ds_splstPrefer.SetColumn(nRow,"sale_cmms_fix_amt","");
	}
}

/*******************************************************************************
 * @description    :  조직 그리드에서 조직명이 변경 됐을때 초기화
*******************************************************************************/
function grd_org_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{
    if ( nCell == "1" && strPreText != "" ) {
		ds_orgLst.SetColumn(nRow,"org_nm","");
		ds_orgLst.SetColumn(nRow,"org_id","");
	}
}

function grd_org_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
    if (nChar == "13"){
		cf_commPopOrgCdDs("ds_orgLst", ds_orgLst.currow);
	}	
}


/*******************************************************************************
 * @description    :  마진일괄적용의 구분이 변경 되었을때 처리
*******************************************************************************/
function div_margin_cmb_cl_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    div_margin.msk_fixAmt.Value = "";
    div_margin.msk_fixRt.Value = "";
        
    if ( strCode == "1" ){
        div_margin.msk_fixAmt.Enable = true;
        div_margin.msk_fixRt.Enable = false;
    }else if( strCode == "2" ){
        div_margin.msk_fixAmt.Enable = false;
        div_margin.msk_fixRt.Enable = true;
    }else{
        div_margin.msk_fixAmt.Enable = false;
        div_margin.msk_fixRt.Enable = false;
    }
}

/*******************************************************************************
 * @description    :  수수료일괄적용의 구분이 변경 되었을때 처리
*******************************************************************************/
function div_cmms_cmb_cl_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    div_cmms.msk_fixAmt.Value = "";
    div_cmms.msk_fixRt.Value = "";
        
    if ( strCode == "1" ){
        div_cmms.msk_fixAmt.Enable = true;
        div_cmms.msk_fixRt.Enable = false;
    }else if( strCode == "2" ){
        div_cmms.msk_fixAmt.Enable = false;
        div_cmms.msk_fixRt.Enable = true;
    }else{
        div_cmms.msk_fixAmt.Enable = false;
        div_cmms.msk_fixRt.Enable = false;
    }
}

/*******************************************************************************
 * @description    :  마진항목을 그리드에 일괄 적용
*******************************************************************************/
function div_margin_btn_aply_OnClick(obj)
{
	var rowCnt = ds_splstPrefer.RowCountNF();

	for ( var i = 0 ; i < rowCnt ; i++)
	{
	    ds_splstPrefer.SetColumnNF(i, "mar_cl"     , div_margin.cmb_cl.Value);
	    
	    if ( div_margin.cmb_cl.Value == "1" ){
	        ds_splstPrefer.SetColumnNF(i, "mar_fix_amt", div_margin.msk_fixAmt.Value);
	        ds_splstPrefer.SetColumnNF(i, "mar_fix_rt" , "");
	    }else if( div_margin.cmb_cl.Value == "2" ){
	        ds_splstPrefer.SetColumnNF(i, "mar_fix_amt", "");
	        ds_splstPrefer.SetColumnNF(i, "mar_fix_rt" , div_margin.msk_fixRt.Value);
	    }else{
	        ds_splstPrefer.SetColumnNF(i, "mar_fix_amt", "");
	        ds_splstPrefer.SetColumnNF(i, "mar_fix_rt" , "");
	    }
	}
}

/*******************************************************************************
 * @description    :  수수료항목을 그리드에 일괄 적용
*******************************************************************************/
function div_cmms_btn_aply_OnClick(obj)
{
	var rowCnt = ds_splstPrefer.RowCountNF();
	
	for ( var i = 0 ; i < rowCnt ; i++)
	{
	    ds_splstPrefer.SetColumnNF(i, "sale_cmms_cl"     , div_cmms.cmb_cl.Value);
	    
	    if ( div_cmms.cmb_cl.Value == "1" ){
	        ds_splstPrefer.SetColumnNF(i, "sale_cmms_fix_amt", div_cmms.msk_fixAmt.Value);
	        ds_splstPrefer.SetColumnNF(i, "sale_cmms_fix_rt" , "");
	    }else if( div_cmms.cmb_cl.Value == "2" ){
	        ds_splstPrefer.SetColumnNF(i, "sale_cmms_fix_amt", "");
	        ds_splstPrefer.SetColumnNF(i, "sale_cmms_fix_rt" , div_cmms.msk_fixRt.Value);
	    }else{
	        ds_splstPrefer.SetColumnNF(i, "sale_cmms_fix_amt", "");
	        ds_splstPrefer.SetColumnNF(i, "sale_cmms_fix_rt" , "");
	    }
	}
}

function ds_splstPreferCopy_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if ( strColumnID == "amt_to") {
	    if ( varNewValue == "" or varNewvalue == 0) {
	        alert("값을 입력해 주세요.");
	    }
	    
	    if ( ds_splstPreferCopy.GetColumn(nRow,"amt_from") >= varNewValue ) {
	        alert("");
	    }
	}
}

function f_amtValidation()
{
    var rowPrefer = ds_preferGrdCl.GetRowCount();
    var rowAmtCnt = 0;
    var valBreak  = "true";
    
	ds_splstPrefer.FireEvent = false;  
    for (var i = 0 ; i < rowPrefer ; i++ ) {
		      
		
		for(var temp = 0; temp<ds_splstPrefer.GetRowCount(); temp++){
			trace("prefer_grd_cl = "+ds_splstPrefer.GetColumn(temp,"prefer_grd_cl"));
		}
		
        ds_splstPrefer.Filter("prefer_grd_cl='" + ds_preferGrdCl.GetColumn(i, "comm_cd_val") + "'" );
        
        trace("ds_preferGrdCl = [" + ds_preferGrdCl.GetColumn(i, "comm_cd_val") + "]");        
		

        trace("ds_spslstPrefer rowcount = " + ds_splstPrefer.rowcount);
        ds_compSplstPrefer.ClearData();
        for (var k = 0 ; k < ds_splstPrefer.rowcount ; k++ ){
        
            ds_compSplstPrefer.AddRow();
            ds_compSplstPrefer.SetColumn(k, "amt_grd_cl"        , ds_splstPrefer.GetColumn(k, "amt_grd_cl"));
            ds_compSplstPrefer.SetColumn(k, "amt_from"          , ds_splstPrefer.GetColumn(k, "amt_from"));
            ds_compSplstPrefer.SetColumn(k, "amt_to"            , ds_splstPrefer.GetColumn(k, "amt_to"));
            ds_compSplstPrefer.SetColumn(k, "prefer_grd_cl"     , ds_splstPrefer.GetColumn(k, "prefer_grd_cl"));
            ds_compSplstPrefer.SetColumn(k, "splst_id"          , ds_splstPrefer.GetColumn(k, "splst_id"));
            ds_compSplstPrefer.SetColumn(k, "aply_ym"           , ds_splstPrefer.GetColumn(k, "aply_ym"));
            ds_compSplstPrefer.SetColumn(k, "org_id"            , ds_splstPrefer.GetColumn(k, "org_id"));
            ds_compSplstPrefer.SetColumn(k, "sale_typ_cd"       , ds_splstPrefer.GetColumn(k, "sale_typ_cd"));
            ds_compSplstPrefer.SetColumn(k, "mar_cl"            , ds_splstPrefer.GetColumn(k, "mar_cl"));
            ds_compSplstPrefer.SetColumn(k, "mar_fix_rt"        , ds_splstPrefer.GetColumn(k, "mar_fix_rt"));
            ds_compSplstPrefer.SetColumn(k, "mar_fix_amt"       , ds_splstPrefer.GetColumn(k, "mar_fix_amt"));
            ds_compSplstPrefer.SetColumn(k, "sale_cmms_cl"      , ds_splstPrefer.GetColumn(k, "sale_cmms_cl"));
            ds_compSplstPrefer.SetColumn(k, "sale_cmms_fix_rt"  , ds_splstPrefer.GetColumn(k, "sale_cmms_fix_rt"));
            ds_compSplstPrefer.SetColumn(k, "sale_cmms_fix_amt" , ds_splstPrefer.GetColumn(k, "sale_cmms_fix_amt"));
            ds_compSplstPrefer.SetColumn(k, "from_sort"         , 0);

		    //trace("     mar_cl     = " + ds_splstPrefer.GetColumn(k, "mar_cl"));
		    //trace("     mar_fix_rt = " + ds_splstPrefer.GetColumn(k, "mar_fix_rt"));
		    //trace("     mar_fix_amt= " + ds_splstPrefer.GetColumn(k, "mar_fix_amt"));
		    //trace("     sale_cmms_cl     = " + ds_splstPrefer.GetColumn(k, "sale_cmms_cl"));
		    //trace("     sale_cmms_fix_rt = " + ds_splstPrefer.GetColumn(k, "sale_cmms_fix_rt"));
		    //trace("     sale_cmms_fix_amt= " + ds_splstPrefer.GetColumn(k, "sale_cmms_fix_amt"));
        }
        
//trace(ds_compSplstPrefer.SaveXML());
        
        //ds_compSplstPrefer.copy(ds_splstPrefer);
        //ds_compSplstPrefer.AddColumn("from_sort");
        rowAmtCnt = ds_compSplstPrefer.getRowCount();
        trace(rowAmtCnt+":"+ds_compSplstPrefer.SaveXML());
//        trace("ds_preferGrdCl = " + ds_preferGrdCl.GetColumn(i, "comm_cd_val"));
//        trace("ds_compSplstPrefer row count = " + rowAmtCnt);

        if ( rowAmtCnt == 0 ) {
        
            // 선호도 그리드 선택
			f_set_gridFocus(grd_preferGrd, ds_preferGrdCl.SearchRow("comm_cd_val="+ds_preferGrdCl.GetColumn(i,"comm_cd_val")), 0);
					
			// 금액 그리드 선택
			ds_splstPrefer.Filter("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl")+"'");
						        
			msg = "[";
			msg = msg + ds_preferGrdCl.GetColumn(i,"comm_cd_val_nm");
			msg = msg +"]";

			alert(msg + " 상한,하한 금액 및 마진을 입력해 주십시요.");
			valBreak = "false";
			break;
        }
        
        ds_compSplstPrefer.sort("amt_from");

        //trace(ds_compSplstPrefer.SaveXML());

        for (j = 0 ; j < rowAmtCnt ; j++ ) {
            
            ds_compSplstPrefer.SetColumn(j, "from_sort", j);
        }
        
        j = 0;
        ds_compSplstPrefer.sort("amt_to");

        //trace(ds_compSplstPrefer.SaveXML());
        for (j = 0 ; j < rowAmtCnt ; j++ ) {
        
            // sort 후 비교
            if ( ds_compSplstPrefer.getColumn(j, "from_sort") != j )
            {
                
                // 선호도 그리드 선택
                ds_preferGrdCl.SelectRow(ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(j,"prefer_grd_cl")));
                
				alert(ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(j,"prefer_grd_cl")));

                            
                // 금액 그리드 선택
                ds_splstPrefer.Filter("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl")+"'");
                ds_splstPrefer.SelectRow(ds_splstPrefer.SearchRow("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl") + "'" +
                                                                  " and amt_from='"+ds_compSplstPrefer.GetColumn(j, "amt_from") + "'" +
                                                                  " and amt_to='"  +ds_compSplstPrefer.GetColumn(j, "amt_to") + "'")
                                        );
				alert("금액 그리드 문제. = " + ds_compSplstPrefer.getColumn(j, "from_sort") + " -----   " + j );
                valBreak = "false";
                break;
            }
            
            //금액비교
            if ( (j + 1) != rowAmtCnt )
            {
                if ( ds_compSplstPrefer.getColumn(j, "amt_to") >= ds_compSplstPrefer.getColumn(j+1,"amt_from") )
                {
                    // amt_to 보다 다음 금액의 amt_from 이 클때
					// 선호도 그리드 선택
					//trace("prefer_grd_cl = " + ds_compSplstPrefer.getColumn(j,"prefer_grd_cl"));
					//trace("searchrow = " + ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(j,"prefer_grd_cl")) );
					
                    f_set_gridFocus(grd_preferGrd, ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(j,"prefer_grd_cl")), 0);
                            
                            
					// 금액 그리드 선택
					ds_splstPrefer.Filter("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl")+"'");
					f_set_gridFocus(grd_margin, ds_preferGrdCl.SearchRow(ds_splstPrefer.SearchRow("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl") + "'" +
																	  " and amt_from='"+ds_compSplstPrefer.GetColumn(j, "amt_from") + "'" +
																	  " and amt_to='"+ds_compSplstPrefer.GetColumn(j, "amt_to") + "'" )), 0);
						
											
					alert("상한금액,하한금액을 확인해 주십시요.1");
                    valBreak = "false";
                    break;
                }
             
                if ( ( ds_compSplstPrefer.getColumn(j, "amt_to") + 1 ) != ds_compSplstPrefer.getColumn(j+1,"amt_from") )
                {
                    // amt_to  + 1  금액보다 다음 금액의 amt_from 이 다를때
					// 선호도 그리드 선택
                    f_set_gridFocus(grd_preferGrd, ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(j,"prefer_grd_cl")), 0);
					
					// 금액 그리드 선택
					ds_splstPrefer.Filter("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl")+"'");
					f_set_gridFocus(grd_margin, ds_preferGrdCl.SearchRow(ds_splstPrefer.SearchRow("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl") + "'" +
																	  " and amt_from='"+ds_compSplstPrefer.GetColumn(j, "amt_from") + "'" +
																	  " and amt_to='"+ds_compSplstPrefer.GetColumn(j, "amt_to") + "'" )), 0);
											
					alert("상한금액,하한금액을 확인해 주십시요.2");
                    valBreak = "false";
                    break;
                }
            
            }
            

            
            
        
			msg = "[";
			msg = msg + ds_preferGrdCl.GetColumn(ds_preferGrdCl.FindRow("comm_cd_val", ds_splstPrefer.GetColumnNF(i,"prefer_grd_cl")),"comm_cd_val_nm") + ",";
			msg = msg + ds_compSplstPrefer.GetColumn(j,"amt_from") + "-";
			msg = msg + ds_compSplstPrefer.GetColumn(j,"amt_to") + "";
			msg = msg +"]";
		
			if( uf_isEmpty(ds_compSplstPrefer.GetColumn(j,"mar_cl")) ) {
				// 선호도 그리드 선택
				f_set_gridFocus(grd_preferGrd, ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(i,"prefer_grd_cl")), 0);
						
				// 금액 그리드 선택
				ds_splstPrefer.Filter("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl")+"'");
							
				alert(msg + " 마진구분을 입력해 주십시요.");
				valBreak = "false";
				break;
			}
	
			if( ds_compSplstPrefer.GetColumn(j,"mar_cl") == "1" && uf_isEmpty(ds_compSplstPrefer.GetColumn(j,"mar_fix_amt")+"") ) {
				// 선호도 그리드 선택
				f_set_gridFocus(grd_preferGrd, ds_preferGrdCl.SearchRow("comm_cd_val="+ds_compSplstPrefer.getColumn(i,"prefer_grd_cl")), 0);
						
				// 금액 그리드 선택
				ds_splstPrefer.Filter("prefer_grd_cl='"+ds_compSplstPrefer.GetColumn(j, "prefer_grd_cl")+"'");
								
				alert(msg + " 마진금액을 입력해 주십시요.");
				valBreak = "false";
				break;
			}
	
			if( ds_compSplstPrefer.GetColumn(j,"mar_cl") == "2" && uf_isEmpty(ds_compSplstPrefer.GetColumn(j,"mar_fix_rt")+"") ) {
				alert(msg + " 마진율을 입력해 주십시요.");
				valBreak = "false";
				break;
			}
	
			if( uf_isEmpty(ds_compSplstPrefer.GetColumn(j,"sale_cmms_cl")) ) {
				alert(msg + " 수수료구분을 입력해 주십시요.");
				valBreak = "false";
				break;
			}
	
			if( ds_compSplstPrefer.GetColumn(j,"sale_cmms_cl") == "1" && uf_isEmpty(ds_compSplstPrefer.GetColumn(j,"sale_cmms_fix_amt")+"") ) {
				alert(msg + " 수수료금액을 입력해 주십시요.");
				valBreak = "false";
				break;
			}
	
			if( ds_compSplstPrefer.GetColumn(j,"sale_cmms_cl") == "2" && uf_isEmpty(ds_compSplstPrefer.GetColumn(j,"sale_cmms_fix_rt")+"") ) {
				alert(msg + " 수수료율을 입력해 주십시요.");
				valBreak = "false";
				break;
			}                    
            
            
            
            
            
            
        }
        
        // break 일때
        // 또 한번 break....
        if ( valBreak == "false" ) {
            break;
        } else {

        }
    }

    // break 일때
    // 그리드 오류 라인 지정...
    
    
   	ds_splstPrefer.FireEvent = true;  

    return valBreak;
}

/**
 * 상품 그룹에 해당하는 상품 List 조회
 */
function f_getProdList(nRow){
	
	ds_condition_prod.SetColumn(0,'PROD_GROUP_CD',ds_preferGrdCl.GetColumn(nRow,"COMM_CD_VAL"));
	
	ds_prodLst.ClearData();

	var sSvcID 	= "getProdList";
	var sInDs  	= "nc_input_fieldDs=ds_condition_prod";
	var sOutDs 	= "ds_prodLst=ds_prodLst";
	var sArg	= "sktst.pol.SPM#getProdListForSplstPrefer";
	
	// 공통 트랜잭션 호출
	cf_Transaction(sSvcID, sInDs, sOutDs, sArg, null, true, true);
	
}]]></Script>
</Window>